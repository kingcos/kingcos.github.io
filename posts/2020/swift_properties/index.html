<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>Swift æ‹¾é— - å±æ€§ :: iBlog</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Date Notes Info     2020-08-01 çº³å…¥ Swift æ‹¾é—ç³»åˆ—ï¼Œå¹¶é‡æ–°æ•´ç†å®Œå–„ Swift 5.3, Xcode 12.0   2017-04-27 æ‰©å……ã€Œå»¶è¿Ÿå­˜å‚¨å±æ€§ã€éƒ¨åˆ†å¹¶æ–°å¢ã€Œdevxoul/Thenã€ä¸€èŠ‚ Swift 3.1, Xcode 8.3.2   2016-10-26 é¦–æ¬¡æäº¤ Swift 3.0, Xcode 8.1 Beta 3    Preface ã€ŠSwift æ‹¾é—ã€‹æ˜¯ä¸€ä¸ªå…³äº Swift çš„æ–°æ–‡ç« ä¸“è¾‘ï¼Œè¿™ä¸ªç³»åˆ—çš„æ–‡ç« å°†ä¸ä¼šæ¶‰åŠåŸºæœ¬è¯­æ³•çš„å±‚é¢ï¼Œè€Œæ˜¯å°è¯•ä»åº•å±‚ã€Œæ‹¾ã€èµ·ä¹‹å‰æ‰€å¿½è§†çš„å†…å®¹ã€‚ä»Šå¤©æˆ‘ä»¬å°†ä¸€èµ·ç®€å•æ¢ç©¶ Swift ä¸­çš„å±æ€§ã€‚
å­˜å‚¨å±æ€§ä¸è®¡ç®—å±æ€§ struct Foo { var bar: Int var baz: Int { get { bar * 2 } set { bar = newValue / 2 } } var customSetParamBaz: Int { get { bar * 2 } set(customNewValue) { bar = customNewValue / 2 } } } var foo = Foo(bar: 10) _ = foo."/>
<meta name="keywords" content="kingcos.me,maimieng.comios,swift,objective-c,obj-c,objc,oc,geek,python,ruby,golang,go,apple,mac"/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="/posts/2020/swift_properties/" />





<link rel="stylesheet" href="/assets/style.css">


<link rel="stylesheet" href="/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/img/favicon.png">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Swift æ‹¾é— - å±æ€§"/>
<meta name="twitter:description" content="ã€ŠSwift æ‹¾é—ã€‹æ˜¯ä¸€ä¸ªå…³äº Swift çš„æ–°æ–‡ç« ä¸“è¾‘ï¼Œè¿™ä¸ªç³»åˆ—çš„æ–‡ç« å°†ä¸ä¼šæ¶‰åŠåŸºæœ¬è¯­æ³•çš„å±‚é¢ï¼Œè€Œæ˜¯å°è¯•ä»åº•å±‚ã€Œæ‹¾ã€èµ·ä¹‹å‰æ‰€å¿½è§†çš„å†…å®¹ã€‚ä»Šå¤©æˆ‘ä»¬å°†ä¸€èµ·ç®€å•æ¢ç©¶ Swift ä¸­çš„å±æ€§ã€‚"/>



<meta property="og:title" content="Swift æ‹¾é— - å±æ€§" />
<meta property="og:description" content="ã€ŠSwift æ‹¾é—ã€‹æ˜¯ä¸€ä¸ªå…³äº Swift çš„æ–°æ–‡ç« ä¸“è¾‘ï¼Œè¿™ä¸ªç³»åˆ—çš„æ–‡ç« å°†ä¸ä¼šæ¶‰åŠåŸºæœ¬è¯­æ³•çš„å±‚é¢ï¼Œè€Œæ˜¯å°è¯•ä»åº•å±‚ã€Œæ‹¾ã€èµ·ä¹‹å‰æ‰€å¿½è§†çš„å†…å®¹ã€‚ä»Šå¤©æˆ‘ä»¬å°†ä¸€èµ·ç®€å•æ¢ç©¶ Swift ä¸­çš„å±æ€§ã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/2020/swift_properties/" />
<meta property="article:published_time" content="2020-09-18T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-09-18T00:00:00+00:00" /><meta property="og:site_name" content="iBlog" />




<script data-ad-client="ca-pub-9925978992661955" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  </head>
  <body class="">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">kingcos.me</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/links">Links</a></li>
        
      
        
          <li><a href="/perspective">Perspective</a></li>
        
      
        
          <li><a href="/words">Words</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/links">Links</a></li>
      
    
      
        <li><a href="/perspective">Perspective</a></li>
      
    
      
        <li><a href="/words">Words</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  <div class="post">
    <h2 class="post-title"><a href="/posts/2020/swift_properties/">Swift æ‹¾é— - å±æ€§</a></h2>
    <div class="post-meta">
      
        <span class="post-date">
            2020-09-18
        </span>
      
      
      
        <span class="post-read-time">â€” 10 min read</span>
      
    </div>

    
      <span class="post-tags">
        
          #<a href="/tags/swift/">Swift</a>&nbsp;
        
          #<a href="/tags/swift-%E6%8B%BE%E9%81%97/">Swift æ‹¾é—</a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      <table>
<thead>
<tr>
<th style="text-align:center">Date</th>
<th style="text-align:center">Notes</th>
<th style="text-align:center">Info</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">2020-08-01</td>
<td style="text-align:center">çº³å…¥ Swift æ‹¾é—ç³»åˆ—ï¼Œå¹¶é‡æ–°æ•´ç†å®Œå–„</td>
<td style="text-align:center">Swift 5.3, Xcode 12.0</td>
</tr>
<tr>
<td style="text-align:center">2017-04-27</td>
<td style="text-align:center">æ‰©å……ã€Œå»¶è¿Ÿå­˜å‚¨å±æ€§ã€éƒ¨åˆ†å¹¶æ–°å¢ã€Œdevxoul/Thenã€ä¸€èŠ‚</td>
<td style="text-align:center">Swift 3.1, Xcode 8.3.2</td>
</tr>
<tr>
<td style="text-align:center">2016-10-26</td>
<td style="text-align:center">é¦–æ¬¡æäº¤</td>
<td style="text-align:center">Swift 3.0, Xcode 8.1 Beta 3</td>
</tr>
</tbody>
</table>
<h2 id="preface">Preface</h2>
<p>ã€ŠSwift æ‹¾é—ã€‹æ˜¯ä¸€ä¸ªå…³äº Swift çš„æ–°æ–‡ç« ä¸“è¾‘ï¼Œè¿™ä¸ªç³»åˆ—çš„æ–‡ç« å°†ä¸ä¼šæ¶‰åŠåŸºæœ¬è¯­æ³•çš„å±‚é¢ï¼Œè€Œæ˜¯å°è¯•ä»åº•å±‚ã€Œæ‹¾ã€èµ·ä¹‹å‰æ‰€å¿½è§†çš„å†…å®¹ã€‚ä»Šå¤©æˆ‘ä»¬å°†ä¸€èµ·ç®€å•æ¢ç©¶ Swift ä¸­çš„å±æ€§ã€‚</p>
<h2 id="å­˜å‚¨å±æ€§ä¸è®¡ç®—å±æ€§">å­˜å‚¨å±æ€§ä¸è®¡ç®—å±æ€§</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Foo</span> {
    <span style="color:#66d9ef">var</span> bar: Int
    <span style="color:#66d9ef">var</span> baz: Int {
        <span style="color:#66d9ef">get</span> {
            bar <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>
        }

        <span style="color:#66d9ef">set</span> {
            bar = newValue <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
        }
    }

    <span style="color:#66d9ef">var</span> customSetParamBaz: Int {
        <span style="color:#66d9ef">get</span> {
            bar <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>
        }

        <span style="color:#66d9ef">set</span>(customNewValue) {
            bar = customNewValue <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
        }
    }
}

<span style="color:#66d9ef">var</span> foo = Foo(bar: <span style="color:#ae81ff">10</span>)

<span style="color:#66d9ef">_</span> = foo.bar <span style="color:#75715e">// 10</span>
<span style="color:#66d9ef">_</span> = foo.baz <span style="color:#75715e">// 20  // BREAKPOINT ğŸ”´</span>

foo.baz = <span style="color:#ae81ff">100</span>

<span style="color:#66d9ef">_</span> = foo.baz <span style="color:#75715e">// 100</span>
<span style="color:#66d9ef">_</span> = foo.bar <span style="color:#75715e">// 50</span>
</code></pre></div><p>å¦‚ä¸Šï¼Œ<code>bar</code> ä¸ºå­˜å‚¨å±æ€§ï¼Œå³å°†å ç”¨å®ä¾‹å¯¹è±¡çš„å†…å­˜ç©ºé—´ï¼›è€Œ <code>baz</code> ä¸ºè®¡ç®—å±æ€§ï¼Œå°†é€šè¿‡å…¶å®ƒå˜é‡å¾—å‡ºï¼Œå½“å¤–ç•Œå–å€¼æ—¶å°†å¾—åˆ°è°ƒç”¨ <code>get</code> ä¸­çš„è¿”å›ï¼Œè®¾ç½®æ—¶å°†é€šè¿‡ <code>set</code> ä¸­ <code>newValue</code> å°†å¤–ç•Œçš„å€¼ä¼ é€’è¿›å…¥å¹¶è¿›è¡Œä¸€å®šçš„è®¡ç®—ã€‚é‚£ä¹ˆè®¡ç®—å±æ€§æ˜¯å¦ä¼šå ç”¨å®ä¾‹å¯¹è±¡çš„å†…å­˜ç©ºé—´å‘¢ï¼Ÿ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift">print(MemoryLayout&lt;Foo&gt;.size)   <span style="color:#75715e">// 8</span>
print(MemoryLayout&lt;Foo&gt;.stride) <span style="color:#75715e">// 8</span>
</code></pre></div><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥ä»£ç è¿è¡Œï¼Œå¹¶åœ¨æ–­ç‚¹å¤„ä»¥æ±‡ç¼–ä»£ç åˆ†æï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">-&gt;</span>  <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x1000027a1</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">113</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %rax, %rdi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x1000027a4</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">116</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">leaq</span>   -<span style="color:#ae81ff">0x38</span>(%rbp), %rsi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x1000027a8</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">120</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movl</span>   <span style="color:#66d9ef">$0x20</span>, %edx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x1000027ad</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">125</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100003b92</span>               <span style="color:#75715e">; symbol stub for: swift_beginAccess
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x1000027b2</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">130</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   <span style="color:#ae81ff">0x59bf</span>(%rip), %rdi        <span style="color:#75715e">; demo.foo : demo.Foo
</span><span style="color:#75715e"></span>    <span style="color:#75715e">; å°†è°ƒç”¨è®¡ç®—å±æ€§çš„ getter
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x1000027b9</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">137</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x1000028c0</span>               <span style="color:#75715e">; demo.Foo.baz.getter : Swift.Int at main.swift:6
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x1000027be</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">142</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">leaq</span>   -<span style="color:#ae81ff">0x38</span>(%rbp), %rdi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x1000027c2</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">146</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %rax, -<span style="color:#ae81ff">0xa0</span>(%rbp)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x1000027c9</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">153</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100003b98</span>               <span style="color:#75715e">; symbol stub for: swift_endAccess
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x1000027ce</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">158</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">leaq</span>   <span style="color:#ae81ff">0x59a3</span>(%rip), %rax        <span style="color:#75715e">; demo.foo : demo.Foo
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x1000027d5</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">165</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">xorl</span>   %r8d, %r8d
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x1000027d8</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">168</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movl</span>   %r8d, %ecx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x1000027db</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">171</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %rax, %rdi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x1000027de</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">174</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">leaq</span>   -<span style="color:#ae81ff">0x50</span>(%rbp), %rsi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x1000027e2</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">178</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movl</span>   <span style="color:#66d9ef">$0x21</span>, %edx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x1000027e7</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">183</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100003b92</span>               <span style="color:#75715e">; symbol stub for: swift_beginAccess
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x1000027ec</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">188</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movl</span>   <span style="color:#66d9ef">$0x64</span>, %edi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x1000027f1</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">193</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">leaq</span>   <span style="color:#ae81ff">0x5980</span>(%rip), %r13        <span style="color:#75715e">; demo.foo : demo.Foo
</span><span style="color:#75715e"></span>    <span style="color:#75715e">; å°†è°ƒç”¨è®¡ç®—å±æ€§çš„ setter
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x1000027f8</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">200</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100002960</span>               <span style="color:#75715e">; demo.Foo.baz.setter : Swift.Int at main.swift:10
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x1000027fd</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">205</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">leaq</span>   -<span style="color:#ae81ff">0x50</span>(%rbp), %rdi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100002801</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">209</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100003b98</span>               <span style="color:#75715e">; symbol stub for: swift_endAccess
</span></code></pre></div><p>å¦‚ä¸Šï¼Œè®¡ç®—å±æ€§å°†ä¸ä¼šäº§ç”Ÿå®é™…çš„å˜é‡ï¼Œå¤–ç•Œçš„ä½¿ç”¨å°†é€šè¿‡ <code>get</code> å’Œ <code>set</code> ä¸­æ‰€ç”Ÿæˆçš„ <code>getter</code> å’Œ <code>setter</code> æ–¹æ³•è®¿é—®æˆ–è®¾ç½®ï¼Œå› æ­¤ä¹Ÿå°±ä¸ä¼šå ç”¨å®ä¾‹å¯¹è±¡çš„å†…å­˜ç©ºé—´ã€‚</p>
<p>è®¡ç®—å±æ€§ä¹Ÿæ”¯æŒåªè¯»ï¼ˆRead-onlyï¼‰ï¼Œåªéœ€è¦ä¸å®ç° <code>set</code> å³å¯ï¼Œæ­¤æ—¶ä¹Ÿå¯çœç•¥æ˜¾å¼çš„ <code>get</code> å…³é”®å­—ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Foo</span> {
    <span style="color:#66d9ef">var</span> bar: Int = <span style="color:#ae81ff">0</span>

    <span style="color:#66d9ef">var</span> readonlyBaz1: Int {
        <span style="color:#66d9ef">get</span> {
            bar <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>
        }
    }

    <span style="color:#66d9ef">var</span> readonlyBaz2: Int {
        bar <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>
    }
}

<span style="color:#66d9ef">var</span> foo = Foo()

<span style="color:#75715e">// ERROR: Cannot assign to property: &#39;readonlyBaz1&#39; is a get-only property</span>
foo.readonlyBaz1 = <span style="color:#ae81ff">10</span>
<span style="color:#75715e">// ERROR: Cannot assign to property: &#39;readonlyBaz2&#39; is a get-only property</span>
foo.readonlyBaz2 = <span style="color:#ae81ff">10</span>
</code></pre></div><p>å±æ€§ï¼ˆå­˜å‚¨å±æ€§ä¸è®¡ç®—å±æ€§ï¼‰ä¹Ÿæ”¯æŒä¸º <code>get</code> å’Œ <code>set</code> è®¾ç½®ä¸åŒçš„è®¿é—®æ§åˆ¶çº§åˆ«ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Foo</span> {
    <span style="color:#66d9ef">var</span> bar: Int = <span style="color:#ae81ff">0</span>

    <span style="color:#66d9ef">internal</span> <span style="color:#66d9ef">private</span>(<span style="color:#66d9ef">set</span>) <span style="color:#66d9ef">var</span> privateSetBaz3: Int {
        <span style="color:#66d9ef">get</span> {
            bar <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>
        }

        <span style="color:#66d9ef">set</span> {
            bar = newValue <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
        }
    }

    <span style="color:#66d9ef">private</span>(<span style="color:#66d9ef">set</span>) <span style="color:#66d9ef">var</span> privateSetBaz4: Int {
        <span style="color:#66d9ef">get</span> {
            bar <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>
        }

        <span style="color:#66d9ef">set</span> {
            bar = newValue <span style="color:#f92672">/</span> <span style="color:#ae81ff">2</span>
        }
    }

    <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">innerFunc</span>() {
        <span style="color:#66d9ef">self</span>.privateSetBaz3 = <span style="color:#ae81ff">10</span>
        <span style="color:#66d9ef">self</span>.privateSetBaz4 = <span style="color:#ae81ff">10</span>
    }
}

<span style="color:#66d9ef">var</span> foo = Foo()

foo.innerFunc()

<span style="color:#75715e">// ERROR: Cannot assign to property: &#39;privateSetBaz3&#39; setter is inaccessible</span>
foo.privateSetBaz3 = <span style="color:#ae81ff">10</span>
<span style="color:#75715e">// ERROR: Cannot assign to property: &#39;privateSetBaz4&#39; setter is inaccessible</span>
foo.privateSetBaz4 = <span style="color:#ae81ff">10</span>
</code></pre></div><p>é‚£ä¹ˆè®¡ç®—å±æ€§æœ‰ä½•ä½¿ç”¨åœºæ™¯å‘¢ï¼Ÿå…¶å®å½“å®šä¹‰çš„å±æ€§ä¾èµ–äºå…¶å®ƒå±æ€§æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨è®¡ç®—å±æ€§ã€‚æšä¸¾ä¸­çš„åŸå§‹å€¼ <code>rawValue</code> å°±æ˜¯é€šè¿‡åªè¯»è®¡ç®—å±æ€§å®ç°çš„ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">enum</span> <span style="color:#a6e22e">Foo</span>: Int {
    <span style="color:#66d9ef">case</span> bar = <span style="color:#ae81ff">0</span>, baz
}

<span style="color:#66d9ef">_</span> = Foo.bar.rawValue <span style="color:#75715e">// 0 // BREAKPOINT ğŸ”´</span>
</code></pre></div><p>å°è¯•è¿è¡Œååœ¨æ–­ç‚¹å¤„æŸ¥çœ‹æ±‡ç¼–ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#a6e22e">demo</span><span style="color:#960050;background-color:#1e0010">`</span><span style="color:#66d9ef">main</span>:
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100002500</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">0</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">pushq</span>  %rbp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100002501</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rsp, %rbp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100002504</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">4</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">subq</span>   <span style="color:#66d9ef">$0x20</span>, %rsp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100002508</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">8</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">xorl</span>   %eax, %eax
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x10000250a</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">10</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movl</span>   %edi, -<span style="color:#ae81ff">0x4</span>(%rbp)
<span style="color:#960050;background-color:#1e0010">-&gt;</span>  <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x10000250d</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">13</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movl</span>   %eax, %edi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x10000250f</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">15</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %rsi, -<span style="color:#ae81ff">0x10</span>(%rbp)
    <span style="color:#75715e">; å°†è°ƒç”¨è®¡ç®—å±æ€§çš„ getter
</span><span style="color:#75715e"></span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100002513</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">19</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x1000025a0</span>               <span style="color:#75715e">; demo.Foo.rawValue.getter : Swift.Int at &lt;compiler-generated&gt;
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100002518</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">24</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">xorl</span>   %ecx, %ecx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x10000251a</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">26</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %rax, -<span style="color:#ae81ff">0x18</span>(%rbp)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x10000251e</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">30</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movl</span>   %ecx, %eax
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100002520</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">32</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">addq</span>   <span style="color:#66d9ef">$0x20</span>, %rsp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100002524</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">36</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">popq</span>   %rbp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100002525</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">37</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">retq</span>
</code></pre></div><h2 id="å»¶è¿Ÿå­˜å‚¨å±æ€§">å»¶è¿Ÿå­˜å‚¨å±æ€§</h2>
<p>å»¶è¿Ÿå­˜å‚¨å±æ€§æ˜¯æŒ‡è¯¥å±æ€§çš„åˆå§‹åŒ–è¿‡ç¨‹å°†å»¶è¿Ÿåˆ°é¦–æ¬¡ä½¿ç”¨æ—¶ï¼Œè€Œéè·Ÿéšå®ä¾‹çš„åˆ›å»ºè€Œåˆ›å»ºã€‚å½“è¯¥ç±»å±æ€§æœªè¢«ä½¿ç”¨æ—¶ï¼Œå°†é¿å…æ¶ˆè€—ä¸å¿…è¦çš„æ€§èƒ½ã€‚å»¶è¿Ÿå­˜å‚¨å±æ€§ä½¿ç”¨ <code>lazy</code> å…³é”®å­—ä¿®é¥°ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Foo</span> {
    <span style="color:#66d9ef">lazy</span> <span style="color:#66d9ef">var</span> bar: Int = {
        print(<span style="color:#e6db74">&#34;bar will init&#34;</span>)

        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>
    }()

    <span style="color:#66d9ef">var</span> baz: Int = {
        print(<span style="color:#e6db74">&#34;baz will init&#34;</span>)

        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>
    }()
}

<span style="color:#66d9ef">_</span> = Foo()

<span style="color:#75715e">// baz will init</span>
</code></pre></div><p>å¦‚ä¸Šï¼Œå½“æ„é€  <code>Foo</code> å®ä¾‹å¯¹è±¡æ—¶ï¼Œå»¶è¿Ÿå­˜å‚¨å±æ€§å°†æš‚æ—¶ä¸åˆå§‹åŒ–ã€‚å¦å¤–ï¼Œå»¶è¿Ÿå­˜å‚¨å±æ€§éœ€è¦æœ‰å‡ ä¸ªæ³¨æ„ç‚¹ï¼šé¦–å…ˆï¼Œå»¶è¿Ÿå­˜å‚¨å±æ€§å¿…é¡»ä½¿ç”¨ <code>var</code> ä¿®é¥°ï¼Œè€Œä¸å¯ä½¿ç”¨ <code>let</code> ä¿®é¥°ã€‚è¿™æ˜¯å› ä¸º <code>let</code> å¸¸é‡ä¸€æ—¦åˆ›å»ºåå°±ä¸å†æ”¹å˜ï¼Œè€Œå»¶è¿Ÿå­˜å‚¨å±æ€§ä¼šåœ¨ä½¿ç”¨æ—¶å†åˆå§‹åŒ–å°†ä¸æ­¤ç›¸æ‚–ï¼›å…¶æ¬¡ï¼Œç»“æ„ä½“ç±»å‹ä¸­è‹¥å­˜åœ¨å»¶è¿Ÿå­˜å‚¨å±æ€§ï¼Œé‚£ä¹ˆä½¿ç”¨ <code>let</code> å£°æ˜çš„ç»“æ„ä½“å¸¸é‡å°†æ— æ³•è®¿é—®å»¶è¿Ÿå­˜å‚¨å±æ€§ï¼ŒåŸå› å…¶å®åŒç†ï¼Œåœ¨é¦–æ¬¡è®¿é—®æ—¶å°†æ‰§è¡Œå»¶è¿Ÿå­˜å‚¨å±æ€§çš„åˆå§‹åŒ–ï¼Œå°†ä¼šå¯¼è‡´å¸¸é‡å†…å­˜ç©ºé—´æ”¹å˜ï¼Œä¹Ÿä¸å¸¸é‡æœ¬èº«ç›¸æ‚–ï¼›ä½† <code>class</code> ç±»å‹çš„å˜é‡ç”±äºæœ¬è´¨æ˜¯å¼•ç”¨ç±»å‹ï¼Œå³ä½¿å †ç©ºé—´çš„å†…å­˜ç©ºé—´æ”¹å˜ï¼Œä¹Ÿä¸ä¼šå¯¼è‡´æŒ‡é’ˆæŒ‡å‘çš„å†…å­˜ç©ºé—´åœ°å€æ”¹å˜ï¼Œå› æ­¤ <code>class</code> ç±»å‹çš„å¸¸é‡ä»å¯ä»¥è®¿é—®å»¶è¿Ÿå­˜å‚¨å±æ€§ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">FooClass</span> {
    <span style="color:#66d9ef">lazy</span> <span style="color:#66d9ef">var</span> a = <span style="color:#ae81ff">1</span>
}

<span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">FooStruct</span> {
    <span style="color:#66d9ef">lazy</span> <span style="color:#66d9ef">var</span> a = <span style="color:#ae81ff">1</span>
}

<span style="color:#66d9ef">let</span> fc = FooClass()
print(fc.a)

<span style="color:#66d9ef">let</span> fs = FooStruct()
<span style="color:#75715e">// ERROR: Cannot use mutating getter on immutable value: &#39;fs&#39; is a &#39;let&#39; constant</span>
print(fs.a)
</code></pre></div><p>è¿˜éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå»¶è¿Ÿå­˜å‚¨å±æ€§æ˜¯çº¿ç¨‹<strong>ä¸</strong>å®‰å…¨çš„ï¼Œå³æœ‰å¯èƒ½åœ¨å¤šçº¿ç¨‹ä¸­è¢«å¤šæ¬¡åˆå§‹åŒ–ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Foundation</span>

<span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Foo</span> {
    <span style="color:#66d9ef">lazy</span> <span style="color:#66d9ef">var</span> bar: Int = {
        print(<span style="color:#e6db74">&#34;bar will init&#34;</span>)

        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>
    }()

     <span style="color:#66d9ef">var</span> baz: Int = {
        print(<span style="color:#e6db74">&#34;baz will init&#34;</span>)

        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">1</span>
    }()
}

<span style="color:#66d9ef">var</span> foo = Foo()

<span style="color:#66d9ef">var</span> array = [Int]()

DispatchQueue.concurrentPerform(iterations: <span style="color:#ae81ff">3</span>) { <span style="color:#66d9ef">_</span> <span style="color:#66d9ef">in</span>
    print(<span style="color:#e6db74">&#34;--- </span><span style="color:#e6db74">\(</span>Thread.current<span style="color:#e6db74">)</span><span style="color:#e6db74"> ---&#34;</span>)
    print(foo.bar)
}

<span style="color:#75715e">// baz will init</span>
<span style="color:#75715e">// --- &lt;NSThread: 0x100611a40&gt;{number = 3, name = (null)} ---</span>
<span style="color:#75715e">// --- &lt;NSThread: 0x1029197f0&gt;{number = 2, name = (null)} ---</span>
<span style="color:#75715e">// --- &lt;NSThread: 0x10050c580&gt;{number = 1, name = main} ---</span>
<span style="color:#75715e">// bar will init</span>
<span style="color:#75715e">// bar will init</span>
<span style="color:#75715e">// 1</span>
<span style="color:#75715e">// 1</span>
<span style="color:#75715e">// bar will init</span>
<span style="color:#75715e">// 1</span>
</code></pre></div><p>å¦‚ä¸Šï¼Œæˆ‘ä»¬ä½¿ç”¨ GCD çš„å¹¶å‘æ‰§è¡Œ API <code>concurrentPerform</code> æ‰§è¡Œä¸‰æ¬¡ï¼Œå¦‚æœå»¶è¿Ÿå­˜å‚¨å±æ€§æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œé‚£ä¹ˆå°†åªä¼šè¿›å…¥å…¶æ„é€ æ–¹æ³•ä¸€æ¬¡ï¼Œä½†æ­¤æ—¶å…¶å®è¾“å‡ºäº†ä¸‰å¥ <code>bar will init</code>ã€‚</p>
<blockquote>
<p><strong><code>lazy</code> æ–¹æ³•</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">let</span> doubled = (<span style="color:#ae81ff">0.</span>.&lt;<span style="color:#ae81ff">3</span>).map { i -&gt; Int <span style="color:#66d9ef">in</span>
    print(<span style="color:#e6db74">&#34;mapping&#34;</span>)
    <span style="color:#66d9ef">return</span> i <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>
}

<span style="color:#66d9ef">let</span> lazyDoubled = (<span style="color:#ae81ff">0.</span>.&lt;<span style="color:#ae81ff">3</span>).<span style="color:#66d9ef">lazy</span>.map { i -&gt; Int <span style="color:#66d9ef">in</span>
    print(<span style="color:#e6db74">&#34;lazy mapping&#34;</span>)
    <span style="color:#66d9ef">return</span> i <span style="color:#f92672">*</span> <span style="color:#ae81ff">2</span>
}

<span style="color:#75715e">// mapping</span>
<span style="color:#75715e">// mapping</span>
<span style="color:#75715e">// mapping</span>

lazyDoubled.forEach {
    print($0)
}

<span style="color:#75715e">// lazy mapping</span>
<span style="color:#75715e">// 0</span>
<span style="color:#75715e">// lazy mapping</span>
<span style="color:#75715e">// 2</span>
<span style="color:#75715e">// lazy mapping</span>
<span style="color:#75715e">// 4</span>
</code></pre></div><p>åœ¨ Swift æ ‡å‡†åº“ä¸­ä¹Ÿæœ‰ä¸€äº›å†…ç½®çš„ <code>lazy</code> æ–¹æ³•ï¼Œå®ƒä»¬çš„æ‰§è¡Œæ—¶æœºä¹Ÿå°†æ¨è¿Ÿåˆ°å®é™…ä½¿ç”¨è¯¥æ–¹æ³•çš„è¿”å›å€¼æ—¶ã€‚</p>
</blockquote>
<h2 id="å±æ€§è§‚å¯Ÿå™¨">å±æ€§è§‚å¯Ÿå™¨</h2>
<p>åœ¨ Swift ä¸­ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å¯¹éå»¶è¿Ÿå­˜å‚¨å±æ€§æ·»åŠ å±æ€§è§‚å¯Ÿå™¨ï¼Œä»¥ä¾¿åœ¨å€¼å‘ç”Ÿæ”¹å˜ä¹‹å‰å’Œä¹‹åè¿›è¡Œä¸€äº›æ“ä½œï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Foo</span> {
    <span style="color:#66d9ef">var</span> bar: Int {
        <span style="color:#66d9ef">willSet</span> {
            print(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">\(</span>bar<span style="color:#e6db74">)</span><span style="color:#e6db74"> will set to </span><span style="color:#e6db74">\(</span>newValue<span style="color:#e6db74">)</span><span style="color:#e6db74">&#34;</span>)
        }

        <span style="color:#66d9ef">didSet</span> {
            print(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">\(</span>oldValue<span style="color:#e6db74">)</span><span style="color:#e6db74"> did set to </span><span style="color:#e6db74">\(</span>bar<span style="color:#e6db74">)</span><span style="color:#e6db74">&#34;</span>)
        }
    }

    <span style="color:#66d9ef">var</span> customValueParamsBar: Int = <span style="color:#ae81ff">0</span> {
        <span style="color:#66d9ef">willSet</span>(new) {
            print(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">\(</span>customValueParamsBar<span style="color:#e6db74">)</span><span style="color:#e6db74"> will set </span><span style="color:#e6db74">\(</span>new<span style="color:#e6db74">)</span><span style="color:#e6db74">&#34;</span>)
        }

        <span style="color:#66d9ef">didSet</span>(old) {
            print(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">\(</span>old<span style="color:#e6db74">)</span><span style="color:#e6db74"> did set to </span><span style="color:#e6db74">\(</span>customValueParamsBar<span style="color:#e6db74">)</span><span style="color:#e6db74">&#34;</span>)
        }
    }
}

<span style="color:#66d9ef">var</span> foo = Foo(bar: <span style="color:#ae81ff">10</span>)
foo.bar = <span style="color:#ae81ff">20</span> <span style="color:#75715e">// BREAKPOINT ğŸ”´</span>

<span style="color:#75715e">// 10 will set to 20</span>
<span style="color:#75715e">// 10 did set to 20</span>
</code></pre></div><p>å¦‚ä¸Šï¼Œåœ¨å€¼è¢«çœŸæ­£æ”¹å˜ä¹‹å‰ï¼Œå°†å…ˆé€šè¿‡ <code>willSet</code> æ–¹æ³•ï¼Œæ–°å€¼å°†é»˜è®¤å¯ä»¥é€šè¿‡ <code>newValue</code> å˜é‡è®¿é—®ï¼Œæ­¤æ—¶å› ä¸ºå¹¶ä¸ºæ‰§è¡Œèµ‹å€¼ï¼Œå› æ­¤æ—§å€¼å³å¯é€šè¿‡å˜é‡æœ¬èº« <code>bar</code> è®¿é—®ï¼›è®¾ç½®ååŒç†å¯é€šè¿‡ <code>didSet</code> æ–¹æ³•ï¼Œæ­¤æ—¶æ—§å€¼å°†é»˜è®¤å¯ä»¥é€šè¿‡ <code>oldValue</code> å˜é‡è®¿é—®ï¼Œæ–°å€¼åˆ™å¯ç›´æ¥é€šè¿‡å˜é‡æœ¬èº« <code>bar</code> è®¿é—®ã€‚</p>
<p>å°è¯•è¿è¡Œååœ¨æ–­ç‚¹å¤„æŸ¥çœ‹æ±‡ç¼–ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">-&gt;</span>  <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001c2e</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">62</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rcx, %rdi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001c31</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">65</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">leaq</span>   -<span style="color:#ae81ff">0x20</span>(%rbp), %rax
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001c35</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">69</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rsi, -<span style="color:#ae81ff">0x38</span>(%rbp)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001c39</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">73</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rax, %rsi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001c3c</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">76</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movl</span>   <span style="color:#66d9ef">$0x21</span>, %edx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001c41</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">81</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   -<span style="color:#ae81ff">0x38</span>(%rbp), %rcx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001c45</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">85</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100003bc0</span>               <span style="color:#75715e">; symbol stub for: swift_beginAccess
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100001c4a</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">90</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movl</span>   <span style="color:#66d9ef">$0x14</span>, %edi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001c4f</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">95</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">leaq</span>   <span style="color:#ae81ff">0x655a</span>(%rip), %r13        <span style="color:#75715e">; demo.foo : demo.Foo
</span><span style="color:#75715e"></span>    <span style="color:#75715e">; å°†è°ƒç”¨ setter
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100001c56</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">102</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100001cb0</span>               <span style="color:#75715e">; demo.Foo.bar.setter : Swift.Int at main.swift:4
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100001c5b</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">107</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">leaq</span>   -<span style="color:#ae81ff">0x20</span>(%rbp), %rdi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001c5f</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">111</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100003bd2</span>               <span style="color:#75715e">; symbol stub for: swift_endAccess
</span><span style="color:#75715e"></span>
<span style="color:#a6e22e">demo</span><span style="color:#960050;background-color:#1e0010">`</span><span style="color:#66d9ef">Foo.bar.setter</span>:
<span style="color:#960050;background-color:#1e0010">-&gt;</span>  <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001cb0</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">0</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">pushq</span>  %rbp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001cb1</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rsp, %rbp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001cb4</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">4</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">pushq</span>  %r13
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001cb6</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">6</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">subq</span>   <span style="color:#66d9ef">$0x38</span>, %rsp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001cba</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">10</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   <span style="color:#66d9ef">$0x0</span>, -<span style="color:#ae81ff">0x10</span>(%rbp)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001cc2</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">18</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   <span style="color:#66d9ef">$0x0</span>, -<span style="color:#ae81ff">0x18</span>(%rbp)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001cca</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">26</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   <span style="color:#66d9ef">$0x0</span>, -<span style="color:#ae81ff">0x20</span>(%rbp)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001cd2</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">34</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %rdi, -<span style="color:#ae81ff">0x10</span>(%rbp)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001cd6</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">38</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %r13, -<span style="color:#ae81ff">0x18</span>(%rbp)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001cda</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">42</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   (%r13), %rax
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001cde</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">46</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %rax, -<span style="color:#ae81ff">0x20</span>(%rbp)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001ce2</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">50</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %rdi, -<span style="color:#ae81ff">0x28</span>(%rbp)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001ce6</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">54</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %r13, -<span style="color:#ae81ff">0x30</span>(%rbp)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001cea</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">58</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %rax, -<span style="color:#ae81ff">0x38</span>(%rbp)
    <span style="color:#75715e">; å°†è°ƒç”¨ willset
</span><span style="color:#75715e"></span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001cee</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">62</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100001d20</span>               <span style="color:#75715e">; demo.Foo.bar.willset : Swift.Int at main.swift:5
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100001cf3</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">67</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   -<span style="color:#ae81ff">0x30</span>(%rbp), %rax
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001cf7</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">71</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   -<span style="color:#ae81ff">0x28</span>(%rbp), %rcx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001cfb</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">75</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %rcx, (%rax)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001cfe</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">78</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   -<span style="color:#ae81ff">0x38</span>(%rbp), %rdi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001d02</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">82</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %rax, %r13
    <span style="color:#75715e">; å°†è°ƒç”¨ didset
</span><span style="color:#75715e"></span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001d05</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">85</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100001fd0</span>               <span style="color:#75715e">; demo.Foo.bar.didset : Swift.Int at main.swift:9
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100001d0a</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">90</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">addq</span>   <span style="color:#66d9ef">$0x38</span>, %rsp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001d0e</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">94</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">popq</span>   %r13
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001d10</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">96</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">popq</span>   %rbp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001d11</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">97</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">retq</span>
</code></pre></div><p>æ­¤æ—¶å¯ä»¥å‘ç°ï¼Œå³ä½¿æˆ‘ä»¬æ”¹å˜çš„å˜é‡æœ¬è´¨æ˜¯å­˜å‚¨å±æ€§ï¼Œä½†ç¼–è¯‘å™¨ä»ç„¶ä¸ºå…¶ç”Ÿæˆäº† <code>setter</code> æ–¹æ³•ï¼Œå¹¶åœ¨è¯¥è¡Œæ‰§è¡Œ <code>si</code> è¿›å…¥åï¼Œå³ <code>setter</code> æ–¹æ³•ä¸­å…ˆè°ƒç”¨äº† <code>willSet</code>ï¼Œå¹¶åœ¨éšåè°ƒç”¨äº† <code>didSet</code>ã€‚</p>
<p>å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåˆå§‹åŒ–æ–¹æ³•æˆ–åœ¨å±æ€§å®šä¹‰æ—¶ç»™äºˆçš„é»˜è®¤å€¼æ—¶ï¼Œå°†ä¸ä¼šè§¦å‘å±æ€§è§‚å¯Ÿå™¨ï¼›å¦å¤–ï¼Œåœ¨ <code>willSet</code> ä¸­å¦‚æœç»§ç»­ç¼–å†™æ›´æ”¹åŸæœ‰å˜é‡å€¼çš„ä»£ç æ—¶ï¼Œæ—¢ä¸ä¼šå†æ¬¡è§¦å‘å±æ€§è§‚å¯Ÿå™¨ï¼Œä½†æ›´æ”¹ä¹Ÿä¸ä¼šç”Ÿæ•ˆï¼Œä½†åœ¨ <code>didSet</code> ä¸­ï¼Œè™½ç„¶ä¹Ÿä¸ä¼šå†æ¬¡è§¦å‘å±æ€§è§‚å¯Ÿå™¨ï¼Œä½†æ›´æ”¹å°†ä¼šç”Ÿæ•ˆï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Foo</span> {
    <span style="color:#66d9ef">var</span> bar: Int {
        <span style="color:#66d9ef">willSet</span> {
            <span style="color:#75715e">// WARNING: Attempting to store to property &#39;bar&#39; within its own willSet, which is about to be overwritten by the new value</span>
            bar = <span style="color:#ae81ff">1000</span>
            print(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">\(</span>bar<span style="color:#e6db74">)</span><span style="color:#e6db74"> will set to </span><span style="color:#e6db74">\(</span>newValue<span style="color:#e6db74">)</span><span style="color:#e6db74">&#34;</span>)
        }

        <span style="color:#66d9ef">didSet</span> {
            bar = <span style="color:#ae81ff">2000</span>
            print(<span style="color:#e6db74">&#34;</span><span style="color:#e6db74">\(</span>oldValue<span style="color:#e6db74">)</span><span style="color:#e6db74"> did set to </span><span style="color:#e6db74">\(</span>bar<span style="color:#e6db74">)</span><span style="color:#e6db74">&#34;</span>)
            bar = <span style="color:#ae81ff">3000</span>
        }
    }
}

<span style="color:#66d9ef">var</span> foo = Foo(bar: <span style="color:#ae81ff">10</span>)
foo.bar = <span style="color:#ae81ff">20</span>

print(foo.bar)

<span style="color:#75715e">// 10 will set to 20</span>
<span style="color:#75715e">// 10 did set to 2000</span>
<span style="color:#75715e">// 3000</span>
</code></pre></div><p>è™½ç„¶æˆ‘ä»¬äº†è§£äº†è¿™ä¸€è¡Œä¸ºï¼Œä½†åœ¨å±æ€§è§‚å¯Ÿå™¨ä¸­å†æ¬¡æ‰§è¡Œèµ‹å€¼æ“ä½œæœ¬èº«å°±æœ‰äº›è¯¡å¼‚ï¼Œå› æ­¤åº”å½“é¿å…ã€‚</p>
<h2 id="è®¡ç®—å±æ€§å±æ€§è§‚å¯Ÿå™¨ä¸-inout">è®¡ç®—å±æ€§ã€å±æ€§è§‚å¯Ÿå™¨ä¸ inout</h2>
<p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ç›´æ¥é€šè¿‡å®ä¾‹å¯¹è±¡å¯¹å˜é‡æœ¬èº«è¿›è¡Œäº†æ›´æ”¹ï¼Œå¹¶è§¦å‘äº†å±æ€§è§‚å¯Ÿå™¨ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬å°†å®ƒä»¬ä¼ é€’ç»™å«æœ‰ <code>inout</code> å‚æ•°çš„æ–¹æ³•å¹¶è¿›è¡Œæ›´æ”¹æ—¶ï¼Œè¿˜ä¼šè°ƒç”¨ç›¸åº”çš„ <code>willSet</code> å’Œ <code>didSet</code> æ–¹æ³•å—ï¼Ÿ</p>
<p>é¦–å…ˆæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªåä¸º <code>Foo</code> çš„ç»“æ„ä½“ç±»å‹ï¼Œå…¶ä¸­åŒ…å«æ™®é€šçš„å­˜å‚¨å±æ€§ã€å¸¦æœ‰å±æ€§è§‚å¯Ÿå™¨çš„å±æ€§ã€å’Œè®¡ç®—å±æ€§ï¼Œå¹¶åˆ›å»ºåä¸º <code>inoutFunc(_:)</code> å¸¦æœ‰ <code>inout</code> ç±»å‹ä½œä¸ºå‚æ•°çš„æ–¹æ³•ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Foo</span>: CustomStringConvertible {
    <span style="color:#66d9ef">var</span> a = <span style="color:#ae81ff">1</span>

    <span style="color:#66d9ef">var</span> b = <span style="color:#ae81ff">1</span> {
        <span style="color:#66d9ef">willSet</span> {
            print(<span style="color:#e6db74">&#34;b(</span><span style="color:#e6db74">\(</span>b<span style="color:#e6db74">)</span><span style="color:#e6db74">) will set to </span><span style="color:#e6db74">\(</span>newValue<span style="color:#e6db74">)</span><span style="color:#e6db74">&#34;</span>)
        }

        <span style="color:#66d9ef">didSet</span> {
            print(<span style="color:#e6db74">&#34;b(</span><span style="color:#e6db74">\(</span>oldValue<span style="color:#e6db74">)</span><span style="color:#e6db74">) did set to </span><span style="color:#e6db74">\(</span>b<span style="color:#e6db74">)</span><span style="color:#e6db74">&#34;</span>)
        }
    }

    <span style="color:#66d9ef">var</span> c: Int {
        <span style="color:#66d9ef">get</span> {
            print(<span style="color:#e6db74">&#34;c get&#34;</span>)
            <span style="color:#66d9ef">return</span> a <span style="color:#f92672">*</span> <span style="color:#ae81ff">10</span>
        }

        <span style="color:#66d9ef">set</span> {
            print(<span style="color:#e6db74">&#34;c set&#34;</span>)
            a = newValue <span style="color:#f92672">/</span> <span style="color:#ae81ff">10</span>
        }
    }

    <span style="color:#66d9ef">var</span> description: String {
        <span style="color:#e6db74">&#34;a: </span><span style="color:#e6db74">\(</span>a<span style="color:#e6db74">)</span><span style="color:#e6db74">, b: </span><span style="color:#e6db74">\(</span>b<span style="color:#e6db74">)</span><span style="color:#e6db74">, c: </span><span style="color:#e6db74">\(</span>c<span style="color:#e6db74">)</span><span style="color:#e6db74">&#34;</span>
    }
}

<span style="color:#66d9ef">func</span> <span style="color:#a6e22e">inoutFunc</span>(<span style="color:#66d9ef">_</span> param: <span style="color:#66d9ef">inout</span> Int) {
    param = <span style="color:#ae81ff">100</span>
}

<span style="color:#66d9ef">var</span> foo = Foo()

print(foo)

<span style="color:#75715e">// c get</span>
<span style="color:#75715e">// a: 1, b: 1, c: 10</span>
</code></pre></div><p>é¦–å…ˆæˆ‘ä»¬å°è¯•å°†ä¸å¸¦å±æ€§è§‚å¯Ÿå™¨çš„å˜é‡ä¼ é€’åˆ° <code>inoutFunc</code> ä¸­ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift">inoutFunc(&amp;foo.a) <span style="color:#75715e">// BREAKPOINT ğŸ”´</span>

print(foo)

<span style="color:#75715e">// c get</span>
<span style="color:#75715e">// a: 100, b: 1, c: 1000</span>
</code></pre></div><p>å°è¯•è¿è¡Œååœ¨æ–­ç‚¹å¤„æŸ¥çœ‹æ±‡ç¼–ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">-&gt;</span>  <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001958</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">296</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %rax, %rdi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x10000195b</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">299</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">leaq</span>   -<span style="color:#ae81ff">0x30</span>(%rbp), %rsi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x10000195f</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">303</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movl</span>   <span style="color:#66d9ef">$0x21</span>, %edx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001964</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">308</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100003a3c</span>               <span style="color:#75715e">; symbol stub for: swift_beginAccess
</span><span style="color:#75715e"></span>    <span style="color:#75715e">; å°† rip å¯„å­˜å™¨ä¸­çš„åœ°å€å€¼åŠ ä¸Š 0x6850ï¼ˆæ ¹æ®æ³¨é‡Šï¼Œè¯¥åœ°å€å¯¹åº”çš„å†…å®¹ä¸º demo.fooï¼‰å¹¶å­˜å‚¨åˆ° rdi å¯„å­˜å™¨ï¼ˆå‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°ï¼‰ä¸­
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100001969</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">313</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">leaq</span>   <span style="color:#ae81ff">0x6850</span>(%rip), %rdi        <span style="color:#75715e">; demo.foo : demo.Foo
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100001970</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">320</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x1000026f0</span>               <span style="color:#75715e">; demo.inoutFunc(inout Swift.Int) -&gt; () at main.swift:33
</span></code></pre></div><p>ç”±äºç»“æ„ä½“å˜é‡çš„é¦–åœ°å€å°±ç­‰åŒäºå…¶ä¸­ç¬¬ä¸€ä¸ªå£°æ˜çš„å˜é‡çš„åœ°å€ï¼Œå› æ­¤æ­¤æ—¶å­˜å‚¨å±æ€§å³æŒ‰åœ°å€ä¼ é€’åˆ° <code>inout</code> ä¿®é¥°å‚æ•°çš„æ–¹æ³•ä¸­ã€‚é‚£ä¹ˆå¸¦æœ‰å±æ€§è§‚å¯Ÿå™¨çš„å­˜å‚¨å±æ€§å‘¢ï¼Ÿ</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#75715e">// inoutFunc(&amp;foo.a)</span>

inoutFunc(&amp;foo.b) <span style="color:#75715e">// BREAKPOINT ğŸ”´</span>

print(foo)

<span style="color:#75715e">// b(1) will set to 100</span>
<span style="color:#75715e">// b(1) did set to 100</span>
<span style="color:#75715e">// c get</span>
<span style="color:#75715e">// a: 1, b: 100, c: 10</span>
</code></pre></div><p>é€šè¿‡è¾“å‡ºç»“æœï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºå±æ€§è§‚å¯Ÿå™¨åŒæ ·ä¹Ÿè¢«æ‰§è¡Œäº†ã€‚å°è¯•è¿è¡Œååœ¨æ–­ç‚¹å¤„æŸ¥çœ‹æ±‡ç¼–ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">-&gt;</span>  <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001942</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">50</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rcx, %rdi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001945</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">53</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">leaq</span>   -<span style="color:#ae81ff">0x20</span>(%rbp), %rax
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001949</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">57</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rsi, -<span style="color:#ae81ff">0x58</span>(%rbp)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x10000194d</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">61</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rax, %rsi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001950</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">64</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movl</span>   <span style="color:#66d9ef">$0x21</span>, %edx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001955</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">69</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   -<span style="color:#ae81ff">0x58</span>(%rbp), %rcx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001959</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">73</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100003a2c</span>               <span style="color:#75715e">; symbol stub for: swift_beginAccess
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x10000195e</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">78</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   <span style="color:#ae81ff">0x6863</span>(%rip), %rax        <span style="color:#75715e">; demo.foo : demo.Foo + 8
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100001965</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">85</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rax, -<span style="color:#ae81ff">0x28</span>(%rbp)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001969</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">89</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">leaq</span>   -<span style="color:#ae81ff">0x28</span>(%rbp), %rdi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x10000196d</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">93</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x1000026e0</span>               <span style="color:#75715e">; demo.inoutFunc(inout Swift.Int) -&gt; () at main.swift:33
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100001972</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">98</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   -<span style="color:#ae81ff">0x28</span>(%rbp), %rdi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001976</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">102</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">leaq</span>   <span style="color:#ae81ff">0x6843</span>(%rip), %r13        <span style="color:#75715e">; demo.foo : demo.Foo
</span><span style="color:#75715e"></span>    <span style="color:#75715e">; å°†è°ƒç”¨ setter
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x10000197d</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">109</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100001b30</span>               <span style="color:#75715e">; demo.Foo.b.setter : Swift.Int at main.swift:6
</span></code></pre></div><p>ä¸ä¹‹å‰ä¸åŒçš„æ˜¯ï¼Œå½“æ‰§è¡Œå®Œ <code>inoutFunc</code> åï¼Œ<code>setter</code> ä»ç„¶å¾—åˆ°äº†è°ƒç”¨ï¼Œä½†å…·ä½“åŸå› æˆ‘ä»¬å…ˆç»§ç»­çœ‹ä¸‹è®¡ç®—å±æ€§ã€‚æˆ‘ä»¬çŸ¥é“è®¡ç®—å±æ€§å¹¶ä¸éœ€è¦å†…å­˜æ¥å­˜å‚¨ç»“æœï¼Œè€Œå…¶ç»“æœæ¥è‡ªäºå…¶å®ƒå±æ€§çš„è®¡ç®—ã€‚å› æ­¤å³ä½¿ <code>inoutFunc</code> ä¹Ÿå¹¶ä¸ä¼šè·å–åˆ°å˜é‡ <code>c</code> çš„å†…å­˜åœ°å€ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#75715e">// inoutFunc(&amp;foo.a)</span>

<span style="color:#75715e">// inoutFunc(&amp;foo.b)</span>

inoutFunc(&amp;foo.c) <span style="color:#75715e">// BREAKPOINT ğŸ”´</span>

print(foo)

<span style="color:#75715e">// c get</span>
<span style="color:#75715e">// c set</span>
<span style="color:#75715e">// c get</span>
<span style="color:#75715e">// a: 10, b: 1, c: 100</span>
</code></pre></div><p>å°è¯•è¿è¡Œååœ¨æ–­ç‚¹å¤„æŸ¥çœ‹æ±‡ç¼–ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">-&gt;</span>  <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001932</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">50</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rcx, %rdi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001935</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">53</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">leaq</span>   -<span style="color:#ae81ff">0x20</span>(%rbp), %rax
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001939</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">57</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rsi, -<span style="color:#ae81ff">0x58</span>(%rbp)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x10000193d</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">61</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rax, %rsi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001940</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">64</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movl</span>   <span style="color:#66d9ef">$0x21</span>, %edx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001945</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">69</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   -<span style="color:#ae81ff">0x58</span>(%rbp), %rcx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001949</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">73</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100003a2c</span>               <span style="color:#75715e">; symbol stub for: swift_beginAccess
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x10000194e</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">78</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   <span style="color:#ae81ff">0x686b</span>(%rip), %rdi        <span style="color:#75715e">; demo.foo : demo.Foo
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100001955</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">85</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   <span style="color:#ae81ff">0x686c</span>(%rip), %rsi        <span style="color:#75715e">; demo.foo : demo.Foo + 8
</span><span style="color:#75715e"></span>    <span style="color:#75715e">; å°†è°ƒç”¨è®¡ç®—å±æ€§çš„ getter
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x10000195c</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">92</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x1000020d0</span>               <span style="color:#75715e">; demo.Foo.c.getter : Swift.Int at main.swift:17
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100001961</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">97</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rax, -<span style="color:#ae81ff">0x28</span>(%rbp)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001965</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">101</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">leaq</span>   -<span style="color:#ae81ff">0x28</span>(%rbp), %rdi
    <span style="color:#75715e">; å°†è°ƒç”¨ inoutFunc
</span><span style="color:#75715e"></span>    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001969</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">105</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x1000026e0</span>               <span style="color:#75715e">; demo.inoutFunc(inout Swift.Int) -&gt; () at main.swift:33
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x10000196e</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">110</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   -<span style="color:#ae81ff">0x28</span>(%rbp), %rdi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100001972</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">114</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">leaq</span>   <span style="color:#ae81ff">0x6847</span>(%rip), %r13        <span style="color:#75715e">; demo.foo : demo.Foo
</span><span style="color:#75715e"></span>    <span style="color:#75715e">; å°†è°ƒç”¨è®¡ç®—å±æ€§çš„ setter
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100001979</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">121</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100002220</span>               <span style="color:#75715e">; demo.Foo.c.setter : Swift.Int at main.swift:22
</span></code></pre></div><p>æ ¹æ®æ±‡ç¼–ï¼Œå½“é‡åˆ°è®¡ç®—å±æ€§æˆ–å¸¦æœ‰å­˜å‚¨å±æ€§è§‚å¯Ÿå™¨çš„å­˜å‚¨å±æ€§æ—¶ï¼Œå°†å…ˆé€šè¿‡ <code>getter</code> å°†å€¼æ‹·è´åˆ°ä¸€ä¸ªå¤–ç•Œçš„å±€éƒ¨å˜é‡ä¸Šï¼Œå†å°†è¯¥å˜é‡çš„åœ°å€ä¼ é€’åˆ° <code>inoutFunc</code> æ–¹æ³•ä¸­ï¼Œå¾—åˆ°ç»“æœåå¤–ç•Œå˜é‡å°†é‡æ–°é€šè¿‡ <code>setter</code> å°†å€¼è®¾ç½®å›åŸæœ‰çš„è®¡ç®—å±æ€§ã€‚</p>
<h2 id="ç±»å‹å±æ€§">ç±»å‹å±æ€§</h2>
<p>ç±»å‹å±æ€§æŒ‡çš„æ˜¯é€šè¿‡ç±»å‹ç›´æ¥è®¿é—®çš„å±æ€§ï¼Œè¿™æ ·çš„å­˜å‚¨å±æ€§å°†ç±»ä¼¼äºå…¨å±€å˜é‡ï¼Œå³åªä¼šåœ¨å†…å­˜ä¸­ä¿å­˜ä¸€ä»½ã€‚æˆ‘ä»¬åœ¨ç»“æ„ä½“ã€ç±»ã€æšä¸¾ä¸­å‡å¯ä»¥å®šä¹‰ç±»å‹å±æ€§ï¼Œé€šå¸¸ä½¿ç”¨ <code>static</code> å…³é”®å­—ï¼›åœ¨ç±»ä¸­ï¼Œå¦‚æœå®šä¹‰çš„ç±»å‹å±æ€§æ˜¯è®¡ç®—å±æ€§ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥ä½¿ç”¨ <code>class</code> å…³é”®å­—ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Foo</span> {
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">var</span> foo: Int = <span style="color:#ae81ff">0</span>
}

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Bar</span> {
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">var</span> bar1: Int = <span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">let</span> bar2: Int = <span style="color:#ae81ff">0</span>

    <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">var</span> bar3: Int {
        <span style="color:#ae81ff">0</span>
    }
}

<span style="color:#66d9ef">enum</span> <span style="color:#a6e22e">Baz</span> {
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">var</span> baz = <span style="color:#ae81ff">0</span>
}

print(Foo.foo)  <span style="color:#75715e">// 0</span>
print(Bar.bar1) <span style="color:#75715e">// 0</span>
print(Bar.bar2) <span style="color:#75715e">// 0</span>
print(Bar.bar3) <span style="color:#75715e">// 0</span>
print(Baz.baz)  <span style="color:#75715e">// 0</span>
</code></pre></div><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç”±äºç±»å‹å±æ€§éé’ˆå¯¹äºæŸä¸€å®ä¾‹å¯¹è±¡ï¼Œå› æ­¤å…¶å¿…é¡»åœ¨å£°æ˜æ—¶å³ç»™å®šåˆå§‹å€¼ï¼›ç±»å‹å±æ€§å¦‚æœåŒæ—¶ä¸ºå­˜å‚¨å±æ€§ï¼Œé»˜è®¤å³ä¸º <code>lazy</code> å»¶è¿Ÿï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Foo</span> {
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">var</span> foo: Int = <span style="color:#ae81ff">0</span>

    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">var</span> calculateFoo: Int = {
        print(<span style="color:#e6db74">&#34;calculateFoo init&#34;</span>)
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
    }()
}

<span style="color:#75715e">// 0</span>
<span style="color:#75715e">// calculateFoo init</span>
</code></pre></div><p>ä½†æ­¤æ—¶çš„å»¶è¿Ÿå­˜å‚¨å±æ€§æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Foundation</span>

<span style="color:#66d9ef">struct</span> <span style="color:#a6e22e">Foo</span> {
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">var</span> foo: Int = <span style="color:#ae81ff">0</span>

    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">var</span> calculateFoo: Int = {
        print(<span style="color:#e6db74">&#34;calculateFoo init&#34;</span>)
        <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>
    }()
}

print(Foo.foo)

DispatchQueue.concurrentPerform(iterations: <span style="color:#ae81ff">5</span>) { <span style="color:#66d9ef">_</span> <span style="color:#66d9ef">in</span>
    print(<span style="color:#e6db74">&#34;--- </span><span style="color:#e6db74">\(</span>Thread.current<span style="color:#e6db74">)</span><span style="color:#e6db74"> ---&#34;</span>)
    print(Foo.calculateFoo)
}

<span style="color:#75715e">// 0</span>
<span style="color:#75715e">// --- &lt;NSThread: 0x1020be860&gt;{number = 4, name = (null)} ---</span>
<span style="color:#75715e">// calculateFoo init</span>
<span style="color:#75715e">// 0</span>
<span style="color:#75715e">// --- &lt;NSThread: 0x1007042d0&gt;{number = 3, name = (null)} ---</span>
<span style="color:#75715e">// 0</span>
<span style="color:#75715e">// --- &lt;NSThread: 0x1021040c0&gt;{number = 2, name = (null)} ---</span>
<span style="color:#75715e">// 0</span>
<span style="color:#75715e">// --- &lt;NSThread: 0x10200ab30&gt;{number = 1, name = main} ---</span>
<span style="color:#75715e">// 0</span>
<span style="color:#75715e">// --- &lt;NSThread: 0x1022040c0&gt;{number = 5, name = (null)} ---</span>
<span style="color:#75715e">// 0</span>
<span style="color:#75715e">// 0</span>
</code></pre></div><p>å¦‚ä¸Šï¼Œå³ä½¿åŒæ—¶ 5 ä¸ªçº¿ç¨‹å¹¶å‘è®¿é—®ï¼Œ<code>calculateFoo</code> ä¹Ÿå°†è¢«ä¿è¯åªåˆå§‹åŒ–ä¸€æ¬¡ã€‚ç±»å‹å±æ€§é€šå¸¸å¯ä»¥ç”¨äºå•ä¾‹æ¨¡å¼ï¼Œå³æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ä»…åˆå§‹åŒ–ä¸€æ¬¡ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">SomeManager</span> {
    <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">var</span> manager: SomeManager = {
        <span style="color:#66d9ef">var</span> manager = SomeManager()
        manager.foo = <span style="color:#ae81ff">10</span>
        <span style="color:#66d9ef">return</span> manager
    }()

    <span style="color:#66d9ef">var</span> foo: Int = <span style="color:#ae81ff">0</span>

    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">init</span>() {}

    <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">bar</span>() {
        print(<span style="color:#66d9ef">#function</span>, foo)
    }
}

SomeManager.manager.bar()

<span style="color:#75715e">// bar() 10</span>
</code></pre></div><h2 id="reference">Reference</h2>
<ul>
<li><a href="http://www.jianshu.com/p/80810efe5229">æµ…è°ˆ Swift 3 ä¸­çš„è®¿é—®æ§åˆ¶</a></li>
<li><a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/AccessControl.html">Access Control</a></li>
<li><a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Properties.html">Properties</a></li>
<li><a href="https://github.com/devxoul/Then">devxoul/Then</a></li>
<li><a href="http://swifter.tips/lazy/">lazy ä¿®é¥°ç¬¦å’Œ lazy æ–¹æ³•</a></li>
<li><a href="https://www.bilibili.com/video/BV1cx411S7ay">ã€èœé¸¡ Playground 1ã€‘Swift ä¸­ lazy initialization</a></li>
<li><a href="https://www.bilibili.com/video/av10142408/">ã€èœé¸¡ Playground 2ã€‘Swift ä¸­ lazy initialization çš„ä½¿ç”¨åœºæ™¯</a></li>
</ul>

    </div>
    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h">Read other posts</span>
          <hr />
        </div>
        <div class="pagination__buttons">
          
          
            <span class="button next">
              <a href="/posts/2018/swift_autoclosure/">
                <span class="button__text">Swift ä¸­çš„ @autoclosure</span>
                <span class="button__icon">â†’</span>
              </a>
            </span>
          
        </div>
      </div>
    

    

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<table style="border: 0;">
  <tr>
  <td style="border: 0; width: 30%;">
    <img src='/img/about/1.jpg'>
  </td>
  <td style="border: 0;">
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-9925978992661955"
     data-ad-slot="3213735320"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
  </td>
  </tr>
</table>



<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>


    
    
    <div>
      <div id="github-comment">
      </div>

      <script type="text/javascript">
        function getUtterances(isDark) {
          var utterances = document.createElement('script');
          utterances.type = 'text/javascript';
          utterances.async = true;
          utterances.setAttribute('issue-term', "pathname")
          utterances.setAttribute('repo', "kingcos\/kingcos.github.io")
          utterances.setAttribute('label', "comments")
          isDark ? utterances.setAttribute('theme', "github-dark") : utterances.setAttribute('theme', "github-light")
          utterances.crossorigin = 'anonymous';
          utterances.src = 'https://utteranc.es/client.js';

          return utterances
        }

        var themeToggle = document.querySelector(".theme-toggle")
        themeToggle.addEventListener("click", function () {
          var getTheme = window.localStorage && window.localStorage.getItem("theme")
          var divNode = document.getElementById('github-comment')
          while(divNode.hasChildNodes()) {
            divNode.removeChild(divNode.firstChild);
          }
          
          
          

          
          
          
          
          
          
          document.getElementById('github-comment').appendChild(getUtterances(getTheme !== "dark"))
        })

        var getTheme = window.localStorage && window.localStorage.getItem("theme")
        document.getElementById('github-comment').appendChild(getUtterances(getTheme === "dark"))
      </script>
    </div>
    

    </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">All rights reserved by kingcos.me</div>
    
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>



      
    </div>

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-138311951-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
  </body>
</html>
