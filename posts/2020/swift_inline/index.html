<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>Swift æ‹¾é— - å†…è”å‡½æ•° :: iBlog</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Preface å†…è”å‡½æ•°ï¼ˆInline Functionsï¼‰æ˜¯æŒ‡ç¼–è¯‘æ—¶åˆ»å°†å‡½æ•°è°ƒç”¨å±•å¼€ä¸ºå‡½æ•°ä½“çš„ä¸€ç§ç¼–ç¨‹è¯­è¨€ç»“æ„ï¼Œç¼–è¯‘å™¨å°†é€‚æ—¶é‡‡å–è¿™ä¸€æŠ€æœ¯å¯ä»¥èŠ‚çœè°ƒç”¨å‡½æ•°æ‰€å¸¦æ¥çš„é¢å¤–å¼€é”€ï¼Œæœ¬æ–‡å°†ç®€å•è®²è®² Swift ä¸­çš„å†…è”å‡½æ•°ã€‚
æ¡ä»¶ ç”±äºå†…è”å‡½æ•°ä¼šå°†å‡½æ•°è°ƒç”¨å±•å¼€ä¸ºå‡½æ•°ä½“ï¼Œå› æ­¤å½“ç¼–è¯‘å™¨å†…è”æŸä¸€å‡½æ•°æ—¶ï¼Œè¯¥å‡½æ•°æœ¬èº«å°†ä¸å†ä¼šè¢«è°ƒç”¨ã€‚è€Œåœ¨ Debug æ¨¡å¼ä¸‹ï¼Œç”±äºæˆ‘ä»¬ç»å¸¸ä¼šä½¿ç”¨æ‰“æ–­ç‚¹ç­‰è°ƒè¯•æ‰‹æ®µï¼Œå¦‚æœæ­¤æ—¶å†…è”å°†ä¸åˆ©äºæˆ‘ä»¬æ’æŸ¥é—®é¢˜ã€‚å› æ­¤åœ¨ Debug æ¨¡å¼ä¸‹ï¼Œç¼–è¯‘å™¨é»˜è®¤å°†ä¸è¿›è¡Œå†…è”ã€‚
æ§åˆ¶ç¼–è¯‘å™¨ä¼˜åŒ–ç­‰çº§çš„è®¾ç½®ä½äºï¼šXcode - TARGETS - Build Settings - Swift Compiler - Optimization Levelï¼Œå…¶ä¸­ä¾¿ä¼šå½±å“ Swift å‡½æ•°æ˜¯å¦å†…è”ï¼š
Swift ç¼–è¯‘å™¨æ‰€æ”¯æŒçš„ä¼˜åŒ–ç­‰çº§å…·ä½“å¦‚ä¸‹ï¼š
   Level Part     [-Onone] æ— ä¼˜åŒ–ï¼ˆDebug æ¨¡å¼é»˜è®¤ï¼‰   [-O] é€Ÿåº¦ä¼˜å…ˆï¼ˆRelease æ¨¡å¼é»˜è®¤ï¼‰   [-Osize] ä½“ç§¯ä¼˜å…ˆ    ç»è¿‡å®é™…æµ‹è¯•ï¼Œå¦‚ä¸‹ foo å‡½æ•°åœ¨ [-O] ä¸ [-Osize] ç­‰çº§ä¸‹å‡è¢«ä¼˜åŒ–ï¼š
func foo() { print(&amp;#34;foo&amp;#34;) // BREAKPOINT 2 ğŸ”´ foo() // BREAKPOINT 1 ğŸ”´ åœ¨ [-Onone] ç­‰çº§çš„æ±‡ç¼–å¦‚ä¸‹ï¼ˆXcode Menu - Debug - Debug Workflow - Always Show Disassemblyï¼‰ï¼š"/>
<meta name="keywords" content="kingcos.me,maimieng.comios,swift,objective-c,obj-c,objc,oc,geek,python,ruby,golang,go,apple,mac"/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="/posts/2020/swift_inline/" />





<link rel="stylesheet" href="/assets/style.css">


<link rel="stylesheet" href="/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/img/favicon.png">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Swift æ‹¾é— - å†…è”å‡½æ•°"/>
<meta name="twitter:description" content="å†…è”å‡½æ•°ï¼ˆInline Functionsï¼‰æ˜¯æŒ‡ç¼–è¯‘æ—¶åˆ»å°†å‡½æ•°è°ƒç”¨å±•å¼€ä¸ºå‡½æ•°ä½“çš„ä¸€ç§ç¼–ç¨‹è¯­è¨€ç»“æ„ï¼Œç¼–è¯‘å™¨å°†é€‚æ—¶é‡‡å–è¿™ä¸€æŠ€æœ¯å¯ä»¥èŠ‚çœè°ƒç”¨å‡½æ•°æ‰€å¸¦æ¥çš„é¢å¤–å¼€é”€ï¼Œæœ¬æ–‡å°†ç®€å•è®²è®² Swift ä¸­çš„å†…è”å‡½æ•°ã€‚"/>



<meta property="og:title" content="Swift æ‹¾é— - å†…è”å‡½æ•°" />
<meta property="og:description" content="å†…è”å‡½æ•°ï¼ˆInline Functionsï¼‰æ˜¯æŒ‡ç¼–è¯‘æ—¶åˆ»å°†å‡½æ•°è°ƒç”¨å±•å¼€ä¸ºå‡½æ•°ä½“çš„ä¸€ç§ç¼–ç¨‹è¯­è¨€ç»“æ„ï¼Œç¼–è¯‘å™¨å°†é€‚æ—¶é‡‡å–è¿™ä¸€æŠ€æœ¯å¯ä»¥èŠ‚çœè°ƒç”¨å‡½æ•°æ‰€å¸¦æ¥çš„é¢å¤–å¼€é”€ï¼Œæœ¬æ–‡å°†ç®€å•è®²è®² Swift ä¸­çš„å†…è”å‡½æ•°ã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/2020/swift_inline/" />
<meta property="article:published_time" content="2020-07-26T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-07-26T00:00:00+00:00" /><meta property="og:site_name" content="iBlog" />




<script data-ad-client="ca-pub-9925978992661955" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  </head>
  <body class="">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">kingcos.me</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/links">Links</a></li>
        
      
        
          <li><a href="/perspective">Perspective</a></li>
        
      
        
          <li><a href="/words">Words</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/links">Links</a></li>
      
    
      
        <li><a href="/perspective">Perspective</a></li>
      
    
      
        <li><a href="/words">Words</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  <div class="post">
    <h2 class="post-title"><a href="/posts/2020/swift_inline/">Swift æ‹¾é— - å†…è”å‡½æ•°</a></h2>
    <div class="post-meta">
      
        <span class="post-date">
            2020-07-26
        </span>
      
      
      
        <span class="post-read-time">â€” 5 min read</span>
      
    </div>

    
      <span class="post-tags">
        
          #<a href="/tags/focus/">Focus</a>&nbsp;
        
          #<a href="/tags/swift/">Swift</a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      <h2 id="preface">Preface</h2>
<p>å†…è”å‡½æ•°ï¼ˆInline Functionsï¼‰æ˜¯æŒ‡ç¼–è¯‘æ—¶åˆ»å°†å‡½æ•°è°ƒç”¨å±•å¼€ä¸ºå‡½æ•°ä½“çš„ä¸€ç§ç¼–ç¨‹è¯­è¨€ç»“æ„ï¼Œç¼–è¯‘å™¨å°†é€‚æ—¶é‡‡å–è¿™ä¸€æŠ€æœ¯å¯ä»¥èŠ‚çœè°ƒç”¨å‡½æ•°æ‰€å¸¦æ¥çš„é¢å¤–å¼€é”€ï¼Œæœ¬æ–‡å°†ç®€å•è®²è®² Swift ä¸­çš„å†…è”å‡½æ•°ã€‚</p>
<h2 id="æ¡ä»¶">æ¡ä»¶</h2>
<p>ç”±äºå†…è”å‡½æ•°ä¼šå°†å‡½æ•°è°ƒç”¨å±•å¼€ä¸ºå‡½æ•°ä½“ï¼Œå› æ­¤å½“ç¼–è¯‘å™¨å†…è”æŸä¸€å‡½æ•°æ—¶ï¼Œè¯¥å‡½æ•°æœ¬èº«å°†ä¸å†ä¼šè¢«è°ƒç”¨ã€‚è€Œåœ¨ Debug æ¨¡å¼ä¸‹ï¼Œç”±äºæˆ‘ä»¬ç»å¸¸ä¼šä½¿ç”¨æ‰“æ–­ç‚¹ç­‰è°ƒè¯•æ‰‹æ®µï¼Œå¦‚æœæ­¤æ—¶å†…è”å°†ä¸åˆ©äºæˆ‘ä»¬æ’æŸ¥é—®é¢˜ã€‚å› æ­¤åœ¨ Debug æ¨¡å¼ä¸‹ï¼Œç¼–è¯‘å™¨é»˜è®¤å°†ä¸è¿›è¡Œå†…è”ã€‚</p>
<p>æ§åˆ¶ç¼–è¯‘å™¨ä¼˜åŒ–ç­‰çº§çš„è®¾ç½®ä½äºï¼šXcode - TARGETS - Build Settings - Swift Compiler - Optimization Levelï¼Œå…¶ä¸­ä¾¿ä¼šå½±å“ Swift å‡½æ•°æ˜¯å¦å†…è”ï¼š</p>
<p><img src="/img/2020/swift_inline/1.png" alt="1"></p>
<p>Swift ç¼–è¯‘å™¨æ‰€æ”¯æŒçš„ä¼˜åŒ–ç­‰çº§å…·ä½“å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th align="center">Level</th>
<th align="center">Part</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">[-Onone]</td>
<td align="center">æ— ä¼˜åŒ–ï¼ˆDebug æ¨¡å¼é»˜è®¤ï¼‰</td>
</tr>
<tr>
<td align="center">[-O]</td>
<td align="center">é€Ÿåº¦ä¼˜å…ˆï¼ˆRelease æ¨¡å¼é»˜è®¤ï¼‰</td>
</tr>
<tr>
<td align="center">[-Osize]</td>
<td align="center">ä½“ç§¯ä¼˜å…ˆ</td>
</tr>
</tbody>
</table>
<p>ç»è¿‡å®é™…æµ‹è¯•ï¼Œå¦‚ä¸‹ <code>foo</code> å‡½æ•°åœ¨ <code>[-O]</code> ä¸ <code>[-Osize]</code> ç­‰çº§ä¸‹å‡è¢«ä¼˜åŒ–ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">foo</span>() {
    print(<span style="color:#e6db74">&#34;foo&#34;</span>) <span style="color:#75715e">// BREAKPOINT 2 ğŸ”´</span>

foo() <span style="color:#75715e">// BREAKPOINT 1 ğŸ”´</span>
</code></pre></div><p>åœ¨ <code>[-Onone]</code> ç­‰çº§çš„æ±‡ç¼–å¦‚ä¸‹ï¼ˆXcode Menu - Debug - Debug Workflow - Always Show Disassemblyï¼‰ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#75715e">; [-Onone]
</span><span style="color:#75715e"></span><span style="color:#a6e22e">demo</span><span style="color:#960050;background-color:#1e0010">`</span><span style="color:#66d9ef">main</span>:
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000e50</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">0</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">pushq</span>  %rbp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000e51</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rsp, %rbp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000e54</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">4</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">subq</span>   <span style="color:#66d9ef">$0x10</span>, %rsp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000e58</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">8</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movl</span>   %edi, -<span style="color:#ae81ff">0x4</span>(%rbp)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000e5b</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">11</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %rsi, -<span style="color:#ae81ff">0x10</span>(%rbp)
    <span style="color:#75715e">; æ–­ç‚¹ 1 â¬‡ï¼šå‡½æ•°è°ƒç”¨ï¼ˆå†…è”ååˆ™ä¸å­˜åœ¨è¯¥è¡Œæ±‡ç¼–æŒ‡ä»¤ï¼‰
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">-&gt;</span>  <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000e5f</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">15</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100000e70</span>               <span style="color:#75715e">; demo.foo() -&gt; () at main.swift:11
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000e64</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">20</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">xorl</span>   %eax, %eax
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000e66</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">22</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">addq</span>   <span style="color:#66d9ef">$0x10</span>, %rsp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000e6a</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">26</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">popq</span>   %rbp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000e6b</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">27</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">retq</span>

<span style="color:#a6e22e">demo</span><span style="color:#960050;background-color:#1e0010">`</span><span style="color:#66d9ef">foo</span>():
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000e70</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">0</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:   <span style="color:#66d9ef">pushq</span>  %rbp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000e71</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:   <span style="color:#66d9ef">movq</span>   %rsp, %rbp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000e74</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">4</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:   <span style="color:#66d9ef">subq</span>   <span style="color:#66d9ef">$0x30</span>, %rsp
    <span style="color:#75715e">; æ–­ç‚¹ 2 â¬‡ï¼šä½œç”¨åŸŸåœ¨ foo() å†…
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">-&gt;</span>  <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000e78</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">8</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:   <span style="color:#66d9ef">movq</span>   <span style="color:#ae81ff">0x189</span>(%rip), %rax         <span style="color:#75715e">; (void *)0x00007fff8b1517e0: type metadata for Any
</span><span style="color:#75715e"></span>    <span style="color:#75715e">; ...
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000f17</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">167</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">retq</span>
</code></pre></div><p>åœ¨ <code>[-O]</code> ç­‰çº§çš„æ±‡ç¼–å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#75715e">; [-O]
</span><span style="color:#75715e"></span><span style="color:#a6e22e">demo</span><span style="color:#960050;background-color:#1e0010">`</span><span style="color:#66d9ef">main</span>:
    <span style="color:#75715e">; ...
</span><span style="color:#75715e"></span>    <span style="color:#75715e">; æ–­ç‚¹ 2 â¬‡ï¼šä½œç”¨åŸŸåœ¨ main å†…
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">-&gt;</span>  <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000e32</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">50</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   <span style="color:#ae81ff">0x1c7</span>(%rip), %rax         <span style="color:#75715e">; (void *)0x00007fff8b149910: type metadata for Swift.String
</span><span style="color:#75715e"></span>    <span style="color:#75715e">; ...
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000e82</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">130</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">retq</span>
</code></pre></div><p>åœ¨ <code>[-Osize]</code> ç­‰çº§çš„æ±‡ç¼–å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#75715e">; [-Osize]
</span><span style="color:#75715e"></span><span style="color:#a6e22e">demo</span><span style="color:#960050;background-color:#1e0010">`</span><span style="color:#66d9ef">main</span>:
    <span style="color:#75715e">; ...
</span><span style="color:#75715e"></span>    <span style="color:#75715e">; æ–­ç‚¹ 2 â¬‡ï¼šä½œç”¨åŸŸåœ¨ main å†…
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">-&gt;</span>  <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000e3e</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">46</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   <span style="color:#ae81ff">0x1bb</span>(%rip), %rax         <span style="color:#75715e">; (void *)0x00007fff8b149910: type metadata for Swift.String
</span><span style="color:#75715e"></span>    <span style="color:#75715e">; ...
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000e8a</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">122</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">retq</span>
</code></pre></div><p><code>[-O]</code> ä¸ <code>[-Osize]</code> çš„ç»“æœç±»ä¼¼ï¼Œå³é€šè¿‡å†…è”ä½¿å¾—æ–­ç‚¹ 1 ä¸å†æ‰§è¡Œï¼›è€Œæ–­ç‚¹ 2 è™½ç„¶å¾—åˆ°æ‰§è¡Œï¼Œä½†é€šè¿‡æŸ¥çœ‹æ±‡ç¼–å¯ä»¥çœ‹å‡ºï¼Œæ–­ç‚¹ 2 å¤„çš„ä»£ç ä½œç”¨åŸŸå·²å˜ä¸º <code>main</code>ï¼Œä¸”æ—  <code>call</code> ç›¸å…³å‡½æ•°çš„æŒ‡ä»¤ã€‚</p>
<h2 id="åä¾‹">åä¾‹</h2>
<hr>
<p>å†…è”å‡½æ•°ï¼ˆInline Functionsï¼‰æŒ‡ç¼–è¯‘æ—¶åˆ»å°†å‡½æ•°è°ƒç”¨å±•å¼€æˆå‡½æ•°ä½“ã€‚åœ¨ Xcode ä¸­çš„ Swift é¡¹ç›®ä¸­ï¼Œå¦‚æœå¼€å¯äº†ç¼–è¯‘å™¨ä¼˜åŒ–ï¼ˆRelease æ¨¡å¼é»˜è®¤ä¼šå¼€å¯ä¼˜åŒ–ï¼‰ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å°†æŸäº›å‡½æ•°å˜æˆå†…è”å‡½æ•°ã€‚ä½†è‹¥å‡½æ•°å­˜åœ¨ä»¥ä¸‹ç‰¹ç‚¹å°†ä¸ä¼šè¢«è‡ªåŠ¨å†…è”ï¼š</p>
<ol>
<li>å‡½æ•°ä½“è¾ƒé•¿æ—¶ï¼ˆå› å†…è”ä¼šå¯¼è‡´å¯æ‰§è¡Œä»£ç ä½“ç§¯å¢å¤§ï¼‰</li>
<li>åŒ…å«é€’å½’è°ƒç”¨æ—¶ï¼ˆå› å†…è”ä¼šå¯¼è‡´æ­»å¾ªç¯ï¼‰</li>
<li>åŒ…å«åŠ¨æ€æ´¾å‘æ—¶ï¼ˆå› ç¼–è¯‘æ—¶åˆ»æ— æ³•ç¡®è®¤è¦æ‰§è¡Œçš„ä»£ç ï¼‰</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">foo</span>() {
    print(<span style="color:#e6db74">&#34;foo&#34;</span>) <span style="color:#75715e">// BREAKPOINT ğŸ”´</span>
}

foo() <span style="color:#75715e">// BREAKPOINT ğŸ”´</span>
</code></pre></div><p>å°†ä»¥ä¸Šä»£ç è½¬æ¢ä¸ºæ±‡ç¼–ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-asm" data-lang="asm"><span style="color:#960050;background-color:#1e0010">//</span> <span style="color:#a6e22e">DEBUG</span> <span style="color:#960050;background-color:#1e0010">é»˜è®¤ï¼ˆ</span><span style="color:#66d9ef">No</span> <span style="color:#66d9ef">Optimization</span> [-<span style="color:#66d9ef">Onone</span>]<span style="color:#960050;background-color:#1e0010">ï¼‰</span>

<span style="color:#a6e22e">demo</span><span style="color:#960050;background-color:#1e0010">`</span><span style="color:#66d9ef">main</span>:
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a50</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">0</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">pushq</span>  %rbp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a51</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rsp, %rbp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a54</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">4</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">subq</span>   <span style="color:#66d9ef">$0x10</span>, %rsp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a58</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">8</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movl</span>   %edi, -<span style="color:#ae81ff">0x4</span>(%rbp)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a5b</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">11</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %rsi, -<span style="color:#ae81ff">0x10</span>(%rbp)
    <span style="color:#75715e">; å‡½æ•°è°ƒç”¨ï¼ˆä¸‹é¢å¼€å¯ç¼–è¯‘å™¨ä¼˜åŒ–åï¼Œåˆ™ä¸å­˜åœ¨è¯¥è¡Œæ±‡ç¼–æŒ‡ä»¤ï¼‰
</span><span style="color:#75715e"></span><span style="color:#960050;background-color:#1e0010">-&gt;</span>  <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a5f</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">15</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100000a70</span>               <span style="color:#75715e">; demo.foo() -&gt; () at main.swift:11
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a64</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">20</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">xorl</span>   %eax, %eax
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a66</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">22</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">addq</span>   <span style="color:#66d9ef">$0x10</span>, %rsp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a6a</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">26</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">popq</span>   %rbp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a6b</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">27</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">retq</span>

<span style="color:#960050;background-color:#1e0010">//</span> <span style="color:#a6e22e">DEBUG</span><span style="color:#960050;background-color:#1e0010">ï¼ˆ</span><span style="color:#66d9ef">Xcode</span> - <span style="color:#66d9ef">Target</span> - <span style="color:#66d9ef">Build</span> <span style="color:#66d9ef">Settings</span> - <span style="color:#66d9ef">Swift</span> <span style="color:#66d9ef">Compiler</span> - <span style="color:#66d9ef">Optimization</span> <span style="color:#66d9ef">Level</span> - <span style="color:#66d9ef">DEBUG</span>: <span style="color:#66d9ef">Optimize</span> <span style="color:#66d9ef">for</span> <span style="color:#66d9ef">Speed</span> [-<span style="color:#66d9ef">O</span>]<span style="color:#960050;background-color:#1e0010">ï¼‰</span>
<span style="color:#a6e22e">demo</span><span style="color:#960050;background-color:#1e0010">`</span><span style="color:#66d9ef">main</span>:
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a10</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">0</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:   <span style="color:#66d9ef">pushq</span>  %rbp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a11</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:   <span style="color:#66d9ef">movq</span>   %rsp, %rbp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a14</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">4</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:   <span style="color:#66d9ef">pushq</span>  %rbx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a15</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">5</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:   <span style="color:#66d9ef">pushq</span>  %rax
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a16</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">6</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:   <span style="color:#66d9ef">xorl</span>   %edi, %edi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a18</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">8</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:   <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100000b10</span>               <span style="color:#75715e">; type metadata accessor for Swift._ContiguousArrayStorage&lt;Any&gt; at &lt;compiler-generated&gt;
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a1d</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">13</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">pushq</span>  <span style="color:#66d9ef">$0x40</span>
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a1f</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">15</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">popq</span>   %rsi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a20</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">16</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">pushq</span>  <span style="color:#66d9ef">$0x7</span>
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a22</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">18</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">popq</span>   %rdx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a23</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">19</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rax, %rdi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a26</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">22</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100000e90</span>               <span style="color:#75715e">; symbol stub for: swift_allocObject
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a2b</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">27</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rax, %rbx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a2e</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">30</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movaps</span> <span style="color:#ae81ff">0x51b</span>(%rip), %xmm0
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a35</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">37</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movups</span> %xmm0, <span style="color:#ae81ff">0x10</span>(%rax)
<span style="color:#960050;background-color:#1e0010">-&gt;</span>  <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a39</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">41</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   <span style="color:#ae81ff">0x5c8</span>(%rip), %rax         <span style="color:#75715e">; (void *)0x00007fff86ceebc8: type metadata for Swift.String
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a40</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">48</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rax, <span style="color:#ae81ff">0x38</span>(%rbx)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a44</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">52</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   <span style="color:#66d9ef">$0x6f6f66</span>, <span style="color:#ae81ff">0x20</span>(%rbx)     <span style="color:#75715e">; imm = 0x6F6F66
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a4c</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">60</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movabsq</span> <span style="color:#66d9ef">$-0x1d00000000000000</span>, %rax <span style="color:#75715e">; imm = 0xE300000000000000
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a56</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">70</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rax, <span style="color:#ae81ff">0x28</span>(%rbx)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a5a</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">74</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">pushq</span>  <span style="color:#66d9ef">$0x20</span>
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a5c</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">76</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">popq</span>   %rsi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a5d</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">77</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">pushq</span>  <span style="color:#66d9ef">$0xa</span>
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a5f</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">79</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">popq</span>   %rcx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a60</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">80</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movabsq</span> <span style="color:#66d9ef">$-0x1f00000000000000</span>, %rdx <span style="color:#75715e">; imm = 0xE100000000000000
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a6a</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">90</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rbx, %rdi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a6d</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">93</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rdx, %r8
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a70</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">96</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100000e60</span>               <span style="color:#75715e">; symbol stub for: Swift.print(_: Any..., separator: Swift.String, terminator: Swift.String) -&gt; ()
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a75</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">101</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %rbx, %rdi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a78</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">104</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100000ea8</span>               <span style="color:#75715e">; symbol stub for: swift_release
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a7d</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">109</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">xorl</span>   %eax, %eax
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a7f</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">111</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">addq</span>   <span style="color:#66d9ef">$0x8</span>, %rsp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a83</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">115</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">popq</span>   %rbx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a84</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">116</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">popq</span>   %rbp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a85</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">117</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">retq</span>

<span style="color:#960050;background-color:#1e0010">//</span> <span style="color:#a6e22e">DEBUG</span><span style="color:#960050;background-color:#1e0010">ï¼ˆ</span><span style="color:#66d9ef">Optimize</span> <span style="color:#66d9ef">for</span> <span style="color:#66d9ef">Size</span> [-<span style="color:#66d9ef">Osize</span>]<span style="color:#960050;background-color:#1e0010">ï¼Œå¤šæ¬¡è°ƒç”¨æ—¶åˆ™ä¸å¼€å¯å†…è”ä»¥é™ä½å¤§å°ï¼‰</span>
<span style="color:#a6e22e">demo</span><span style="color:#960050;background-color:#1e0010">`</span><span style="color:#66d9ef">main</span>:
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a00</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">0</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:   <span style="color:#66d9ef">pushq</span>  %rbp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a01</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">1</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:   <span style="color:#66d9ef">movq</span>   %rsp, %rbp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a04</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">4</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:   <span style="color:#66d9ef">pushq</span>  %rbx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a05</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">5</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:   <span style="color:#66d9ef">pushq</span>  %rax
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a06</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">6</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:   <span style="color:#66d9ef">movq</span>   <span style="color:#ae81ff">0x6bb</span>(%rip), %rdi         <span style="color:#75715e">; lazy cache variable for type metadata for Swift._ContiguousArrayStorage&lt;Any&gt;
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a0d</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">13</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">testq</span>  %rdi, %rdi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a10</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">16</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">jne</span>    <span style="color:#ae81ff">0x100000a33</span>               <span style="color:#75715e">; &lt;+51&gt; [inlined] generic specialization &lt;Any&gt; of Swift._allocateUninitializedArray&lt;A&gt;(Builtin.Word) -&gt; (Swift.Array&lt;A&gt;, Builtin.RawPointer) + 47 at main.swift:12
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a12</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">18</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   <span style="color:#ae81ff">0x5f7</span>(%rip), %rsi         <span style="color:#75715e">; (void *)0x00007fff86cf6908: type metadata for Any
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a19</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">25</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">addq</span>   <span style="color:#66d9ef">$0x8</span>, %rsi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a1d</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">29</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">xorl</span>   %edi, %edi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a1f</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">31</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100000e5a</span>               <span style="color:#75715e">; symbol stub for: type metadata accessor for Swift._ContiguousArrayStorage
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a24</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">36</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rax, %rdi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a27</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">39</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">testq</span>  %rdx, %rdx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a2a</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">42</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">jne</span>    <span style="color:#ae81ff">0x100000a33</span>               <span style="color:#75715e">; &lt;+51&gt; [inlined] generic specialization &lt;Any&gt; of Swift._allocateUninitializedArray&lt;A&gt;(Builtin.Word) -&gt; (Swift.Array&lt;A&gt;, Builtin.RawPointer) + 47 at main.swift:12
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a2c</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">44</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rdi, <span style="color:#ae81ff">0x695</span>(%rip)         <span style="color:#75715e">; lazy cache variable for type metadata for Swift._ContiguousArrayStorage&lt;Any&gt;
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a33</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">51</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movl</span>   <span style="color:#66d9ef">$0x40</span>, %esi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a38</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">56</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movl</span>   <span style="color:#66d9ef">$0x7</span>, %edx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a3d</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">61</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100000e90</span>               <span style="color:#75715e">; symbol stub for: swift_allocObject
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a42</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">66</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rax, %rbx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a45</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">69</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movaps</span> <span style="color:#ae81ff">0x504</span>(%rip), %xmm0
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a4c</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">76</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movups</span> %xmm0, <span style="color:#ae81ff">0x10</span>(%rax)
<span style="color:#960050;background-color:#1e0010">-&gt;</span>  <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a50</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">80</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   <span style="color:#ae81ff">0x5b1</span>(%rip), %rax         <span style="color:#75715e">; (void *)0x00007fff86ceebc8: type metadata for Swift.String
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a57</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">87</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   %rax, <span style="color:#ae81ff">0x38</span>(%rbx)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a5b</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">91</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movq</span>   <span style="color:#66d9ef">$0x6f6f66</span>, <span style="color:#ae81ff">0x20</span>(%rbx)     <span style="color:#75715e">; imm = 0x6F6F66
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a63</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">99</span><span style="color:#960050;background-color:#1e0010">&gt;</span>:  <span style="color:#66d9ef">movabsq</span> <span style="color:#66d9ef">$-0x1d00000000000000</span>, %rax <span style="color:#75715e">; imm = 0xE300000000000000
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a6d</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">109</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %rax, <span style="color:#ae81ff">0x28</span>(%rbx)
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a71</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">113</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movabsq</span> <span style="color:#66d9ef">$-0x1f00000000000000</span>, %rdx <span style="color:#75715e">; imm = 0xE100000000000000
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a7b</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">123</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movl</span>   <span style="color:#66d9ef">$0x20</span>, %esi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a80</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">128</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movl</span>   <span style="color:#66d9ef">$0xa</span>, %ecx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a85</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">133</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %rbx, %rdi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a88</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">136</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %rdx, %r8
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a8b</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">139</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100000e60</span>               <span style="color:#75715e">; symbol stub for: Swift.print(_: Any..., separator: Swift.String, terminator: Swift.String) -&gt; ()
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a90</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">144</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">movq</span>   %rbx, %rdi
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a93</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">147</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">callq</span>  <span style="color:#ae81ff">0x100000ea8</span>               <span style="color:#75715e">; symbol stub for: swift_release
</span><span style="color:#75715e"></span>    <span style="color:#ae81ff">0x100000a98</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">152</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">xorl</span>   %eax, %eax
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a9a</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">154</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">addq</span>   <span style="color:#66d9ef">$0x8</span>, %rsp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a9e</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">158</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">popq</span>   %rbx
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000a9f</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">159</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">popq</span>   %rbp
    <span style="color:#960050;background-color:#1e0010">0</span><span style="color:#a6e22e">x100000aa0</span> <span style="color:#960050;background-color:#1e0010">&lt;+</span><span style="color:#ae81ff">160</span><span style="color:#960050;background-color:#1e0010">&gt;</span>: <span style="color:#66d9ef">retq</span>
</code></pre></div><h2 id="inline">@inline</h2>
<ul>
<li>å®˜æ–¹æºç ä¸­ä½¿ç”¨ <code>@inline</code> æ¥å»ºè®®ï¼ˆæ³¨æ„ã€Œå»ºè®®ã€è€Œéå¼ºåˆ¶ï¼‰ç¼–è¯‘å™¨å»ç¦æ­¢ï¼ˆ<code>never</code>ï¼‰æˆ–åœ¨æ¡ä»¶å…è®¸çš„æƒ…å†µä¸‹ï¼ˆé™¤é€’å½’ã€åŠ¨æ€æ´¾å‘ç­‰ï¼‰æ€»æ˜¯ï¼ˆ<code>__always</code>ï¼‰å†…è”ï¼Œä¼˜å…ˆçº§é«˜äºç¼–è¯‘è®¾ç½®ï¼›</li>
<li>æ³¨æ„ <code>__always</code> åªåœ¨å¼€å¯ç¼–è¯‘å™¨ä¼˜åŒ–é€‰é¡¹æ—¶ï¼ˆæ— è®ºæ˜¯ä¼˜åŒ–é€Ÿåº¦è¿˜æ˜¯ä½“ç§¯ï¼‰å‡ ä¹æ€»æ˜¯å†…è”ï¼ˆæœªå¼€å¯æ—¶å°†ä¸ä¼šè¢«å†…è”ï¼‰ã€‚</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#75715e">// [-O] / [-Osize]</span>

@inline(never) <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">bar</span>() {
    print(<span style="color:#e6db74">&#34;bar&#34;</span>)
}

@inline(__always) <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">baz</span>() {
    print(<span style="color:#e6db74">&#34;baz&#34;</span>)
}

bar()
baz()
</code></pre></div><!-- ### API & ABI

- APIï¼ˆApplication Programming Interfaceï¼Œåº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£ï¼‰ï¼šæºä»£ç å’Œåº“ä¹‹é—´çš„æ¥å£ã€‚
- ABIï¼ˆApplication Binary Interfaceï¼Œåº”ç”¨ç¨‹åºäºŒè¿›åˆ¶æ¥å£ï¼‰ï¼š
  - åº”ç”¨ç¨‹åºä¸æ“ä½œç³»ç»Ÿä¹‹é—´çš„åº•å±‚æ¥å£
  - æ¶‰åŠçš„å†…å®¹æœ‰ï¼š
    - ç›®æ ‡æ–‡ä»¶æ ¼å¼ï¼ˆeg. Mach-Oï¼‰
    - æ•°æ®ç±»å‹çš„å¤§å° / å¸ƒå±€ / å¯¹é½ï¼ˆeg. åŸºæœ¬ç±»å‹å ç”¨çš„å†…å­˜å¤§å°ï¼‰
    - å‡½æ•°è°ƒç”¨çº¦å®šï¼ˆeg. å‡½æ•°è°ƒç”¨æ—¶ä½¿ç”¨æ ˆç©ºé—´è¿˜æ˜¯å¯„å­˜å™¨ã€å‡½æ•°å‚æ•°çš„å…¥æ ˆé¡ºåºï¼‰ç­‰ -->

    </div>
    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h">Read other posts</span>
          <hr />
        </div>
        <div class="pagination__buttons">
          
          
            <span class="button next">
              <a href="/posts/2020/swift_inout/">
                <span class="button__text">Swift æ‹¾é— - inout</span>
                <span class="button__icon">â†’</span>
              </a>
            </span>
          
        </div>
      </div>
    

    

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<table style="border: 0;">
  <tr>
  <td style="border: 0; width: 30%;">
    <img src='/img/about/1.jpg'>
  </td>
  <td style="border: 0;">
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-9925978992661955"
     data-ad-slot="3213735320"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
  </td>
  </tr>
</table>



<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>


    
    
    <div>
      <div id="github-comment">
      </div>

      <script type="text/javascript">
        function getUtterances(isDark) {
          var utterances = document.createElement('script');
          utterances.type = 'text/javascript';
          utterances.async = true;
          utterances.setAttribute('issue-term', "pathname")
          utterances.setAttribute('repo', "kingcos\/kingcos.github.io")
          utterances.setAttribute('label', "comments")
          isDark ? utterances.setAttribute('theme', "github-dark") : utterances.setAttribute('theme', "github-light")
          utterances.crossorigin = 'anonymous';
          utterances.src = 'https://utteranc.es/client.js';

          return utterances
        }

        var themeToggle = document.querySelector(".theme-toggle")
        themeToggle.addEventListener("click", function () {
          var getTheme = window.localStorage && window.localStorage.getItem("theme")
          var divNode = document.getElementById('github-comment')
          while(divNode.hasChildNodes()) {
            divNode.removeChild(divNode.firstChild);
          }
          
          
          

          
          
          
          
          
          
          document.getElementById('github-comment').appendChild(getUtterances(getTheme !== "dark"))
        })

        var getTheme = window.localStorage && window.localStorage.getItem("theme")
        document.getElementById('github-comment').appendChild(getUtterances(getTheme === "dark"))
      </script>
    </div>
    

    </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">All rights reserved by kingcos.me</div>
    
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>



      
    </div>

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-138311951-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
  </body>
</html>
