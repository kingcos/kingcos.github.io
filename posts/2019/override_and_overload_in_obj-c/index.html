<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>Obj-C 中的重载与重写 :: iBlog</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Date Platform     2019-03-20 macOS 10.14.2    Preface 重载（Overload）和重写（Override）是面向对象语言中十分基本的两个概念，本文将谈谈 Obj-C 中的重载与重写。
重载  In some programming languages, function overloading or method overloading is the ability to create multiple functions of the same name with different implementations. Calls to an overloaded function will run a specific implementation of that function appropriate to the context of the call, allowing one function call to perform different tasks depending on context."/>
<meta name="keywords" content="kingcos.me,maimieng.comios,swift,objective-c,obj-c,objc,oc,geek,python,ruby,golang,go,apple,mac"/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="/posts/2019/override_and_overload_in_obj-c/" />





<link rel="stylesheet" href="/assets/style.css">


<link rel="stylesheet" href="/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/img/favicon.png">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Obj-C 中的重载与重写"/>
<meta name="twitter:description" content="重载（Overload）和重写（Override）是面向对象语言中十分基本的两个概念，本文将谈谈 Obj-C 中的重载与重写。"/>



<meta property="og:title" content="Obj-C 中的重载与重写" />
<meta property="og:description" content="重载（Overload）和重写（Override）是面向对象语言中十分基本的两个概念，本文将谈谈 Obj-C 中的重载与重写。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/2019/override_and_overload_in_obj-c/" />
<meta property="article:published_time" content="2019-03-20T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-03-20T00:00:00+00:00" /><meta property="og:site_name" content="iBlog" />




<script data-ad-client="ca-pub-9925978992661955" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">kingcos.me</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/links">Links</a></li>
        
      
        
          <li><a href="/perspective">Perspective</a></li>
        
      
        
          <li><a href="/words">Words</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/links">Links</a></li>
      
    
      
        <li><a href="/perspective">Perspective</a></li>
      
    
      
        <li><a href="/words">Words</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  <div class="post">
    <h2 class="post-title"><a href="/posts/2019/override_and_overload_in_obj-c/">Obj-C 中的重载与重写</a></h2>
    <div class="post-meta">
      
        <span class="post-date">
            2019-03-20
        </span>
      
      
      
        <span class="post-read-time">— 2 min read</span>
      
    </div>

    
      <span class="post-tags">
        
          #<a href="/tags/tips/">Tips</a>&nbsp;
        
          #<a href="/tags/ios/">iOS</a>&nbsp;
        
          #<a href="/tags/obj-c/">Obj-C</a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      <table>
<thead>
<tr>
<th align="center">Date</th>
<th align="center">Platform</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">2019-03-20</td>
<td align="center">macOS 10.14.2</td>
</tr>
</tbody>
</table>
<h2 id="preface">Preface</h2>
<p>重载（Overload）和重写（Override）是面向对象语言中十分基本的两个概念，本文将谈谈 Obj-C 中的重载与重写。</p>
<h2 id="heading">重载</h2>
<blockquote>
<p>In some programming languages, function overloading or method overloading is the ability to create multiple functions of the same name with different implementations. Calls to an overloaded function will run a specific implementation of that function appropriate to the context of the call, allowing one function call to perform different tasks depending on context.</p>
<p>Function overloading - Wikipedia</p>
<p>译：</p>
<p>在某些编程语言中，函数重载或方法重载是指一种可以创建多个同名函数但拥有不同实现的能力。调用重载函数将执行符合上下文的函数调用，即允许一个函数调用根据上下文执行不同的任务。</p>
<p>函数重载 - 维基百科</p>
</blockquote>
<p>如维基百科所讲，简言之，重载（Overload）指在同一个类中，存在相同函数名但不同参数个数或不同参数类型或不同返回值的函数。但由于 Obj-C 是消息结构的语言，其意义上的方法调用实质上是消息传递。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objectivec" data-lang="objectivec"><span style="color:#66d9ef">@interface</span> <span style="color:#a6e22e">Computer</span> : <span style="color:#a6e22e">NSObject</span>

- (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">run</span>;
- (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">run:</span>(NSString <span style="color:#f92672">*</span>)sth;

<span style="color:#66d9ef">@end</span>

<span style="color:#66d9ef">@implementation</span> <span style="color:#a6e22e">Computer</span>

- (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">run</span> {
    NSLog(<span style="color:#e6db74">@&#34;</span><span style="color:#e6db74">run</span><span style="color:#e6db74">&#34;</span>);
}
- (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">run:</span>(NSString <span style="color:#f92672">*</span>)sth {
    NSLog(<span style="color:#e6db74">@&#34;</span><span style="color:#e6db74">run - %@</span><span style="color:#e6db74">&#34;</span>, sth);
}

<span style="color:#66d9ef">@end</span>

<span style="color:#66d9ef">int</span> main(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> argv[]) {
    <span style="color:#66d9ef">@autoreleasepool</span> {
        Computer <span style="color:#f92672">*</span>cpt <span style="color:#f92672">=</span> [[Computer alloc] init];
        [cpt run];
        [cpt run:<span style="color:#e6db74">@&#34;</span><span style="color:#e6db74">sth</span><span style="color:#e6db74">&#34;</span>];
    }
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><p>我们定义一个继承自 <code>NSObject</code> 的 <code>Computer</code> 类，其拥有两个实例方法。尝试将上述代码翻译为 C++，<code>xcrun -sdk iphoneos clang -arch arm64 -rewrite-objc main.m -o main-64.cpp</code>。由于 Obj-C 是消息结构的语言，<code>objc_msgSend</code> 处便是其消息传递之处，我们可以发现原本的方法都被变成了字符串：<code>sel_registerName(&quot;alloc&quot;)</code>、<code>sel_registerName(&quot;init&quot;)</code>、<code>sel_registerName(&quot;run&quot;)</code> 和 <code>sel_registerName(&quot;run:&quot;)</code>。实际上这些字符串就是 Obj-C 方法的方法名，方法名忽略了参数名以及返回值，实例方法与类方法的区别也只是不同的消息接收对象。所以严格意义上讲，Obj-C 是不支持方法重载的，因为它不允许同名函数的存在。但如果按不同参数个数也属于方法重载来说，Obj-C 仅支持参数个数不同的重载，每个参数都将在方法名后多生成一个 <code>:</code> 从而可以区分。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-cpp" data-lang="cpp"><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>(<span style="color:#66d9ef">int</span> argc, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span> argv[]) {
    <span style="color:#75715e">/* @autoreleasepool */</span> { __AtAutoreleasePool __autoreleasepool; 

        Computer <span style="color:#f92672">*</span>cpt <span style="color:#f92672">=</span> ((Computer <span style="color:#f92672">*</span>(<span style="color:#f92672">*</span>)(id, SEL))(<span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>)objc_msgSend)((id)((Computer <span style="color:#f92672">*</span>(<span style="color:#f92672">*</span>)(id, SEL))(<span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>)objc_msgSend)((id)objc_getClass(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">Computer</span><span style="color:#e6db74">&#34;</span>), sel_registerName(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">alloc</span><span style="color:#e6db74">&#34;</span>)), sel_registerName(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">init</span><span style="color:#e6db74">&#34;</span>));
        ((<span style="color:#66d9ef">void</span> (<span style="color:#f92672">*</span>)(id, SEL))(<span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>)objc_msgSend)((id)cpt, sel_registerName(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">run</span><span style="color:#e6db74">&#34;</span>));
        ((<span style="color:#66d9ef">void</span> (<span style="color:#f92672">*</span>)(id, SEL, NSString <span style="color:#f92672">*</span>))(<span style="color:#66d9ef">void</span> <span style="color:#f92672">*</span>)objc_msgSend)((id)cpt, sel_registerName(<span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">run:</span><span style="color:#e6db74">&#34;</span>), (NSString <span style="color:#f92672">*</span>)<span style="color:#f92672">&amp;</span>__NSConstantStringImpl__var_folders_qt_ctbfp1yd2gn7bv6y6v6qgvgm0000gn_T_main_ea7dac_mi_0);
    }
    <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
}
</code></pre></div><h2 id="heading-1">重写</h2>
<blockquote>
<p>Method overriding, in object-oriented programming, is a language feature that allows a subclass or child class to provide a specific implementation of a method that is already provided by one of its superclasses or parent classes. The implementation in the subclass overrides (replaces) the implementation in the superclass by providing a method that has same name, same parameters or signature, and same return type as the method in the parent class. The version of a method that is executed will be determined by the object that is used to invoke it. If an object of a parent class is used to invoke the method, then the version in the parent class will be executed, but if an object of the subclass is used to invoke the method, then the version in the child class will be executed. Some languages allow a programmer to prevent a method from being overridden.</p>
<p>Method overriding - Wikipedia</p>
<p>译：</p>
<p>在面向对象编程中，方法重写是一种语言特性，它允许子类提供其父类或超类已经提供的特定方法实现。子类中的实现通过提供与父类中的方法相同的名称、相同的参数或签名以及相同的返回类型的方法来覆盖（替换）超类中的实现。执行方法的版本将由调用对象确定。如果父类对象调用该方法，则将执行父类中的版本，但如果使用子类对象调用该方法，则将执行子类中的版本。某些语言允许程序员阻止方法被覆盖。</p>
<p>方法重写 - 维基百科</p>
</blockquote>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objectivec" data-lang="objectivec"><span style="color:#66d9ef">@interface</span> <span style="color:#a6e22e">Mac</span> : <span style="color:#a6e22e">Computer</span>
<span style="color:#66d9ef">@end</span>

<span style="color:#66d9ef">@implementation</span> <span style="color:#a6e22e">Mac</span>

- (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">run:</span>(NSString <span style="color:#f92672">*</span>)sth {
    NSLog(<span style="color:#e6db74">@&#34;</span><span style="color:#e6db74">Mac - run - %@</span><span style="color:#e6db74">&#34;</span>, sth);
}

<span style="color:#66d9ef">@end</span>
</code></pre></div><p>完全不同于重载，重写（Override）是指在子类中重写父类的方法，且方法名、参数类型、参数个数、返回值类型等必须一致。Obj-C 是完全支持方法重写的：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objectivec" data-lang="objectivec">Computer <span style="color:#f92672">*</span>cpt <span style="color:#f92672">=</span> [[Computer alloc] init];
[cpt run:<span style="color:#e6db74">@&#34;</span><span style="color:#e6db74">cpt_run</span><span style="color:#e6db74">&#34;</span>];
Computer <span style="color:#f92672">*</span>mac <span style="color:#f92672">=</span> [[Mac alloc] init];
[mac run:<span style="color:#e6db74">@&#34;</span><span style="color:#e6db74">mac_run</span><span style="color:#e6db74">&#34;</span>];

<span style="color:#75715e">// OUTPUT:
</span><span style="color:#75715e"></span><span style="color:#75715e">// run - cpt_run
</span><span style="color:#75715e"></span><span style="color:#75715e">// Mac - run - mac_run
</span></code></pre></div><h2 id="reference">Reference</h2>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Function_overloading">Function overloading - Wikipedia</a></li>
<li><a href="https://github.com/kingcos/Perspective/issues/72">Tips - 将 Obj-C 代码翻译为 C++ 代码</a></li>
<li><a href="https://en.wikipedia.org/wiki/Method_overriding">Method overriding - Wikipedia</a></li>
</ul>

    </div>
    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h">Read other posts</span>
          <hr />
        </div>
        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="/posts/2019/kvc_in_ios/">
                <span class="button__icon">←</span>
                <span class="button__text">iOS 中的 KVC</span>
              </a>
            </span>
          
          
            <span class="button next">
              <a href="/posts/2019/kvo_in_ios/">
                <span class="button__text">iOS 中的 KVO</span>
                <span class="button__icon">→</span>
              </a>
            </span>
          
        </div>
      </div>
    

    

    
    
    <div>
      <div id="github-comment">
      </div>

      <script type="text/javascript">
        function getUtterances(isDark) {
          var utterances = document.createElement('script');
          utterances.type = 'text/javascript';
          utterances.async = true;
          utterances.setAttribute('issue-term', "pathname")
          utterances.setAttribute('repo', "kingcos\/kingcos.github.io")
          utterances.setAttribute('label', "comments")
          isDark ? utterances.setAttribute('theme', "github-dark") : utterances.setAttribute('theme', "github-light")
          utterances.crossorigin = 'anonymous';
          utterances.src = 'https://utteranc.es/client.js';

          return utterances
        }

        var themeToggle = document.querySelector(".theme-toggle")
        themeToggle.addEventListener("click", function () {
          var getTheme = window.localStorage && window.localStorage.getItem("theme")
          var divNode = document.getElementById('github-comment')
          while(divNode.hasChildNodes()) {
            divNode.removeChild(divNode.firstChild);
          }
          
          
          

          
          
          
          
          
          
          document.getElementById('github-comment').appendChild(getUtterances(getTheme !== "dark"))
        })

        var getTheme = window.localStorage && window.localStorage.getItem("theme")
        document.getElementById('github-comment').appendChild(getUtterances(getTheme === "dark"))
      </script>
    </div>
    

    </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">All rights reserved by kingcos.me</div>
    
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>


      
    </div>

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-138311951-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
  </body>
</html>
