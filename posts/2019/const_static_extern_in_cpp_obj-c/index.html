<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>C/C&#43;&#43;/Obj-C/C&#43;&#43; ä¸­çš„ constã€static &amp; extern :: iBlog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Date Notes Env     2019-07-23 é¦–æ¬¡æäº¤ clang&#43;&#43;, macOS 10.14.6    Preface constã€static &amp;amp; extern æ˜¯ C/C&#43;&#43; ä¸­çš„å…³é”®å­—ï¼Œç„¶è€Œåœ¨å†™ Obj-C/C&#43;&#43; æ—¶å´æœ‰ä¸å…ä¼šç»å¸¸ç”¨åˆ°ã€‚è™½ç„¶è¿™å‡ ä¸ªå…³é”®å­—æˆ‘éƒ½çŸ¥é“ï¼Œä½†æœ‰æ—¶ä¼šå°†å®ƒä»¬ææ··æˆ–è€…ç”¨é”™ï¼Œé‚£ä¹ˆè¿™æ¬¡å°±ç®€å•æ€»ç»“ä¸‹è¿™å‡ ä¸ªå…³é”®å­—å§ã€‚
const åŸºç¡€ç±»å‹ å¯¹äºåŸºç¡€ç±»å‹ï¼Œå…¶åœ¨å†…å­˜ä¸­å­˜å‚¨çš„å³æ˜¯è¯¥ç±»å‹çš„å˜é‡æœ¬èº«ï¼Œç»è¿‡ const ä¿®é¥°åï¼Œæ­¤å¤„çš„å˜é‡ä¸å¯å˜ï¼Œå³å¸¸é‡ã€‚const çš„ä½ç½®å¹¶ä¸ä¼šå½±å“å…¶ä½œç”¨ï¼Œæ›´ä¸ºæ¨èçš„å†™æ³•åº”å½“æ˜¯ç¼–è¯‘å™¨æç¤ºçš„ const &amp;lt;TYPE&amp;gt;ã€‚
ä»¥ä¸‹æ˜¯åœ¨ C/C&#43;&#43; ä¸­çš„ç”¨ä¾‹ï¼Œç”±äº Obj-C/C&#43;&#43; åˆ†åˆ«æ˜¯ C/C&#43;&#43; çš„è¶…é›†ï¼Œå¯¹äº C/C&#43;&#43; çš„åŸºç¡€ç±»å‹ï¼Œå…¶åœ¨ Obj-C/C&#43;&#43; ä¸­çš„è¡¨ç°æ˜¯ä¸€è‡´çš„ï¼š
int a = 0; a = 10; const int b = 0; // error: cannot assign to variable &#39;b&#39; with const-qualified type &#39;const int&#39; // b = 10; int const c = 0; // c = 10;  å¯¹äº Obj-C ä¸­ç‰¹æœ‰çš„åŸºç¡€ç±»å‹ï¼Œconst ä¹Ÿä¸ä¿®é¥° C/C&#43;&#43; ä¸­åŸºç¡€ç±»å‹çš„è¡Œä¸ºä¸€è‡´ï¼š"/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="/posts/2019/const_static_extern_in_cpp_obj-c/" />


<link rel="stylesheet" href="/assets/style.css">

  <link rel="stylesheet" href="/assets/green.css">



<link rel="stylesheet" href="/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">

<link rel="shortcut icon" href="/img/favicon/favicon.ico">



<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="C/C&#43;&#43;/Obj-C/C&#43;&#43; ä¸­çš„ constã€static &amp; extern :: iBlog â€” " />
<meta name="twitter:description" content="Date Notes Env     2019-07-23 é¦–æ¬¡æäº¤ clang&#43;&#43;, macOS 10.14.6    Preface constã€static &amp;amp; extern æ˜¯ C/C&#43;&#43; ä¸­çš„å…³é”®å­—ï¼Œç„¶è€Œåœ¨å†™ Obj-C/C&#43;&#43; æ—¶å´æœ‰ä¸å…ä¼šç»å¸¸ç”¨åˆ°ã€‚è™½ç„¶è¿™å‡ ä¸ªå…³é”®å­—æˆ‘éƒ½çŸ¥é“ï¼Œä½†æœ‰æ—¶ä¼šå°†å®ƒä»¬ææ··æˆ–è€…ç”¨é”™ï¼Œé‚£ä¹ˆè¿™æ¬¡å°±ç®€å•æ€»ç»“ä¸‹è¿™å‡ ä¸ªå…³é”®å­—å§ã€‚
const åŸºç¡€ç±»å‹ å¯¹äºåŸºç¡€ç±»å‹ï¼Œå…¶åœ¨å†…å­˜ä¸­å­˜å‚¨çš„å³æ˜¯è¯¥ç±»å‹çš„å˜é‡æœ¬èº«ï¼Œç»è¿‡ const ä¿®é¥°åï¼Œæ­¤å¤„çš„å˜é‡ä¸å¯å˜ï¼Œå³å¸¸é‡ã€‚const çš„ä½ç½®å¹¶ä¸ä¼šå½±å“å…¶ä½œç”¨ï¼Œæ›´ä¸ºæ¨èçš„å†™æ³•åº”å½“æ˜¯ç¼–è¯‘å™¨æç¤ºçš„ const &amp;lt;TYPE&amp;gt;ã€‚
ä»¥ä¸‹æ˜¯åœ¨ C/C&#43;&#43; ä¸­çš„ç”¨ä¾‹ï¼Œç”±äº Obj-C/C&#43;&#43; åˆ†åˆ«æ˜¯ C/C&#43;&#43; çš„è¶…é›†ï¼Œå¯¹äº C/C&#43;&#43; çš„åŸºç¡€ç±»å‹ï¼Œå…¶åœ¨ Obj-C/C&#43;&#43; ä¸­çš„è¡¨ç°æ˜¯ä¸€è‡´çš„ï¼š
int a = 0; a = 10; const int b = 0; // error: cannot assign to variable &#39;b&#39; with const-qualified type &#39;const int&#39; // b = 10; int const c = 0; // c = 10;  å¯¹äº Obj-C ä¸­ç‰¹æœ‰çš„åŸºç¡€ç±»å‹ï¼Œconst ä¹Ÿä¸ä¿®é¥° C/C&#43;&#43; ä¸­åŸºç¡€ç±»å‹çš„è¡Œä¸ºä¸€è‡´ï¼š" />
<meta name="twitter:site" content="/" />
<meta name="twitter:creator" content="" />
<meta name="twitter:image" content="">


<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="C/C&#43;&#43;/Obj-C/C&#43;&#43; ä¸­çš„ constã€static &amp; extern :: iBlog â€” ">
<meta property="og:description" content="Date Notes Env     2019-07-23 é¦–æ¬¡æäº¤ clang&#43;&#43;, macOS 10.14.6    Preface constã€static &amp;amp; extern æ˜¯ C/C&#43;&#43; ä¸­çš„å…³é”®å­—ï¼Œç„¶è€Œåœ¨å†™ Obj-C/C&#43;&#43; æ—¶å´æœ‰ä¸å…ä¼šç»å¸¸ç”¨åˆ°ã€‚è™½ç„¶è¿™å‡ ä¸ªå…³é”®å­—æˆ‘éƒ½çŸ¥é“ï¼Œä½†æœ‰æ—¶ä¼šå°†å®ƒä»¬ææ··æˆ–è€…ç”¨é”™ï¼Œé‚£ä¹ˆè¿™æ¬¡å°±ç®€å•æ€»ç»“ä¸‹è¿™å‡ ä¸ªå…³é”®å­—å§ã€‚
const åŸºç¡€ç±»å‹ å¯¹äºåŸºç¡€ç±»å‹ï¼Œå…¶åœ¨å†…å­˜ä¸­å­˜å‚¨çš„å³æ˜¯è¯¥ç±»å‹çš„å˜é‡æœ¬èº«ï¼Œç»è¿‡ const ä¿®é¥°åï¼Œæ­¤å¤„çš„å˜é‡ä¸å¯å˜ï¼Œå³å¸¸é‡ã€‚const çš„ä½ç½®å¹¶ä¸ä¼šå½±å“å…¶ä½œç”¨ï¼Œæ›´ä¸ºæ¨èçš„å†™æ³•åº”å½“æ˜¯ç¼–è¯‘å™¨æç¤ºçš„ const &amp;lt;TYPE&amp;gt;ã€‚
ä»¥ä¸‹æ˜¯åœ¨ C/C&#43;&#43; ä¸­çš„ç”¨ä¾‹ï¼Œç”±äº Obj-C/C&#43;&#43; åˆ†åˆ«æ˜¯ C/C&#43;&#43; çš„è¶…é›†ï¼Œå¯¹äº C/C&#43;&#43; çš„åŸºç¡€ç±»å‹ï¼Œå…¶åœ¨ Obj-C/C&#43;&#43; ä¸­çš„è¡¨ç°æ˜¯ä¸€è‡´çš„ï¼š
int a = 0; a = 10; const int b = 0; // error: cannot assign to variable &#39;b&#39; with const-qualified type &#39;const int&#39; // b = 10; int const c = 0; // c = 10;  å¯¹äº Obj-C ä¸­ç‰¹æœ‰çš„åŸºç¡€ç±»å‹ï¼Œconst ä¹Ÿä¸ä¿®é¥° C/C&#43;&#43; ä¸­åŸºç¡€ç±»å‹çš„è¡Œä¸ºä¸€è‡´ï¼š" />
<meta property="og:url" content="/posts/2019/const_static_extern_in_cpp_obj-c/" />
<meta property="og:site_name" content="C/C&#43;&#43;/Obj-C/C&#43;&#43; ä¸­çš„ constã€static &amp; extern" />
<meta property="og:image" content="">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2019-07-23 00:00:00 &#43;0000 UTC" />











</head>
<body class="">


<div class="container center">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    iBlog
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
  
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-138311951-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  

  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About &amp; AMA</a></li>
        
      
        
          <li><a href="/links">Links</a></li>
        
      
        
          <li><a href="/perspective">Perspective</a></li>
        
      
        
          <li><a href="/words">Words</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About &amp; AMA</a></li>
      
    
      
        <li><a href="/links">Links</a></li>
      
    
      
        <li><a href="/perspective">Perspective</a></li>
      
    
      
        <li><a href="/words">Words</a></li>
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="/posts/2019/const_static_extern_in_cpp_obj-c/">C/C++/Obj-C/C++ ä¸­çš„ constã€static &amp; extern</a></h1>
  <div class="post-meta">
    <span class="post-date">
      2019-07-23
    </span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="/tags/focus/">Focus</a>&nbsp;
    
    #<a href="/tags/ios/">iOS</a>&nbsp;
    
    #<a href="/tags/obj-c/">Obj-C</a>&nbsp;
    
    #<a href="/tags/c/c&#43;&#43;/">C/C&#43;&#43;</a>&nbsp;
    
  </span>
  

  

  <div class="post-content">
    

<table>
<thead>
<tr>
<th align="center">Date</th>
<th align="center">Notes</th>
<th align="center">Env</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">2019-07-23</td>
<td align="center">é¦–æ¬¡æäº¤</td>
<td align="center"><code>clang++</code>, macOS 10.14.6</td>
</tr>
</tbody>
</table>

<p><img src="/img/2019/const_static_extern_in_cpp_obj-c/0.png" alt="0" /></p>

<h2 id="preface">Preface</h2>

<p><code>const</code>ã€<code>static</code> &amp; <code>extern</code> æ˜¯ C/C++ ä¸­çš„å…³é”®å­—ï¼Œç„¶è€Œåœ¨å†™ Obj-C/C++ æ—¶å´æœ‰ä¸å…ä¼šç»å¸¸ç”¨åˆ°ã€‚è™½ç„¶è¿™å‡ ä¸ªå…³é”®å­—æˆ‘éƒ½çŸ¥é“ï¼Œä½†æœ‰æ—¶ä¼šå°†å®ƒä»¬ææ··æˆ–è€…ç”¨é”™ï¼Œé‚£ä¹ˆè¿™æ¬¡å°±ç®€å•æ€»ç»“ä¸‹è¿™å‡ ä¸ªå…³é”®å­—å§ã€‚</p>

<h2 id="const"><code>const</code></h2>

<h3 id="åŸºç¡€ç±»å‹">åŸºç¡€ç±»å‹</h3>

<p>å¯¹äºåŸºç¡€ç±»å‹ï¼Œå…¶åœ¨å†…å­˜ä¸­å­˜å‚¨çš„å³æ˜¯è¯¥ç±»å‹çš„å˜é‡æœ¬èº«ï¼Œç»è¿‡ <code>const</code> ä¿®é¥°åï¼Œæ­¤å¤„çš„å˜é‡ä¸å¯å˜ï¼Œå³å¸¸é‡ã€‚<code>const</code> çš„ä½ç½®å¹¶ä¸ä¼šå½±å“å…¶ä½œç”¨ï¼Œæ›´ä¸ºæ¨èçš„å†™æ³•åº”å½“æ˜¯ç¼–è¯‘å™¨æç¤ºçš„ <code>const &lt;TYPE&gt;</code>ã€‚</p>

<p>ä»¥ä¸‹æ˜¯åœ¨ C/C++ ä¸­çš„ç”¨ä¾‹ï¼Œç”±äº Obj-C/C++ åˆ†åˆ«æ˜¯ C/C++ çš„è¶…é›†ï¼Œå¯¹äº C/C++ çš„åŸºç¡€ç±»å‹ï¼Œå…¶åœ¨ Obj-C/C++ ä¸­çš„è¡¨ç°æ˜¯ä¸€è‡´çš„ï¼š</p>

<pre><code class="language-cpp">int a = 0;
a = 10;

const int b = 0;
// error: cannot assign to variable 'b' with const-qualified type 'const int'
// b = 10;

int const c = 0;
// c = 10;
</code></pre>

<p>å¯¹äº Obj-C ä¸­ç‰¹æœ‰çš„åŸºç¡€ç±»å‹ï¼Œ<code>const</code> ä¹Ÿä¸ä¿®é¥° C/C++ ä¸­åŸºç¡€ç±»å‹çš„è¡Œä¸ºä¸€è‡´ï¼š</p>

<pre><code class="language-objectivec">BOOL a = YES;
a = NO;

const BOOL b = YES;
// Cannot assign to variable 'b' with const-qualified type 'const BOOL' (aka 'const signed char')
// b = NO;

BOOL const c = YES;
// c = NO;
</code></pre>

<h3 id="æ•°ç»„ç±»å‹">æ•°ç»„ç±»å‹</h3>

<p>å¯¹äºæ•°ç»„ç±»å‹ï¼Œå³ä½¿ç”¨è¿ç»­çš„ä¸€æ®µå†…å­˜æ¥å®¹çº³åŒä¸€ç±»å‹å…ƒç´ çš„å®¹å™¨ã€‚å½“åœ¨ C/C++ ä¸­ä½¿ç”¨ <code>const</code> ä¿®é¥°åŸºç¡€ç±»å‹çš„æ•°ç»„æ—¶ï¼Œå…¶ä¸­çš„å†…å®¹å°†ä¸èƒ½å†æ”¹å˜ï¼š</p>

<pre><code class="language-cpp">int a[] = {1, 2, 3};
a[0] = 0;

int const b[] = {1, 2, 3};
// error: read-only variable is not assignable
// b[0] = 1;

const int c[] = {1, 2, 3};
// c[0] = 1;
</code></pre>

<p>å¯¹äº Obj-Cï¼Œåœ¨ C è¯­è¨€ä¹‹ä¸Šæ·»åŠ äº†é¢å‘å¯¹è±¡çš„éƒ¨åˆ†ï¼Œå…¶éœ€è¦å­˜å‚¨è‡ªèº«å®šä¹‰çš„å¯¹è±¡ç±»å‹çš„å®¹å™¨ç±»ï¼Œæ‰€ä»¥æ•°ç»„ç­‰é›†åˆï¼ˆæ³¨ï¼šè¿™é‡Œçš„é›†åˆå¹¶éç‰¹æŒ‡ Setï¼Œè€Œæ˜¯æŒ‡ Collectionï¼Œä¸‹ç•¥ï¼‰ç±»å‹è¢«å•ç‹¬æ‹å‡ºæ¥ç‹¬ç«‹ä¸º <code>NSArray</code>ã€<code>NSSet</code> ç­‰ç±»å‹ï¼Œä¸”é»˜è®¤å³ä½œä¸ºä¸å¯å˜ç‰ˆæœ¬ï¼Œå¹¶åœ¨ä½¿ç”¨æ—¶éœ€ç»“åˆæŒ‡é’ˆã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„ä¸å¯å˜ä»…é’ˆå¯¹å†…éƒ¨å…ƒç´ ï¼ˆå³å˜é‡å†…éƒ¨åœ°å€æŒ‡å‘çš„å€¼ï¼‰ï¼Œå¯¹äºæŒ‡é’ˆæœ¬èº«ï¼ˆæ•°ç»„çš„é¦–åœ°å€ï¼‰æ˜¯å¯å˜çš„ã€‚å¯å˜ç‰ˆæœ¬ <code>NSMutableArray</code> ç­‰åˆ™å¯ä»¥ä¿®æ”¹å†…éƒ¨å…ƒç´ å’ŒæŒ‡é’ˆæœ¬èº«ã€‚</p>

<p>ç”±äº Obj-C è‡ªå¸¦å¯å˜å’Œä¸å¯å˜ç‰ˆæœ¬çš„é›†åˆç±»å‹ï¼Œ<code>const</code> çš„ä½œç”¨å…¶å®å°±æ˜¾å¾—æœ‰äº›å¤šä½™ï¼Œè¿™é‡Œçš„ <code>const</code> å°†ç±»ä¼¼é’ˆå¯¹æŒ‡é’ˆç±»å‹çš„è¡Œä¸ºï¼ˆå…³äºæŒ‡é’ˆè¯¦è§ä¸‹æ–‡ï¼‰ã€‚å½“ <code>const</code> ä½äº <code>NSArray</code> æˆ– <code>NSMutableArray</code> ä¹‹å‰æˆ–ä¹‹åæ—¶å‡æ²¡æœ‰ä½œç”¨ï¼›å½“ <code>const</code> ä½äº <code>NSArray *</code> æˆ– <code>NSMutableArray *</code> ä¹‹åæ—¶ï¼Œå°†ä½¿å¾—æŒ‡é’ˆå†…éƒ¨å­˜å‚¨çš„å†…å­˜åœ°å€ä¸å¯è¢«æ”¹å˜ï¼Œå®ƒä»¬ä¹Ÿå°±æ— æ³•è¢«æŒ‡å‘æ–°çš„ <code>NSArray</code> æˆ– <code>NSMutableArray</code> å¯¹è±¡äº†ã€‚</p>

<pre><code class="language-objectivec">NSArray *a = @[@1, @2, @3];
// Expected method to write array element not found on object of type 'NSArray *'
// a[0] = @0;
a = @[@3, @2, @1];

const NSArray *b = @[@1, @2, @3];
// b[0] = @0;
b = @[@3, @2, @1];

NSArray const *c = @[@1, @2, @3];
// c[0] = @0;
c = @[@3, @2, @1];

NSArray * const d = @[@1, @2, @3];
// d[0] = @0;
// Cannot assign to variable 'd' with const-qualified type 'NSArray *const __strong'
// d = @[@3, @2, @1];

NSMutableArray *e = [a mutableCopy];
e[0] = @0;
e = [b mutableCopy];

const NSMutableArray *f = [a mutableCopy];
f[0] = @0;
f = [b mutableCopy];

NSMutableArray const *g = [a mutableCopy];
g[0] = @0;
g = [b mutableCopy];

NSMutableArray * const h = [a mutableCopy];
h[0] = @0;
// Cannot assign to variable 'h' with const-qualified type 'NSMutableArray *const __strong'
// h = [b mutableCopy];
</code></pre>

<h3 id="æŒ‡å‘åŸºç¡€ç±»å‹çš„æŒ‡é’ˆ">æŒ‡å‘åŸºç¡€ç±»å‹çš„æŒ‡é’ˆ</h3>

<p>åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å·²ç»æ¥è§¦äº† Obj-C ä¸­çš„ <code>NSArray</code> çš„æŒ‡é’ˆç±»å‹ <code>NSArray *</code>ï¼Œä½†ä¸ºäº†æ›´åŠ æ¸…æ™°ï¼Œæˆ‘ä»¬å°†é‡æ–°å…ˆä»æŒ‡å‘åŸºç¡€ç±»å‹çš„æŒ‡é’ˆå¼€å§‹ã€‚</p>

<p>ç‰©ç†ä¸Šçš„å†…å­˜ä¼šè¢«æ“ä½œç³»ç»Ÿæ˜ å°„ä¸ºä¸€è¿ä¸²çš„å†…å­˜åœ°å€ï¼Œæˆ‘ä»¬å‡è®¾ä¸€æ®µå†…å­˜ä» <code>0x0000</code> å¼€å§‹ï¼Œæ­£å¦‚ä¸‹å›¾ä¸­ä¸€è¿ä¸²çš„å°æ–¹æ ¼ï¼Œæ¯ä¸ªå°æ–¹æ ¼ä»£è¡¨ä¸€ä¸ªå­—èŠ‚å¤§å°çš„å†…å­˜ã€‚å½“æˆ‘ä»¬å£°æ˜ä¸€ä¸ªåŸºç¡€ç±»å‹çš„å˜é‡æ—¶ï¼Œå°†ä¸ºå…¶åˆ†é…ä¸€æ®µå†…å­˜ç©ºé—´æ¥å­˜å‚¨å…¶ä¸­çš„å€¼ã€‚æ¯”å¦‚ <code>int a = 10;</code>ï¼Œä¼šåˆ†é… 4 ä¸ªå­—èŠ‚é•¿åº¦çš„å†…å­˜ï¼Œ<code>10</code> å°†ä»¥äºŒè¿›åˆ¶çš„å½¢å¼å­˜å‚¨åœ¨è¿™æ®µå†…å­˜ä¸­ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ iOS é»˜è®¤çš„å°ç«¯ï¼ˆLittle Endï¼‰æ¨¡å¼ä¼šåœ¨ä½åœ°å€å­˜å‚¨é«˜ä½å­—èŠ‚ï¼Œä¾‹å¦‚ä¸‹å›¾ä¸­çš„æ©™è‰²éƒ¨åˆ†ï¼Œå³ <code>10100000</code>ã€‚</p>

<p>æŒ‡é’ˆï¼Œæ˜¯æŒ‡å­˜å‚¨å†…å­˜åœ°å€çš„ä¸€ç§æ•°æ®ç±»å‹ï¼Œå†…å­˜åœ°å€æ˜¯ç”±ç¼–è¯‘å™¨æ¥å†³å®šçš„ï¼Œå› æ­¤æŒ‡é’ˆçš„å¤§å°ç”±ç¼–è¯‘å™¨å†³å®šã€‚åœ¨ 64 ä½ <code>clang++</code> ç¼–è¯‘å™¨ä¸­ï¼Œå†…å­˜åœ°å€çš„é•¿åº¦ä¸º 8 ä¸ªå­—èŠ‚ï¼Œå› æ­¤æ— è®º <code>int *</code>ã€<code>double *</code> è¿˜æ˜¯ <code>char *</code> ç±»å‹çš„æŒ‡é’ˆå…¶å¤§å°å‡ä¸º 8 ä¸ªå­—èŠ‚ã€‚æ¯”å¦‚ <code>int *b = &amp;a;</code>ï¼Œ<code>&amp;</code> åœ¨ C/C++ ä¸­æ˜¯å–åœ°å€çš„ç¬¦å·ï¼Œå³æˆ‘ä»¬å°† <code>a</code> å˜é‡çš„å†…å­˜åœ°å€å­˜å‚¨åœ¨ <code>b</code> ä¸­ï¼Œå¦‚ä¸‹å›¾ç»¿è‰²çš„éƒ¨åˆ†ã€‚å› æ­¤ <code>b</code> çš„å€¼å°±æ˜¯ <code>0x00000000</code>ï¼Œè€Œ <code>*b</code> å–å†…å®¹æ‰ä¸º <code>10</code>ã€‚è¿™æ—¶æˆ‘ä»¬å°±èƒ½å‘ç°ï¼Œå¯¹äºæŒ‡é’ˆç±»å‹ï¼Œå…¶ä¸€å…±æœ‰ä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€ä¸ªæ˜¯å˜é‡æœ¬èº«ç›´æ¥å­˜å‚¨çš„å†…å­˜åœ°å€ï¼Œå¦ä¸€ä¸ªåˆ™æ˜¯ä½äºè¯¥å†…å­˜åœ°å€å¤„çš„å€¼ã€‚</p>

<p><img src="/img/2019/const_static_extern_in_cpp_obj-c/1.png" alt="1" /></p>

<p>é‚£ä¹ˆï¼Œå½“æŒ‡é’ˆé‡ä¸Š <code>const</code>ï¼Œå“ªä¸€éƒ¨åˆ†å°†ä¸å¯å˜å‘¢ï¼Ÿå½“ <code>const</code> ä¿®é¥°æŒ‡é’ˆä¸­å†…å­˜åœ°å€å¯¹åº”å˜é‡çš„ç±»å‹æ—¶ï¼Œå³åœ¨è¡¨è¾¾å¼æœ€å·¦è¾¹æˆ–åœ¨ <code>*</code> å·¦è¾¹æ—¶ï¼Œå…¶å†…éƒ¨å­˜å‚¨çš„å†…å­˜åœ°å€æ‰€å¯¹åº”çš„å€¼ä¸ºå¸¸é‡ï¼Œä¸å¯è¢«æ”¹å˜ã€‚ä½†æˆ‘ä»¬ä»èƒ½å¤Ÿé€šè¿‡ç›´æ¥æ”¹å˜æŒ‡é’ˆå­˜å‚¨çš„å˜é‡åœ°å€è€Œé—´æ¥æ”¹å˜å…¶å€¼ã€‚å½“ <code>const</code> ä½äºè¡¨è¾¾å¼ä¸­ <code>*</code> å³è¾¹æ—¶ï¼Œå…¶å†…éƒ¨å­˜å‚¨çš„å†…å­˜åœ°å€å°†æ— æ³•è¢«æ”¹å˜ï¼Œä½†è¯¥å†…å­˜åœ°å€æ‰€å¯¹åº”çš„å€¼å´å¯ä»¥è¢«æ”¹å˜ã€‚å½“æˆ‘ä»¬æ—¢ä¸å¸Œæœ›æ”¹å˜æŒ‡é’ˆä¸­å­˜å‚¨çš„å†…å­˜åœ°å€ï¼Œä¹Ÿä¸å¸Œæœ›æ”¹å˜è¯¥å†…å­˜åœ°å€æ‰€å¯¹åº”çš„å€¼æ—¶ï¼Œå°±éœ€è¦åŒæ—¶é™å®šä¸¤å¤„ï¼Œä½¿ç”¨ä¸¤ä¸ª <code>const</code> æ¥è¾¾åˆ°è¿™ç§æ•ˆæœã€‚</p>

<pre><code class="language-cpp">int foo = 0;
int bar = 10;

int *c = &amp;foo;
c = &amp;bar;
*c = foo;

const int *d = &amp;foo;
d = &amp;bar;
// error: read-only variable is not assignable
// *d = foo;

int const *e = &amp;foo;
e = &amp;bar;
// *e = foo;

int *const f = &amp;foo;
// error: cannot assign to variable 'f' with const-qualified type 'int *const'
// f = &amp;bar;
*f = foo;

const int *const g = &amp;foo;
// error: cannot assign to variable 'g' with const-qualified type 'const int *const'
// g = &amp;bar;
// error: read-only variable is not assignable
// *g = foo;
</code></pre>

<p>ç”±äº Obj-C/C++ ä¸­çš„åŸºç¡€ç±»å‹æœ¬è´¨ä»ç„¶æ˜¯ C/C++ ä¸­çš„åŸºç¡€ç±»å‹ï¼Œã€ŒæŒ‡å‘åŸºç¡€ç±»å‹çš„æŒ‡é’ˆã€å°†ä¸é’ˆå¯¹ Obj-C/C++ ä¸¾ä¾‹ã€‚</p>

<h3 id="æŒ‡å‘å¯¹è±¡ç±»å‹çš„æŒ‡é’ˆ">æŒ‡å‘å¯¹è±¡ç±»å‹çš„æŒ‡é’ˆ</h3>

<p>å¦‚æœæˆ‘ä»¬å·²ç»å¾ˆå¥½åœ°ç†è§£äº†ä¸Šä¸€èŠ‚ã€ŒæŒ‡å‘åŸºç¡€ç±»å‹çš„æŒ‡é’ˆã€ï¼Œé‚£ä¹ˆå¯¹äºæŒ‡å‘å¯¹è±¡ç±»å‹çš„æŒ‡é’ˆä¹Ÿå°†æ°´åˆ°æ¸ æˆã€‚æŒ‡å‘å¯¹è±¡ç±»å‹çš„æŒ‡é’ˆçš„æœ¬è´¨ä»ç„¶æ˜¯æŒ‡é’ˆï¼Œå› æ­¤å…¶å†…éƒ¨ä»å­˜å‚¨çš„æ˜¯å†…å­˜åœ°å€ï¼Œå¤§å°ä¹Ÿä¸ <code>int *</code> ä¸€æ ·éƒ½æ˜¯ 8 ä¸ªå­—èŠ‚ã€‚ä¸æŒ‡å‘åŸºç¡€ç±»å‹çš„æŒ‡é’ˆä¸åŒçš„æ˜¯ï¼Œå…¶å†…éƒ¨å­˜å‚¨çš„å†…å­˜åœ°å€å¯¹åº”å€¼æ˜¯å¯¹è±¡ç±»å‹ã€‚</p>

<pre><code class="language-cpp">class Foo
{
public:
    double bar;
    int *baz;

    Foo(double _bar, int *_baz)
    {
        bar = _bar;
        baz = _baz;
    }
};
</code></pre>

<p>å½“æˆ‘ä»¬åœ¨ C++ ä¸­åˆ›å»ºå¯¹è±¡æ—¶ï¼ˆC++ ä¸­å¼•å…¥äº† <code>class</code> ç±»ä¸å¯¹è±¡çš„æ¦‚å¿µï¼‰ï¼Œ<code>new</code> å°†ç”³è¯·å†…å­˜ç©ºé—´ï¼Œ<code>SomeClass()</code> æ„é€ æ–¹æ³•å°†åˆå§‹åŒ–ï¼Œæœ€ç»ˆè¿”å›å¯¹è±¡çš„é¦–åœ°å€ï¼Œä¿å­˜åœ¨è¡¨è¾¾å¼å·¦è¾¹çš„å˜é‡ä¸­ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆè¿™é‡Œæˆ‘ä»¬ä¸å†éœ€è¦ <code>&amp;</code> æ¥å–åœ°å€ã€‚</p>

<pre><code class="language-cpp">int a = 1;
int b = 5;

Foo *foo1 = new Foo(0.0, &amp;a);
foo1-&gt;bar = 0.5;
cout &lt;&lt; foo1-&gt;bar &lt;&lt; endl;    // 0.5
cout &lt;&lt; * foo1-&gt;baz &lt;&lt; endl;  // 1

a = 10;
cout &lt;&lt; * foo1-&gt;baz &lt;&lt; endl;  // 10

foo1-&gt;baz = &amp;b;
cout &lt;&lt; * foo1-&gt;baz &lt;&lt; endl;  // 5

* foo1-&gt;baz = 100;
cout &lt;&lt; * foo1-&gt;baz &lt;&lt; endl;  // 100

foo1 = new Foo(1.5, &amp;a);
cout &lt;&lt; foo1-&gt;bar &lt;&lt; endl;    // 1.5
cout &lt;&lt; * foo1-&gt;baz &lt;&lt; endl;  // 10
</code></pre>

<p>è€Œå½“æŒ‡å‘å¯¹è±¡ç±»å‹çš„æŒ‡é’ˆé‡åˆ° <code>const</code> æ—¶ï¼Œå°±å’ŒæŒ‡å‘åŸºç¡€ç±»å‹çš„æŒ‡é’ˆå¾ˆç±»ä¼¼äº†ã€‚å½“ <code>const</code> åœ¨è¡¨è¾¾å¼æœ€å·¦è¾¹æˆ–åœ¨ <code>*</code> å·¦è¾¹æ—¶ï¼Œå¯¹è±¡ä¸­çš„åŸºç¡€ç±»å‹çš„å€¼å°†ä¸å¯æ”¹å˜ï¼ŒæŒ‡é’ˆç±»å‹å­˜å‚¨çš„åœ°å€å€¼ä¹Ÿå°†ä¸å¯æ”¹å˜ï¼ˆç±»ä¼¼äº <code>const int *baz</code>ï¼‰ã€‚ä½†æ­¤æ—¶æˆ‘ä»¬ä»å¯ä»¥é€šè¿‡ <code>new</code> åˆ›å»ºæ–°çš„å¯¹è±¡ï¼ˆé¦–åœ°å€ï¼‰æˆ–è€…å°†å…¶å®ƒå·²åˆ›å»ºå¥½çš„å¯¹è±¡ï¼ˆé¦–åœ°å€ï¼‰èµ‹å€¼ç»™å˜é‡ã€‚</p>

<pre><code class="language-cpp">const Foo *foo2 = new Foo(0.0, &amp;a);
// error: cannot assign to variable 'foo2' with const-qualified type 'const Foo *'
// foo2-&gt;bar = 0.5;
cout &lt;&lt; * foo2-&gt;baz &lt;&lt; endl;  // 1
a = 10;
cout &lt;&lt; * foo2-&gt;baz &lt;&lt; endl;  // 10
// error: cannot assign to variable 'foo2' with const-qualified type 'const Foo *'
// foo2-&gt;baz = &amp;b;
* foo2-&gt;baz = 100;
cout &lt;&lt; * foo2-&gt;baz &lt;&lt; endl;  // 100

foo2 = new Foo(1.5, &amp;a);
cout &lt;&lt; foo2-&gt;bar &lt;&lt; endl;    // 1.5
cout &lt;&lt; * foo2-&gt;baz &lt;&lt; endl;  // 100

foo2 = foo1;
</code></pre>

<p>å½“ <code>const</code> ä½äºè¡¨è¾¾å¼ä¸­ <code>*</code> å³è¾¹æ—¶ï¼Œå…¶å†…éƒ¨å­˜å‚¨çš„å†…å­˜åœ°å€å°†æ— æ³•è¢«æ”¹å˜ï¼Œä½†è¯¥å†…å­˜åœ°å€æ‰€å¯¹åº”çš„å€¼å´å¯ä»¥è¢«æ”¹å˜ã€‚</p>

<pre><code class="language-cpp">Foo * const foo3 = new Foo(0.0, &amp;a);
foo3-&gt;bar = 0.5;
cout &lt;&lt; foo3-&gt;bar &lt;&lt; endl;    // 0.5
cout &lt;&lt; * foo3-&gt;baz &lt;&lt; endl;  // 1
a = 10;
cout &lt;&lt; * foo3-&gt;baz &lt;&lt; endl;  // 10
foo3-&gt;baz = &amp;b;
cout &lt;&lt; * foo3-&gt;baz &lt;&lt; endl;  // 5
* foo3-&gt;baz = 100;
cout &lt;&lt; * foo3-&gt;baz &lt;&lt; endl;  // 100

// error: cannot assign to variable 'foo3' with const-qualified type 'Foo *const'
// foo3 = new Foo(1.5, &amp;a);
// foo3 = foo1;
</code></pre>

<h3 id="æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆ">æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆ</h3>

<p>åœ¨äº†è§£äº†æŒ‡é’ˆçš„ <code>const</code></p>

<p>ğŸš§</p>

<pre><code class="language-cpp">int foo = 0;
int foo2 = 10;
int *bar = &amp;foo;
int *bar2 = &amp;foo2;
int **baz = &amp;bar;

cout &lt;&lt; **baz &lt;&lt; endl;
baz = &amp;bar2;
cout &lt;&lt; **baz &lt;&lt; endl;
*baz = &amp;foo2;
cout &lt;&lt; **baz &lt;&lt; endl;
**baz = foo2;
cout &lt;&lt; **baz &lt;&lt; endl;

cout &lt;&lt; &quot;---&quot; &lt;&lt; endl;

// error: cannot initialize a variable of type 'const int **' with an rvalue of type 'int **'
// const int **baz2 = &amp;bar;

// int const **baz2 = &amp;bar;

int *const *baz2 = &amp;bar;
cout &lt;&lt; **baz2 &lt;&lt; endl;
baz2 = &amp;bar2;
cout &lt;&lt; **baz2 &lt;&lt; endl;
// error: read-only variable is not assignable
// *baz2 = &amp;foo2;
**baz2 = foo2;
cout &lt;&lt; **baz2 &lt;&lt; endl;

cout &lt;&lt; &quot;---&quot; &lt;&lt; endl;

int **const baz3 = &amp;bar;
cout &lt;&lt; **baz3 &lt;&lt; endl;
// error: cannot assign to variable 'baz3' with const-qualified type 'int **const'
// baz3 = &amp;bar2;
*baz3 = &amp;foo2;
cout &lt;&lt; **baz3 &lt;&lt; endl;
**baz3 = foo2;
cout &lt;&lt; **baz3 &lt;&lt; endl;

// OUTPUT:
// 0
// 10
// 10
// 10
// ---
// 0
// 10
// 10
// ---
// 0
// 10
// 10
</code></pre>

<h2 id="static"><code>static</code></h2>

<h2 id="extern"><code>extern</code></h2>

<h2 id="reference">Reference</h2>

<pre><code>

//        PersonA *p = [[PersonA alloc] init];
//        [p doSomethingHiddly];

        ////    AAA = @&quot;BBB&quot;;
        //    BBB = @&quot;CCC&quot;;
        //    NSString *a = @&quot;CCC&quot;;
        //    BBB = a;
        ////    NSLog(@&quot;%@&quot;, BBB);
        ////    DDD = 333;
        ////    CCC = 333;

//        NSString * const D = @&quot;DD&quot;;
//        const NSString *E = @&quot;EE&quot;;
//
//        id DD = [D copy];
//        id EE = [E copy];
//
//        //    D = @&quot;D&quot;;
//        E = [[NSString alloc] init];
//
//        BBB = @&quot;&quot;;
//
//        // æŒ‡å‘çš„å†…å­˜åœ°å€ä¸èƒ½æ”¹ï¼Œè‡ªå·±çš„åœ°å€èƒ½æ”¹
//        PersonA * const ppp1 = [[PersonA alloc] init];
//        // æŒ‡å‘çš„å†…å­˜åœ°å€èƒ½æ”¹ï¼Œè‡ªå·±çš„åœ°å€ä¸èƒ½æ”¹
//        const PersonA * ppp2 = [[PersonA alloc] init];
//        const PersonA * const ppp3 = [[PersonA alloc] init];
//
//        PersonA const * ppp4 = [[PersonA alloc] init];
//        PersonA const * const ppp5 = [[PersonA alloc] init];


//        PersonA * ppp3 = ppp1;
//        &amp;ppp1 = &amp;ppp3;
//
//        ppp1.name = @&quot;111&quot;;
//
//        ppp1 = [[PersonA alloc] init];
//        ppp2 = [[PersonA alloc] init];



//        ppp4.name = @&quot;&quot;;



        // ä¸€æ—¦å˜é‡è¢«å£°æ˜ï¼Œç³»ç»Ÿå°†ä¸ºè¯¥å˜é‡åˆ†é…å†…å­˜ç©ºé—´ï¼Œè¿™å—å†…å­˜ç©ºé—´æ˜¯ä¸å¯æ›´æ”¹çš„ã€‚

        // a/b æ˜¯ int å‹ï¼Œä¿å­˜çš„æ•°æ®æ˜¯ int
        // è¿™ä¸ªæ•°æ®æœ¬èº«æ˜¯ä¸èƒ½æ›´æ”¹çš„
        const int a = 5;
//        a = 10;
        // ---
        int const b = 5;
//        b = 10;
        // ---
        int cc = 5;
        int dd = 10;
        // c æ˜¯æŒ‡é’ˆç±»å‹ï¼Œä¿å­˜çš„æ•°æ®æ˜¯å†…å­˜åœ°å€ï¼Œè¯¥å†…å­˜åœ°å€æŒ‡å‘çš„åŒºåŸŸå­˜å‚¨äº† int ç±»å‹
        // const int * c ä»£è¡¨ä¿å­˜çš„å†…å­˜åœ°å€å¯ä»¥æ”¹å˜ï¼Œä½†å…¶ä¿å­˜çš„å†…å­˜åœ°å€æ‰€æŒ‡å‘çš„ int ä¸å¯å˜
        // const int const * c == int const * c == const int * c
        int const * c = &amp;cc;
//        const int * c = &amp;cc;
//        const int const * c = &amp;cc;
//        *c = dd;
        c = &amp;dd;

        NSLog(@&quot;c - %d&quot;, *c);

        // d æ˜¯æŒ‡é’ˆç±»å‹ï¼Œä¿å­˜çš„æ•°æ®æ˜¯å†…å­˜åœ°å€ï¼Œè¯¥å†…å­˜åœ°å€æŒ‡å‘çš„åŒºåŸŸå­˜å‚¨äº† int ç±»å‹
        // int * const d ä»£è¡¨ä¿å­˜çš„å†…å­˜åœ°å€ä¸å¯å˜ï¼Œä½†å…¶ä¿å­˜çš„å†…å­˜åœ°å€æ‰€æŒ‡å‘çš„ int å¯ä»¥å˜
        int * const d = &amp;dd;
//        d = &amp;cc;
        *d = cc;

        NSLog(@&quot;d - %d&quot;, *d);

        int ee = 5;
        int eee = 10;

        // e æ˜¯æŒ‡é’ˆç±»å‹ï¼Œä¿å­˜çš„æ•°æ®æ˜¯å†…å­˜åœ°å€ï¼Œè¯¥å†…å­˜åœ°å€æŒ‡å‘çš„åŒºåŸŸå­˜å‚¨äº† int ç±»å‹
        // const int * const e ä»£è¡¨ä¿å­˜çš„å†…å­˜åœ°å€å’Œå…¶æ‰€æŒ‡å‘çš„ int éƒ½ä¸å¯ä»¥å˜
        const int * const e = &amp;ee;
//        e = &amp;eee;
//        *e = eee;

        const NSString *str = @&quot;str&quot;;
        str = @&quot;string&quot;;


//        const Person * p = [[Person alloc] init];
//        const Person const * p = [[Person alloc] init];
//        PersonA const * p = [[PersonA alloc] init];
//        p-&gt;_height = 10;
//        p-&gt;_name = @&quot;&quot;;
//        p = [PersonA new];

//        PersonA * const pp = [[PersonA alloc] init];
//        pp-&gt;_height = 10;
//        pp-&gt;_name = @&quot;&quot;;
//        pp = [Person new];

        PersonA *pa = [[PersonA alloc] init];
//        pa-&gt;_name = @&quot;11&quot;;
//        NSLog(@&quot;%@&quot;, pa-&gt;_name);
        pa.name = @&quot;11&quot;;
        [pa test];





//        NSString *str1 = [[NSString alloc] initWithString:@&quot;The string&quot;];
//        NSString *str2 = [NSString stringWithString:@&quot;The string&quot;];
//        NSString *str3 = @&quot;The string&quot;;
//        NSString *str4 = [NSString stringWithFormat:@&quot;string&quot;];
//        NSString *str5 = str4;
//        Method method = class_getInstanceMethod([PersonA class], @selector(doSomethingHiddly));

        NSLog(@&quot;---&quot;);
        NSString *aaa = @&quot;1234567890-&quot;;
        NSString *bbb = @&quot;1234567890-&quot;;
        bbb = @&quot;&quot;;

        NSLog(@&quot;%d&quot;, aaa == bbb);
        NSLog(@&quot;%d&quot;, [aaa isEqual:bbb]);
        NSLog(@&quot;%d&quot;, [aaa isEqualToString:bbb]);
        NSLog(@&quot;%d&quot;, aaa == @&quot;1234567890-&quot;);
</code></pre>

  </div>
  
  <div class="pagination">
    <div class="pagination__title">
      <span
        class="pagination__title-h">Read other posts</span>
      <hr />
    </div>
    <div class="pagination__buttons">
      
      
      <span class="button next">
        <a href="/posts/2019/objc_msgsend/">
          <span class="button__text">objc_msgSend</span>
          <span class="button__icon">â†’</span>
        </a>
      </span>
      
    </div>
  </div>
  

  

    
    
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo="kingcos/kingcos.github.io"
            issue-term="pathname"
            label="comments"
            theme="github-dark"
            crossorigin="anonymous"
            async>
      </script>
    </div>
    

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>Â© 2019 Â· <a href="http://github.com/kingcos">kingcos</a></span>
      </div>
    
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>





  
</div>

</body>
</html>
