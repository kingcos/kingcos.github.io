<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>[译] URL 加载系统 :: iBlog</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="作者 原文链接     Apple Inc. URL Loading System    使用标准互联网协议与 URL 交互，并和服务器通信。
 框架：  Foundation     概览 URL 加载系统通过标准协议比如 HTTPS 或自建协议提供对 URL 标识资源的访问。加载过程是异步的，所以 App 可以保持响应并当数据到达或出错时进行处理。
使用 URLSession 实例可以创建一个或多个 URLSessionTask 实例，来抓取并返回数据给 App、下载文件、或者上传数据和文件到远程地址。使用 URLSessionConfiguration 对象可以配置会话（Session），可以控制类似如何使用缓存和 Cookie 的行为、以及是否允许蜂窝网络连接。
一个会话可以重复地创建任务。举个例子，浏览器可能有分隔的会话以区分普通和隐私浏览，隐私会话将不缓存数据。图 1 展示了不同配置的两种会话可以创建许多任务。
 默认浏览：URLSession [默认配置] -&amp;gt; URLSessionDataTask 隐私浏览：URLSession [临时配置] -&amp;gt; URLSessionDataTask  为了接收定期的更新（或错误），每个会话都与一个代理关联。默认代理将调用提供的回调 Block；如果选择提供自定义的代理，该 Block 不再调用。
通过配置 App 运行在后台时的会话，即可当 App 被挂起时，系统可以代替其下载数据并唤起 App 以分发结果。"/>
<meta name="keywords" content="kingcos.me,maimieng.comios,swift,objective-c,obj-c,objc,oc,geek,python,ruby,golang,go,apple,mac"/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="/posts/2019/url_loading_system/" />





<link rel="stylesheet" href="/assets/style.css">


<link rel="stylesheet" href="/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/img/favicon.png">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="[译] URL 加载系统"/>
<meta name="twitter:description" content="使用标准互联网协议与 URL 交互，并和服务器通信。"/>



<meta property="og:title" content="[译] URL 加载系统" />
<meta property="og:description" content="使用标准互联网协议与 URL 交互，并和服务器通信。" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/2019/url_loading_system/" />
<meta property="article:published_time" content="2019-05-06T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-05-06T00:00:00+00:00" /><meta property="og:site_name" content="iBlog" />




<script data-ad-client="ca-pub-9925978992661955" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  </head>
  <body class="">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">kingcos.me</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/links">Links</a></li>
        
      
        
          <li><a href="/perspective">Perspective</a></li>
        
      
        
          <li><a href="/words">Words</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/links">Links</a></li>
      
    
      
        <li><a href="/perspective">Perspective</a></li>
      
    
      
        <li><a href="/words">Words</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  <div class="post">
    <h2 class="post-title"><a href="/posts/2019/url_loading_system/">[译] URL 加载系统</a></h2>
    <div class="post-meta">
      
        <span class="post-date">
            2019-05-06
        </span>
      
      
      
        <span class="post-read-time">— 1 min read</span>
      
    </div>

    
      <span class="post-tags">
        
          #<a href="/tags/translation/">Translation</a>&nbsp;
        
          #<a href="/tags/ios/">iOS</a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      <table>
<thead>
<tr>
<th align="center">作者</th>
<th align="center">原文链接</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">Apple Inc.</td>
<td align="center"><a href="https://developer.apple.com/documentation/foundation/url_loading_system">URL Loading System</a></td>
</tr>
</tbody>
</table>
<p>使用标准互联网协议与 URL 交互，并和服务器通信。</p>
<ul>
<li><strong>框架：</strong>
<ul>
<li>Foundation</li>
</ul>
</li>
</ul>
<hr>
<h2 id="heading">概览</h2>
<p>URL 加载系统通过标准协议比如 HTTPS 或自建协议提供对 URL 标识资源的访问。加载过程是异步的，所以 App 可以保持响应并当数据到达或出错时进行处理。</p>
<p>使用 <a href="https://developer.apple.com/documentation/foundation/urlsession">URLSession</a> 实例可以创建一个或多个 <a href="https://developer.apple.com/documentation/foundation/urlsessiontask">URLSessionTask</a> 实例，来抓取并返回数据给 App、下载文件、或者上传数据和文件到远程地址。使用 <a href="https://developer.apple.com/documentation/foundation/urlsessionconfiguration">URLSessionConfiguration</a> 对象可以配置会话（Session），可以控制类似如何使用缓存和 Cookie 的行为、以及是否允许蜂窝网络连接。</p>
<p>一个会话可以重复地创建任务。举个例子，浏览器可能有分隔的会话以区分普通和隐私浏览，隐私会话将不缓存数据。图 1 展示了不同配置的两种会话可以创建许多任务。</p>
<p><img src="/img/2019/url_loading_system/1.png" alt="图 1 为 URL 会话创建任务"></p>
<ol>
<li>默认浏览：URLSession [默认配置] -&gt; URLSessionDataTask</li>
<li>隐私浏览：URLSession [临时配置] -&gt; URLSessionDataTask</li>
</ol>
<p>为了接收定期的更新（或错误），每个会话都与一个代理关联。默认代理将调用提供的回调 Block；如果选择提供自定义的代理，该 Block 不再调用。</p>
<p>通过配置 App 运行在后台时的会话，即可当 App 被挂起时，系统可以代替其下载数据并唤起 App 以分发结果。</p>
<h2 id="heading-1">话题</h2>
<h3 id="heading-2">第一步</h3>
<p>配置并创建会话，并用来创建与 URL 交互的任务。</p>
<ul>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/url_loading_system/fetching_website_data_into_memory">取回网页数据到内存</a></p>
<ul>
<li>通过从 URL 会话创建数据任务来直接用内存接收数据。</li>
</ul>
</li>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/urlsession"><code>class URLSession</code></a></p>
<ul>
<li>定位一组相关网络数据传输任务的对象。</li>
</ul>
</li>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/urlsessiontask"><code>class URLSessionTask</code></a></p>
<ul>
<li>在 URL 会话中执行类似下载特定资源的任务。</li>
</ul>
</li>
</ul>
<h3 id="heading-3">请求与响应</h3>
<ul>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/urlrequest"><code>struct URLRequest</code></a></p>
<ul>
<li>不依赖协议或 URL Scheme 的加载请求。</li>
</ul>
</li>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/urlresponse"><code>class URLResponse</code></a></p>
<ul>
<li>与 URL 加载请求响应有关的元数据，不依赖协议或 URL Scheme。</li>
</ul>
</li>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/httpurlresponse"><code>class HTTPURLResponse</code></a></p>
<ul>
<li>与 HTTP 协议 URL 加载请求响应有关的元数据。</li>
</ul>
</li>
</ul>
<h3 id="heading-4">上传</h3>
<ul>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/url_loading_system/uploading_data_to_a_website">上传数据到网站</a></p>
<ul>
<li>从 App 发送数据到服务器。</li>
</ul>
</li>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/url_loading_system/uploading_streams_of_data">上传数据流</a></p>
<ul>
<li>向服务器发送数据流。</li>
</ul>
</li>
</ul>
<h3 id="heading-5">下载</h3>
<ul>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/url_loading_system/downloading_files_from_websites">从网站下载文件</a></p>
<ul>
<li>直接下载文件到文件系统。</li>
</ul>
</li>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/url_loading_system/pausing_and_resuming_downloads">暂停和恢复下载</a></p>
<ul>
<li>允许用户无需重新开始的恢复下载。</li>
</ul>
</li>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/url_loading_system/downloading_files_in_the_background">后台下载文件</a></p>
<ul>
<li>创建当 App 不活跃时的下载任务。</li>
</ul>
</li>
</ul>
<h3 id="heading-6">缓存行为</h3>
<ul>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/url_loading_system/accessing_cached_data">访问缓存数据</a></p>
<ul>
<li>控制 URL 请求如何使用原先的缓存数据。</li>
</ul>
</li>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/cachedurlresponse"><code>class CachedURLResponse</code></a></p>
<ul>
<li>URL 请求的缓存响应。</li>
</ul>
</li>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/urlcache"><code>class URLCache</code></a></p>
<ul>
<li>映射 URL 请求到缓存的响应对象。</li>
</ul>
</li>
</ul>
<h3 id="heading-7">身份验证与资格</h3>
<ul>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/url_loading_system/handling_an_authentication_challenge">处理身份验证校验</a></p>
<ul>
<li>当服务器要求 URL 请求进行身份验证时的合适响应。</li>
</ul>
</li>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/urlauthenticationchallenge"><code>class URLAuthenticationChallenge</code></a></p>
<ul>
<li>来自需要客户端身份验证的服务器校验。</li>
</ul>
</li>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/urlcredential"><code>class URLCredential</code></a></p>
<ul>
<li>由特定凭证类型的信息和持久化存储使用的类型（如果存在）组成的身份验证凭证。</li>
</ul>
</li>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/urlcredentialstorage"><code>class URLCredentialStorage</code></a></p>
<ul>
<li>共享凭证缓存管理。</li>
</ul>
</li>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/urlprotectionspace"><code>class URLProtectionSpace</code></a></p>
<ul>
<li>需要认证的服务器或者服务器的某个区域，或称为领域（Realm）。</li>
</ul>
</li>
</ul>
<h3 id="cookies">Cookies</h3>
<ul>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/httpcookie"><code>class HTTPCookie</code></a></p>
<ul>
<li>HTTP Cookie 的代表。</li>
</ul>
</li>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/httpcookiestorage"><code>class HTTPCookieStorage</code></a></p>
<ul>
<li>管理 Cookie 存储的容器。</li>
</ul>
</li>
</ul>
<h3 id="heading-8">错误</h3>
<ul>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/urlerror"><code>struct URLError</code></a></p>
<ul>
<li>URL 加载 API 返回的错误码。</li>
</ul>
</li>
<li>
<p><a href="https://developer.apple.com/documentation/foundation/url_loading_system/url_loading_system_error_info_keys">URL 加载系统错误信息键</a></p>
<ul>
<li>从 URL 加载 API 产生的错误对象的用户信息字典中识别这些键。</li>
</ul>
</li>
</ul>
<h3 id="heading-9">遗留</h3>
<ul>
<li><a href="https://developer.apple.com/documentation/foundation/url_loading_system/legacy_url_loading_systems">遗留 URL 加载系统</a>
<ul>
<li>将代码迁移远离使用这些旧对象。</li>
</ul>
</li>
</ul>
<h2 id="heading-10">参阅</h2>
<h3 id="heading-11">网络</h3>
<h4 id="bonjourhttpsdeveloperapplecomdocumentationfoundationbonjour"><a href="https://developer.apple.com/documentation/foundation/bonjour">Bonjour</a></h4>
<ul>
<li>指便于在本地网络发现的服务，或者由其他发现的服务。</li>
</ul>

    </div>
    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h">Read other posts</span>
          <hr />
        </div>
        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="/posts/2019/swift_4_to_5/">
                <span class="button__icon">←</span>
                <span class="button__text">Swift/Obj-C 混编项目升级 Swift 5.0 踩坑</span>
              </a>
            </span>
          
          
            <span class="button next">
              <a href="/posts/2019/&#43;initialize_in_ios/">
                <span class="button__text">iOS 中的 &#43;initialize 方法</span>
                <span class="button__icon">→</span>
              </a>
            </span>
          
        </div>
      </div>
    

    

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<table style="border: 0;">
  <tr>
  <td style="border: 0; width: 30%;">
    <img src='/img/about/1.jpg'>
  </td>
  <td style="border: 0;">
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-9925978992661955"
     data-ad-slot="3213735320"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
  </td>
  </tr>
</table>



<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>


    
    
    <div>
      <div id="github-comment">
      </div>

      <script type="text/javascript">
        function getUtterances(isDark) {
          var utterances = document.createElement('script');
          utterances.type = 'text/javascript';
          utterances.async = true;
          utterances.setAttribute('issue-term', "pathname")
          utterances.setAttribute('repo', "kingcos\/kingcos.github.io")
          utterances.setAttribute('label', "comments")
          isDark ? utterances.setAttribute('theme', "github-dark") : utterances.setAttribute('theme', "github-light")
          utterances.crossorigin = 'anonymous';
          utterances.src = 'https://utteranc.es/client.js';

          return utterances
        }

        var themeToggle = document.querySelector(".theme-toggle")
        themeToggle.addEventListener("click", function () {
          var getTheme = window.localStorage && window.localStorage.getItem("theme")
          var divNode = document.getElementById('github-comment')
          while(divNode.hasChildNodes()) {
            divNode.removeChild(divNode.firstChild);
          }
          
          
          

          
          
          
          
          
          
          document.getElementById('github-comment').appendChild(getUtterances(getTheme !== "dark"))
        })

        var getTheme = window.localStorage && window.localStorage.getItem("theme")
        document.getElementById('github-comment').appendChild(getUtterances(getTheme === "dark"))
      </script>
    </div>
    

    </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">All rights reserved by kingcos.me</div>
    
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>



      
    </div>

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-138311951-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
  </body>
</html>
