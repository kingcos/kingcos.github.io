<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>iOS ä¸­çš„åº“ä¸æ¡†æ¶ :: iBlog â€” github.com/kingcos</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Date Notes     2019-09-14 é¦–æ¬¡æäº¤ï¼ŒæŒç»­æ›´æ–°å®Œå–„   2019-09-22 æŒç»­æ›´æ–°å®Œå–„ï¼Œé€‚é… Xcode 11    Preface éšç€è½¯ä»¶å·¥ç¨‹çš„å‘å±•ï¼Œå¾ˆå¤šæˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½å‰äººéƒ½å·²ç»å¾ˆå¥½åœ°å®ç°äº†ï¼Œä¸ºäº†æé«˜æ•ˆç‡é¿å…é‡å¤å»ºè®¾ï¼Œè¿™äº›åŠŸèƒ½å®ç°çš„ä»£ç è¢«å°è£…ä¸ºä»£ç åº“ï¼Œæœ‰æ—¶ä¹Ÿç§°æ¡†æ¶ã€‚æˆ‘ä»¬åªéœ€è¦åœ¨ç”¨åˆ°çš„æ—¶å€™é€šè¿‡ä¾èµ–ç®¡ç†å·¥å…·å°†å®ƒä»¬ä»¥é€‚å½“çš„æ–¹å¼å¼•å…¥å³å¯ã€‚æœ¬æ–‡å°†ç®€å•èŠèŠ iOS ä¸­çš„åº“ä¸æ¡†æ¶ç›¸å…³æ¦‚å¿µã€‚
åŸºæœ¬æ¦‚å¿µ åœ¨åˆ‡å…¥æ­£é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥è¾¾æˆä¸€äº›å…±è¯†ã€‚
ä¸ç®¡æ˜¯è€æ´¾ Obj-C è¿˜æ˜¯æ–°ç§€ Swiftï¼Œå®ƒä»¬çš„æœ¬è´¨éƒ½æ˜¯ç¼–è¯‘å‹è¯­è¨€ã€‚å¯¹äºç¼–è¯‘å‹è¯­è¨€ï¼Œæºä»£ç ä¼šé¦–å…ˆç»ç”±ç¼–è¯‘å™¨ç¼–è¯‘ä¸ºç›®æ ‡æ–‡ä»¶ï¼Œé“¾æ¥å™¨å†å°†å¤šä¸ªç›®æ ‡æ–‡ä»¶é“¾æ¥ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ã€‚é’ˆå¯¹é“¾æ¥é˜¶æ®µï¼Œä¸»è¦åˆ†ä¸ºé™æ€é“¾æ¥ä¸åŠ¨æ€é“¾æ¥ã€‚
é™æ€ï¼Œå³ Staticã€‚æŒ‰ç…§å­—é¢æ„æ€ï¼Œé™æ€å³ä¸€æ—¦ç¡®å®šï¼Œå°±ä¸å†å®¹æ˜“æ”¹å˜ã€‚é™æ€é“¾æ¥ï¼Œå³åœ¨é“¾æ¥é˜¶æ®µï¼Œç›´æ¥å°†å¤šä¸ªç›®æ ‡æ–‡ä»¶é“¾æ¥ä¸ºä¸€ä¸ªæ–‡ä»¶ã€‚è€Œé™æ€åº“å°±å¯ä»¥ç†è§£ä¸ºå…±åŒç¼–è¯‘ä¸ºä¸€ä¸ªç›®æ ‡æ–‡ä»¶çš„æºä»£ç é›†åˆã€‚
åŠ¨æ€ï¼Œå³ Dynamicã€‚æŒ‰ç…§å­—é¢æ„æ€ï¼ŒåŠ¨æ€å³æ¨è¿Ÿåˆ°è¿è¡Œæ—¶åŠ¨æ€åœ°å†³è®®ã€‚åŠ¨æ€é“¾æ¥ï¼Œå³åœ¨è¿è¡Œæ—¶æ‰å°†å„ä¸ªéƒ¨åˆ†ç»„åˆå½¢æˆå®Œæ•´çš„ç¨‹åºã€‚è€ŒåŠ¨æ€åº“å°±å¯ä»¥ç†è§£ä¸ºæ”¯æŒåŠ¨æ€é“¾æ¥æ–¹å¼çš„æºä»£ç é›†åˆã€‚
é™æ€é“¾æ¥çš„å¥½å¤„æ˜¯ï¼Œè¿è¡Œæ—¶ä¸å†é¢å¤–éœ€è¦æ—¶é—´åŠ¨æ€é“¾æ¥ï¼›åå¤„åˆ™æ˜¯ç”±äºé“¾æ¥çš„ç²’åº¦æ˜¯ç›®æ ‡æ–‡ä»¶ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šé“¾æ¥äº†æ²¡æœ‰ä½¿ç”¨åˆ°çš„å‡½æ•°ï¼Œä¼šé€ æˆå¯æ‰§è¡Œæ–‡ä»¶è¿‡å¤§ï¼›è€Œä¸”å½“æŸä¸€ä¸ªç›®æ ‡æ–‡ä»¶çš„æºä»£ç æ”¹åŠ¨æ—¶ï¼Œé‚£ä¹ˆæ‰€æœ‰ä¾èµ–è¯¥ç›®æ ‡æ–‡ä»¶çš„é™æ€åº“éƒ½éœ€è¦é‡æ–°ç¼–è¯‘ï¼›åŠ¨æ€é“¾æ¥åˆ™è§£å†³äº†é™æ€é“¾æ¥çš„ç©ºé—´æµªè´¹ä¸é‡å¤ç¼–è¯‘é—®é¢˜ï¼Œæ¯”å¦‚åœ¨ iOS ä¸­ï¼Œç³»ç»Ÿåº“é‡‡ç”¨äº† dyld_shared_cache åŠ¨æ€é“¾æ¥ï¼Œè¿™æ ·å…¶å®ƒç¨‹åºå°±æ— éœ€å†å°†ç³»ç»Ÿåº“é‡å¤é“¾æ¥ï¼Œå½“ iOS ç³»ç»Ÿæ›´æ–°æ—¶ä¹Ÿæ— éœ€å°†æ‰€æœ‰ app é‡æ–°ç¼–è¯‘ã€‚è€Œåœ¨ç§»åŠ¨ç«¯å¼€å‘ä¸­ï¼Œapp çš„å¯åŠ¨æ—¶é—´ä¸åŒ…ä½“ç§¯å¤§å°å°†æ˜¯ä¸€ä¸ªæƒè¡¡é—®é¢˜ï¼Œå€¼å¾—æˆ‘ä»¬ä¾§é‡ä¸è€ƒé‡ã€‚
å¦å¤–ï¼Œè™½ç„¶å¹¿ä¹‰ä¸Šçš„åº“ï¼ˆLibraryï¼‰ä¸æ¡†æ¶ï¼ˆFrameworkï¼‰å«ä¹‰æ˜¯ç±»ä¼¼çš„ï¼Œä½†åœ¨ iOS å¼€å‘ä¸­ï¼Œå®˜æ–¹å°†è¿™ä¸¤ä¸ªæ¦‚å¿µè¿›è¡Œäº†åŒºåˆ†ï¼Œå› æ­¤ä¸‹æ–‡ä¸­æˆ‘ä»¬ä¼šæ˜ç¡®ä¸¤ä¸ªè¯çš„ä½¿ç”¨ã€‚
Cocoa Touch Static Library æˆ‘ä»¬å…ˆä» Xcode ä¸­èƒ½å¤Ÿç›´æ¥åˆ›å»ºçš„ Cocoa Touch Static Library è¯´èµ·ï¼ˆæ³¨æ„ï¼Œåœ¨ Xcode 11 ä¸­ï¼Œè¿™é‡Œå·²ç»å˜æˆ Framework ä¸ Libraryï¼Œæ›´åŠ æ¸…æ™°ï¼‰ï¼š
Cocoa Touch Static Library å³é™æ€åº“ã€‚iOS ä¸Šç‹­ä¹‰çš„é™æ€åº“ï¼Œå³åªåŒ…å«ç¼–è¯‘åä»£ç çš„ ."/>
<meta name="keywords" content="ios,swift,objective-c,obj-c,objc,oc,geek,python,ruby,golang,go,apple,mac"/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="/posts/2019/libraries_in_ios/" />





<link rel="stylesheet" href="/assets/style.css">


<link rel="stylesheet" href="/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/img/favicon.png">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="iOS ä¸­çš„åº“ä¸æ¡†æ¶"/>
<meta name="twitter:description" content="éšç€è½¯ä»¶å·¥ç¨‹çš„å‘å±•ï¼Œå¾ˆå¤šæˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½å‰äººéƒ½å·²ç»å¾ˆå¥½åœ°å®ç°äº†ï¼Œä¸ºäº†æé«˜æ•ˆç‡é¿å…é‡å¤å»ºè®¾ï¼Œè¿™äº›åŠŸèƒ½å®ç°çš„ä»£ç è¢«å°è£…ä¸ºä»£ç åº“ï¼Œæœ‰æ—¶ä¹Ÿç§°æ¡†æ¶ã€‚æˆ‘ä»¬åªéœ€è¦åœ¨ç”¨åˆ°çš„æ—¶å€™é€šè¿‡ä¾èµ–ç®¡ç†å·¥å…·å°†å®ƒä»¬ä»¥é€‚å½“çš„æ–¹å¼å¼•å…¥å³å¯ã€‚æœ¬æ–‡å°†ç®€å•èŠèŠ iOS ä¸­çš„åº“ä¸æ¡†æ¶ç›¸å…³æ¦‚å¿µã€‚"/>



<meta property="og:title" content="iOS ä¸­çš„åº“ä¸æ¡†æ¶" />
<meta property="og:description" content="éšç€è½¯ä»¶å·¥ç¨‹çš„å‘å±•ï¼Œå¾ˆå¤šæˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½å‰äººéƒ½å·²ç»å¾ˆå¥½åœ°å®ç°äº†ï¼Œä¸ºäº†æé«˜æ•ˆç‡é¿å…é‡å¤å»ºè®¾ï¼Œè¿™äº›åŠŸèƒ½å®ç°çš„ä»£ç è¢«å°è£…ä¸ºä»£ç åº“ï¼Œæœ‰æ—¶ä¹Ÿç§°æ¡†æ¶ã€‚æˆ‘ä»¬åªéœ€è¦åœ¨ç”¨åˆ°çš„æ—¶å€™é€šè¿‡ä¾èµ–ç®¡ç†å·¥å…·å°†å®ƒä»¬ä»¥é€‚å½“çš„æ–¹å¼å¼•å…¥å³å¯ã€‚æœ¬æ–‡å°†ç®€å•èŠèŠ iOS ä¸­çš„åº“ä¸æ¡†æ¶ç›¸å…³æ¦‚å¿µã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/2019/libraries_in_ios/" />
<meta property="article:published_time" content="2019-09-14T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-09-14T00:00:00+00:00" /><meta property="og:site_name" content="iBlog" />






  </head>
  <body class="dark-theme">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">iBlog</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/links">Links</a></li>
        
      
        
          <li><a href="/perspective">Perspective</a></li>
        
      
        
          <li><a href="/words">Words</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/links">Links</a></li>
      
    
      
        <li><a href="/perspective">Perspective</a></li>
      
    
      
        <li><a href="/words">Words</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  <div class="post">
    <h2 class="post-title"><a href="/posts/2019/libraries_in_ios/">iOS ä¸­çš„åº“ä¸æ¡†æ¶</a></h2>
    <div class="post-meta">
      
        <span class="post-date">
            2019-09-14
        </span>
      
      
      
        <span class="post-read-time">â€” 9 min read</span>
      
    </div>

    
      <span class="post-tags">
        
          #<a href="/tags/focus/">Focus</a>&nbsp;
        
          #<a href="/tags/ios/">iOS</a>&nbsp;
        
          #<a href="/tags/obj-c/">Obj-C</a>&nbsp;
        
          #<a href="/tags/swift/">Swift</a>&nbsp;
        
          #<a href="/tags//">ğŸš§</a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      

<table>
<thead>
<tr>
<th align="center">Date</th>
<th align="center">Notes</th>
</tr>
</thead>

<tbody>
<tr>
<td align="center">2019-09-14</td>
<td align="center">é¦–æ¬¡æäº¤ï¼ŒæŒç»­æ›´æ–°å®Œå–„</td>
</tr>

<tr>
<td align="center">2019-09-22</td>
<td align="center">æŒç»­æ›´æ–°å®Œå–„ï¼Œé€‚é… Xcode 11</td>
</tr>
</tbody>
</table>

<p><img src="/img/2019/libraries_in_ios/0.png" alt="0" /></p>

<h2 id="preface">Preface</h2>

<p>éšç€è½¯ä»¶å·¥ç¨‹çš„å‘å±•ï¼Œå¾ˆå¤šæˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½å‰äººéƒ½å·²ç»å¾ˆå¥½åœ°å®ç°äº†ï¼Œä¸ºäº†æé«˜æ•ˆç‡é¿å…é‡å¤å»ºè®¾ï¼Œè¿™äº›åŠŸèƒ½å®ç°çš„ä»£ç è¢«å°è£…ä¸ºä»£ç åº“ï¼Œæœ‰æ—¶ä¹Ÿç§°æ¡†æ¶ã€‚æˆ‘ä»¬åªéœ€è¦åœ¨ç”¨åˆ°çš„æ—¶å€™é€šè¿‡ä¾èµ–ç®¡ç†å·¥å…·å°†å®ƒä»¬ä»¥é€‚å½“çš„æ–¹å¼å¼•å…¥å³å¯ã€‚æœ¬æ–‡å°†ç®€å•èŠèŠ iOS ä¸­çš„åº“ä¸æ¡†æ¶ç›¸å…³æ¦‚å¿µã€‚</p>

<h2 id="åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ</h2>

<p>åœ¨åˆ‡å…¥æ­£é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥è¾¾æˆä¸€äº›å…±è¯†ã€‚</p>

<p>ä¸ç®¡æ˜¯è€æ´¾ Obj-C è¿˜æ˜¯æ–°ç§€ Swiftï¼Œå®ƒä»¬çš„æœ¬è´¨éƒ½æ˜¯ç¼–è¯‘å‹è¯­è¨€ã€‚å¯¹äºç¼–è¯‘å‹è¯­è¨€ï¼Œæºä»£ç ä¼šé¦–å…ˆç»ç”±ç¼–è¯‘å™¨ç¼–è¯‘ä¸ºç›®æ ‡æ–‡ä»¶ï¼Œé“¾æ¥å™¨å†å°†å¤šä¸ªç›®æ ‡æ–‡ä»¶é“¾æ¥ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ã€‚é’ˆå¯¹é“¾æ¥é˜¶æ®µï¼Œä¸»è¦åˆ†ä¸ºé™æ€é“¾æ¥ä¸åŠ¨æ€é“¾æ¥ã€‚</p>

<p><strong>é™æ€</strong>ï¼Œå³ Staticã€‚æŒ‰ç…§å­—é¢æ„æ€ï¼Œé™æ€å³ä¸€æ—¦ç¡®å®šï¼Œå°±ä¸å†å®¹æ˜“æ”¹å˜ã€‚é™æ€é“¾æ¥ï¼Œå³åœ¨é“¾æ¥é˜¶æ®µï¼Œç›´æ¥å°†å¤šä¸ªç›®æ ‡æ–‡ä»¶é“¾æ¥ä¸ºä¸€ä¸ªæ–‡ä»¶ã€‚è€Œé™æ€åº“å°±å¯ä»¥ç†è§£ä¸ºå…±åŒç¼–è¯‘ä¸ºä¸€ä¸ªç›®æ ‡æ–‡ä»¶çš„æºä»£ç é›†åˆã€‚</p>

<p><strong>åŠ¨æ€</strong>ï¼Œå³ Dynamicã€‚æŒ‰ç…§å­—é¢æ„æ€ï¼ŒåŠ¨æ€å³æ¨è¿Ÿåˆ°è¿è¡Œæ—¶åŠ¨æ€åœ°å†³è®®ã€‚åŠ¨æ€é“¾æ¥ï¼Œå³åœ¨è¿è¡Œæ—¶æ‰å°†å„ä¸ªéƒ¨åˆ†ç»„åˆå½¢æˆå®Œæ•´çš„ç¨‹åºã€‚è€ŒåŠ¨æ€åº“å°±å¯ä»¥ç†è§£ä¸ºæ”¯æŒåŠ¨æ€é“¾æ¥æ–¹å¼çš„æºä»£ç é›†åˆã€‚</p>

<p>é™æ€é“¾æ¥çš„å¥½å¤„æ˜¯ï¼Œè¿è¡Œæ—¶ä¸å†é¢å¤–éœ€è¦æ—¶é—´åŠ¨æ€é“¾æ¥ï¼›åå¤„åˆ™æ˜¯ç”±äºé“¾æ¥çš„ç²’åº¦æ˜¯ç›®æ ‡æ–‡ä»¶ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šé“¾æ¥äº†æ²¡æœ‰ä½¿ç”¨åˆ°çš„å‡½æ•°ï¼Œä¼šé€ æˆå¯æ‰§è¡Œæ–‡ä»¶è¿‡å¤§ï¼›è€Œä¸”å½“æŸä¸€ä¸ªç›®æ ‡æ–‡ä»¶çš„æºä»£ç æ”¹åŠ¨æ—¶ï¼Œé‚£ä¹ˆæ‰€æœ‰ä¾èµ–è¯¥ç›®æ ‡æ–‡ä»¶çš„é™æ€åº“éƒ½éœ€è¦é‡æ–°ç¼–è¯‘ï¼›åŠ¨æ€é“¾æ¥åˆ™è§£å†³äº†é™æ€é“¾æ¥çš„ç©ºé—´æµªè´¹ä¸é‡å¤ç¼–è¯‘é—®é¢˜ï¼Œæ¯”å¦‚åœ¨ iOS ä¸­ï¼Œç³»ç»Ÿåº“é‡‡ç”¨äº† dyld_shared_cache åŠ¨æ€é“¾æ¥ï¼Œè¿™æ ·å…¶å®ƒç¨‹åºå°±æ— éœ€å†å°†ç³»ç»Ÿåº“é‡å¤é“¾æ¥ï¼Œå½“ iOS ç³»ç»Ÿæ›´æ–°æ—¶ä¹Ÿæ— éœ€å°†æ‰€æœ‰ app é‡æ–°ç¼–è¯‘ã€‚è€Œåœ¨ç§»åŠ¨ç«¯å¼€å‘ä¸­ï¼Œapp çš„å¯åŠ¨æ—¶é—´ä¸åŒ…ä½“ç§¯å¤§å°å°†æ˜¯ä¸€ä¸ªæƒè¡¡é—®é¢˜ï¼Œå€¼å¾—æˆ‘ä»¬ä¾§é‡ä¸è€ƒé‡ã€‚</p>

<p>å¦å¤–ï¼Œè™½ç„¶å¹¿ä¹‰ä¸Šçš„åº“ï¼ˆLibraryï¼‰ä¸æ¡†æ¶ï¼ˆFrameworkï¼‰å«ä¹‰æ˜¯ç±»ä¼¼çš„ï¼Œä½†åœ¨ iOS å¼€å‘ä¸­ï¼Œå®˜æ–¹å°†è¿™ä¸¤ä¸ªæ¦‚å¿µè¿›è¡Œäº†åŒºåˆ†ï¼Œå› æ­¤ä¸‹æ–‡ä¸­æˆ‘ä»¬ä¼šæ˜ç¡®ä¸¤ä¸ªè¯çš„ä½¿ç”¨ã€‚</p>

<h2 id="cocoa-touch-static-library">Cocoa Touch Static Library</h2>

<p>æˆ‘ä»¬å…ˆä» Xcode ä¸­èƒ½å¤Ÿç›´æ¥åˆ›å»ºçš„ Cocoa Touch Static Library è¯´èµ·ï¼ˆæ³¨æ„ï¼Œåœ¨ Xcode 11 ä¸­ï¼Œè¿™é‡Œå·²ç»å˜æˆ Framework ä¸ Libraryï¼Œæ›´åŠ æ¸…æ™°ï¼‰ï¼š</p>

<p><img src="/img/2019/libraries_in_ios/1.png" alt="1" /></p>

<p>Cocoa Touch Static Library å³é™æ€åº“ã€‚iOS ä¸Šç‹­ä¹‰çš„é™æ€åº“ï¼Œå³<strong>åªåŒ…å«ç¼–è¯‘åä»£ç çš„ <code>.a</code> æ–‡ä»¶</strong>ã€‚æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª oc-static-lib çš„é™æ€åº“ï¼Œä¸ºå…¶é»˜è®¤æä¾›çš„ <code>oc_static_lib</code> ç±»æ·»åŠ  <code>foo</code> æ–¹æ³•ï¼Œå¹¶æ·»åŠ ä¸€ä¸ª <code>NSObject</code> çš„åˆ†ç±»ï¼Œå®ç° +load å’Œ <code>foo</code> æ–¹æ³•ï¼š</p>

<pre><code class="language-objectivec">// oc_static_lib.h

#import &lt;Foundation/Foundation.h&gt;

@interface oc_static_lib : NSObject
- (void)foo;
@end

// oc_static_lib.m

#import &quot;oc_static_lib.h&quot;

@implementation oc_static_lib
- (void)foo {
    NSLog(@&quot;%@ - %@&quot;, NSStringFromClass([self class]), NSStringFromSelector(_cmd));
}
@end

// NSObject+OC_Static_Lib.h

#import &lt;Foundation/Foundation.h&gt;

NS_ASSUME_NONNULL_BEGIN
@interface NSObject (OC_Static_Lib)
- (void)foo;
@end
NS_ASSUME_NONNULL_END

// NSObject+OC_Static_Lib.m

#import &quot;NSObject+OC_Static_Lib.h&quot;

@implementation NSObject (OC_Static_Lib)
+ (void)load {
    NSLog(@&quot;%@ - %@&quot;, NSStringFromClass([self class]), NSStringFromSelector(_cmd));
}
- (void)foo {
    NSLog(@&quot;%@ - %@&quot;, NSStringFromClass([self class]), NSStringFromSelector(_cmd));
}
@end
</code></pre>

<p>éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬éœ€è¦å°†æ–°åˆ›å»ºçš„ <code>.h</code> åŠ å…¥åˆ° Xcode - Targets - Build Phases - Copy Files ä¸­ï¼Œè¿™æ ·å¤–ç•Œæ‰èƒ½é€šè¿‡å¼•å…¥è¯¥å¤´æ–‡ä»¶æ¥è®¿é—®å…¶ä¸­çš„å†…å®¹ï¼š</p>

<p><img src="/img/2019/libraries_in_ios/2.png" alt="2" /></p>

<blockquote>
<p>âš ï¸</p>

<p>è¿™é‡Œæˆ‘ä»¬çš„ç›®æ ‡è®¾å¤‡é€‰æ‹©çš„æ˜¯æ¨¡æ‹Ÿå™¨ï¼Œæ‰€ä»¥é»˜è®¤ç¼–è¯‘åçš„ <code>.a</code> æ–‡ä»¶ä¹Ÿå°†åªé€‚ç”¨äºæ¨¡æ‹Ÿå™¨æ¶æ„ï¼ˆx86_64ï¼‰ï¼Œä¸ºäº†åŒæ—¶èƒ½å¤ŸçœŸæœºè¿è¡Œå’Œæ¨¡æ‹Ÿå™¨è°ƒè¯•ï¼Œé€šå¸¸ä¼šä½¿ç”¨ <code>lipo</code> å‘½ä»¤å°†å¤šç§æ¶æ„çš„ <code>.a</code> æ–‡ä»¶è¿›è¡Œåˆå¹¶ä¸ºèƒ–äºŒè¿›åˆ¶ï¼ˆFat-Binaryï¼‰æ–‡ä»¶ã€‚</p>
</blockquote>

<h3 id="obj-c-å·¥ç¨‹å¼•å…¥-obj-c-é™æ€åº“">Obj-C å·¥ç¨‹å¼•å…¥ Obj-C é™æ€åº“</h3>

<p><img src="/img/2019/libraries_in_ios/3.png" alt="3" /></p>

<p>æˆ‘ä»¬å°† oc-static-lib ç¼–è¯‘åçš„ <code>.a</code> ä¸ <code>.h</code> ä¸€èµ·æ‹–å…¥ Obj-C å·¥ç¨‹ï¼ˆè®°å¾—å‹¾é€‰ã€ŒAdd to targetsã€ï¼Œè¿™æ ·å³å¯è‡ªåŠ¨å°† <code>.a</code> åŠ å…¥åˆ°ã€ŒLink Binary With Librariesã€ä¸­ï¼‰ï¼Œå³å¯ä½¿ç”¨ <code>#import &quot;&quot;</code> æ¥å¼•å…¥å¹¶è°ƒç”¨ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šé™æ€åº“ä¸­å¦‚æœå­˜åœ¨åˆ†ç±»ï¼Œéœ€è¦æ·»åŠ  <code>-ObjC</code> ä½œä¸º Other Linker Flagsï¼Œè¯¦è§ <a href="/posts/2019/+load_in_ios/">iOS ä¸­çš„ +load æ–¹æ³•</a>ä¸€æ–‡ï¼‰ï¼š</p>

<blockquote>
<p><strong>Tips</strong></p>

<p>åœ¨ C/C++ ä¸­ï¼Œä¸ºäº†æ›´åŠ æ¸…æ™°åŒ–å£°æ˜ä¸å®ç°ï¼Œä»£ç éœ€è¦åˆ†åˆ«å†™åœ¨ <code>.h</code>ï¼ˆå¤´æ–‡ä»¶ï¼‰å’Œ <code>.c</code> / <code>.cpp</code>ï¼ˆå®ç°æ–‡ä»¶ï¼‰ä¸­ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œå¼€å‘è€…å¯ä»¥æ— éœ€é¢å¤–çš„è®¿é—®æ§åˆ¶ç¬¦å³å¯å°†éœ€è¦æš´éœ²åœ¨å¤–ç•Œçš„å£°æ˜æ”¾ç½®åœ¨å¤´æ–‡ä»¶ä¸­å³å¯ï¼Œå¤–ç•Œä½¿ç”¨æ—¶é€šè¿‡ <code>#include</code>ã€‚Obj-C/C++ ä¹Ÿå»¶ç»­äº†è¿™ä¸€ä¼ ç»Ÿï¼Œä¸åŒçš„æ˜¯å®ç°æ–‡ä»¶çš„åç¼€åˆ†åˆ«ä¸º <code>.m</code> å’Œ <code>.mm</code>ï¼Œå¹¶ä¸ºäº†é¿å…é‡å¤å¼•ç”¨æ¨å‡ºäº† <code>#import</code>ã€‚</p>

<p><code>#include</code> å’Œ <code>#import</code> åé¢éƒ½å¯ä»¥åŠ  <code>&lt;XXX.h&gt;</code> æˆ– <code>&quot;XXX.h&quot;</code>ã€‚é€šå¸¸æ¥è¯´åŠ  <code>&quot;&quot;</code> çš„å¤´æ–‡ä»¶ä¼˜å…ˆä»æœ¬åœ°å½“å‰æ–‡ä»¶ç›®å½•æŸ¥æ‰¾ï¼Œå…¶ä¸­ä¹Ÿå¯ä»¥åŒ…å«ç›¸å¯¹è·¯å¾„ï¼Œå³ <code>#import &quot;oc-static-lib/oc_static_lib.h&quot;</code> / <code>#import &quot;NSObject+OC_Static_Lib.h&quot;</code> éƒ½æ˜¯æ”¯æŒçš„ï¼›è€ŒåŠ  <code>&lt;&gt;</code> çš„å¤´æ–‡ä»¶åˆ™ä¼šä½¿å¾—ç¼–è¯‘å™¨ä¼˜å…ˆåˆ°ç³»ç»Ÿç›®å½•ä¸‹å…¨å±€æŸ¥æ‰¾ã€‚</p>
</blockquote>

<h3 id="swift-å·¥ç¨‹å¼•å…¥-swift-é™æ€åº“">Swift å·¥ç¨‹å¼•å…¥ Swift é™æ€åº“</h3>

<p>åœ¨ Xcode 9 ä¹‹åï¼ŒSwift ä¹Ÿæ”¯æŒäº†é™æ€åº“ã€‚ä¸ Obj-C ä¸åŒï¼ŒSwift æ²¡æœ‰å¤´æ–‡ä»¶çš„æ¦‚å¿µï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°†æš´éœ²ç»™å¤–ç•Œçš„ç±»å’Œå‡½æ•°ç­‰ä½¿ç”¨ <code>public</code> ä¿®é¥°ã€‚ç¼–è¯‘åçš„ Swift é™æ€åº“ä¹Ÿæ˜¯ <code>.a</code> æ–‡ä»¶ï¼Œä½†ä¸åŒçš„æ˜¯å¤šäº† <code>.swiftmodule</code> ä»¥åŠ <code>.swiftdoc</code>ï¼š</p>

<pre><code class="language-shell">âœ  Debug-iphonesimulator tree
.
â”œâ”€â”€ libswift-static-lib.a
â””â”€â”€ swift_static_lib.swiftmodule
    â”œâ”€â”€ x86_64.swiftdoc
    â””â”€â”€ x86_64.swiftmodule

1 directory, 3 files
</code></pre>

<p><code>.swiftmodule</code> åŒ…å«äº†åºåˆ—åŒ–è¿‡çš„ ASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼ŒAbstract Syntax Treeï¼‰ï¼Œå¯èƒ½ä¹ŸåŒ…å« SILï¼ˆSwift ä¸­é—´è¯­è¨€ï¼ŒSwift Intermediate Languageï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ç†è§£ä¸ºç±»ä¼¼ C è¯­è¨€åº“æˆ–æ¡†æ¶ä¸­å¤´æ–‡ä»¶çš„äºŒè¿›åˆ¶æ ¼å¼æ–‡ä»¶ï¼›<code>.swiftdoc</code> åˆ™æ˜¯ Swift æ–‡æ¡£æ³¨é‡Šç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç”± <code>Serialization::writeDocToStream()</code> ç”Ÿæˆï¼Œå› æ­¤å¹¶éæ˜¯å¿…è¦çš„ã€‚ç”±äº Swift çš„ Module æœºåˆ¶ï¼Œæˆ‘ä»¬éœ€è¦å°† Xcode - Targets - Build Settings - Swift Compiler - Search Paths - Import Paths ä¸­å¼•å…¥ï¼š</p>

<p><img src="/img/2019/libraries_in_ios/4.png" alt="4" /></p>

<p>è¿™æ ·æˆ‘ä»¬æ‰èƒ½åœ¨ Swift å·¥ç¨‹ä¸­æ­£å¸¸ä½¿ç”¨ï¼š</p>

<pre><code class="language-swift">// swift_static_lib.swift
import Foundation

@objc public class swift_static_lib: NSObject {
    @objc public func foo() {
        print(&quot;swift_static_lib - \(#function)&quot;)
    }
}

// ViewController.swift
import UIKit
import swift_static_lib

class ViewController: UIViewController {

    override func viewDidLoad() {
        super.viewDidLoad()
        // Do any additional setup after loading the view.

        swift_static_lib().foo()
    }
}
</code></pre>

<h3 id="obj-c-å·¥ç¨‹å¼•å…¥-swift-é™æ€åº“">Obj-C å·¥ç¨‹å¼•å…¥ Swift é™æ€åº“</h3>

<p>ä¸ºäº†ã€Œææ‹”ã€æ–°ç§€ï¼ŒSwift æ”¯æŒä¸ Obj-C æ··ç¼–ï¼Œç„¶è€Œæ··ç¼–ä¸‹çš„å„ç§æƒ…å†µå°±ä¼šå˜å¾—ååˆ†ç‰¹æ®Šã€‚åœ¨åŒä¸€ä¸ªå·¥ç¨‹ä¸‹ Swift æ–‡ä»¶ä¸ Obj-C æ–‡ä»¶æ··ç¼–æ—¶ï¼ŒXcode ä¼šæç¤ºæˆ‘ä»¬åˆ›å»ºæ¡¥æ¥å¤´æ–‡ä»¶ <code>&lt;PROJECT_NAME&gt;-Bridging-Header.h</code>ï¼Œæˆ‘ä»¬å¯ä»¥å°†éœ€è¦æš´éœ²ç»™ Swift çš„ Obj-C ä»£ç åœ¨è¯¥æ¡¥æ¥æ–‡ä»¶ä¸­å¼•å…¥ï¼›è€Œ Obj-C ä»£ç ä¸­å¸Œæœ›ä½¿ç”¨ Swift ä¸­çš„ç›¸å…³å®šä¹‰æ—¶ï¼Œå¯ä»¥å¼•å…¥è‡ªåŠ¨ç”Ÿæˆä½†ä¸å¯è§çš„ <code>&lt;PROJECT_NAME&gt;-Swift.h</code>ï¼Œå¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæš´éœ²ç»™ Obj-C çš„ç±»æˆ–å‡½æ•°ç­‰éœ€è¦ä½¿ç”¨ <code>@objc</code> æˆ– <code>dynamic</code> ä¿®é¥°ï¼Œå‰è€…ä¸èƒ½å†³å®šå‡½æ•°æœ€ç»ˆæ´¾å‘æ–¹å¼ï¼Œè€Œåè€…åˆ™ä¸ºåŠ¨æ€æ´¾å‘ã€‚</p>

<p>é‚£ä¹ˆå¦‚æœè¦åœ¨ Obj-C å·¥ç¨‹å¼•å…¥ Swift é™æ€åº“ï¼Œé¦–å…ˆè¦åœ¨å·¥ç¨‹ä¸­å¼•å…¥ä¸€ä¸ªå ä½ Swift æ–‡ä»¶ï¼Œå¹¶åˆ›å»ºæ¡¥æ¥æ–‡ä»¶ï¼Œè¿™æ · Xcode ä¸­ Swift ç›¸å…³çš„ä¾èµ–é…ç½®æ‰èƒ½å¾—ä»¥å»ºç«‹ï¼š</p>

<p><img src="/img/2019/libraries_in_ios/7.png" alt="7" /></p>

<p>Swift é™æ€åº“ä¹Ÿå¯ä»¥è‡ªåŠ¨ç”Ÿæˆ <code>&lt;PROJECT_NAME&gt;-Swift.h</code>ï¼Œä½†å…¶å¹¶æ²¡æœ‰å’Œæœ€ç»ˆäº§ç‰© <code>.a</code> æ”¾ç½®åœ¨ä¸€èµ·ï¼š</p>

<pre><code class="language-shell">âœ  Build tree
.
â”œâ”€â”€ Intermediates.noindex
â”‚Â Â  â”œâ”€â”€ XCBuildData
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ BuildDescriptionCacheIndex-039e2a7cd1451855448cd617c2c79f0d
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ PIFCache
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ project
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ PROJECT@v8_mod=1568563268_hash=b6565d7e8bfe8171a813e95698ec414f-json
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ PROJECT@v8_mod=1568563366_hash=b6565d7e8bfe8171a813e95698ec414f-json
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ target
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â”œâ”€â”€ TARGET@v8_hash=9ED714DD9D72F2357197BC1BE00B9838-json
â”‚Â Â  â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ TARGET@v8_hash=B7634C70FA7FEB002C1D5B331F68AC57-json
â”‚Â Â  â”‚Â Â  â”‚Â Â  â””â”€â”€ workspace
â”‚Â Â  â”‚Â Â  â”‚Â Â      â”œâ”€â”€ WORKSPACE@v8_mod=1568563268_hash=039e2a7cd1451855448cd617c2c79f0d_subobjects=359C431B6A9412A0DAB608A7B5E1B797-json
â”‚Â Â  â”‚Â Â  â”‚Â Â      â””â”€â”€ WORKSPACE@v8_mod=1568563268_hash=039e2a7cd1451855448cd617c2c79f0d_subobjects=FD7A1155808C379D6684AA719075DE4E-json
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ a9f77306ac684b2857e1d38ab0444728-desc.xcbuild
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ a9f77306ac684b2857e1d38ab0444728-manifest.xcbuild
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ b87f53f8de8d4ad786bada5baea76917-desc.xcbuild
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ b87f53f8de8d4ad786bada5baea76917-manifest.xcbuild
â”‚Â Â  â”‚Â Â  â””â”€â”€ build.db
â”‚Â Â  â””â”€â”€ swift_static_lib.build
â”‚Â Â      â””â”€â”€ Debug-iphonesimulator
â”‚Â Â          â””â”€â”€ swift_static_lib.build
â”‚Â Â              â”œâ”€â”€ DerivedSources
â”‚Â Â              â”‚Â Â  â””â”€â”€ swift_static_lib-Swift.h â¬…ï¸
â”‚Â Â              â”œâ”€â”€ Objects-normal
â”‚Â Â              â”‚Â Â  â””â”€â”€ x86_64
â”‚Â Â              â”‚Â Â      â”œâ”€â”€ swift_static_lib-OutputFileMap.json
â”‚Â Â              â”‚Â Â      â”œâ”€â”€ swift_static_lib-Swift.h
â”‚Â Â              â”‚Â Â      â”œâ”€â”€ swift_static_lib-master.swiftdeps
â”‚Â Â              â”‚Â Â      â”œâ”€â”€ swift_static_lib-master.swiftdeps~
â”‚Â Â              â”‚Â Â      â”œâ”€â”€ swift_static_lib-master.swiftdeps~moduleonly
â”‚Â Â              â”‚Â Â      â”œâ”€â”€ swift_static_lib.LinkFileList
â”‚Â Â              â”‚Â Â      â”œâ”€â”€ swift_static_lib.d
â”‚Â Â              â”‚Â Â      â”œâ”€â”€ swift_static_lib.dia
â”‚Â Â              â”‚Â Â      â”œâ”€â”€ swift_static_lib.o
â”‚Â Â              â”‚Â Â      â”œâ”€â”€ swift_static_lib.swiftdeps
â”‚Â Â              â”‚Â Â      â”œâ”€â”€ swift_static_lib.swiftdeps~
â”‚Â Â              â”‚Â Â      â”œâ”€â”€ swift_static_lib.swiftdoc
â”‚Â Â              â”‚Â Â      â”œâ”€â”€ swift_static_lib.swiftmodule
â”‚Â Â              â”‚Â Â      â”œâ”€â”€ swift_static_lib~partial.swiftdoc
â”‚Â Â              â”‚Â Â      â””â”€â”€ swift_static_lib~partial.swiftmodule
â”‚Â Â              â”œâ”€â”€ Script-841C800C232E981E007DF25D.sh
â”‚Â Â              â”œâ”€â”€ all-product-headers.yaml
â”‚Â Â              â”œâ”€â”€ swift_static_lib-all-non-framework-target-headers.hmap
â”‚Â Â              â”œâ”€â”€ swift_static_lib-all-target-headers.hmap
â”‚Â Â              â”œâ”€â”€ swift_static_lib-generated-files.hmap
â”‚Â Â              â”œâ”€â”€ swift_static_lib-own-target-headers.hmap
â”‚Â Â              â”œâ”€â”€ swift_static_lib-project-headers.hmap
â”‚Â Â              â””â”€â”€ swift_static_lib.hmap
â””â”€â”€ Products
    â””â”€â”€ Debug-iphonesimulator
        â”œâ”€â”€ include
        â”‚Â Â  â””â”€â”€ swift_static_lib
        â”‚Â Â      â”œâ”€â”€ module.modulemap
        â”‚Â Â      â””â”€â”€ swift_static_lib-Swift.h
        â”œâ”€â”€ libswift_static_lib.a
        â””â”€â”€ swift_static_lib.swiftmodule
            â”œâ”€â”€ x86_64.swiftdoc
            â””â”€â”€ x86_64.swiftmodule

17 directories, 41 files
</code></pre>

<p>å› æ­¤æˆ‘ä»¬å¯ä»¥å°†ä»¥ä¸‹è„šæœ¬æ·»åŠ åˆ° Xcode - Targets - Build Phases - New Run Script Phase ä¸­ï¼Œè¿™æ ·æ¯æ¬¡æ„å»ºå³å¯å°† <code>&lt;PROJECT_NAME&gt;-Swift.h</code> ä¸€å¹¶ç”Ÿæˆï¼š</p>

<pre><code class="language-shell">// Powered by https://paul-samuels.com/blog/2018/01/14/swift-static-library-in-objective-c/

target_dir=${BUILT_PRODUCTS_DIR}/include/${PRODUCT_MODULE_NAME}/

# Ensure the target include path exists
mkdir -p ${target_dir}

# Copy any file that looks like a Swift generated header to the include path
cp ${DERIVED_SOURCES_DIR}/*-Swift.h ${target_dir}
</code></pre>

<p>ä¹‹åæˆ‘ä»¬éœ€è¦å°†ç”Ÿæˆçš„äº§ç‰©æ”¾ swift_static_lib æ–‡ä»¶ä¸­ä¸€èµ·æ‹–åˆ° Obj-C å·¥ç¨‹ä¸­ï¼ˆè¿™é‡Œå¯ä»¥åé€‰ã€ŒAdd to targetsã€é€‰é¡¹ï¼‰ï¼š</p>

<pre><code class="language-shell">âœ  swift_static_lib tree
.
â”œâ”€â”€ include
â”‚Â Â  â””â”€â”€ swift_static_lib
â”‚Â Â      â””â”€â”€ swift_static_lib-Swift.h
â”œâ”€â”€ libswift_static_lib.a
â””â”€â”€ swift_static_lib.swiftmodule
    â”œâ”€â”€ x86_64.swiftdoc
    â””â”€â”€ x86_64.swiftmodule

3 directories, 4 files
</code></pre>

<p>ä¹‹åæˆ‘ä»¬å°† <code>.a</code> æ‹–æ‹½åˆ° Xcode - General - Link Binary With Librariesï¼ˆæˆ– Xcode - Targets - Build Phases - Link Binary With Librariesï¼‰ä¸­ï¼š</p>

<p><img src="/img/2019/libraries_in_ios/5.png" alt="5" /></p>

<p>æœ€åå†å°† Xcode - Targets - Build Settings - Header Search Paths &amp; Library Search Paths æ·»åŠ ä¸Š <code>.a</code> çš„çˆ¶çº§è·¯å¾„ <code>$(PROJECT_DIR)/oc-demo-project/swift_static_lib</code> å³å¯ï¼š</p>

<p><img src="/img/2019/libraries_in_ios/6.png" alt="6" /></p>

<p>è¿™æ ·ï¼Œåœ¨ Obj-C å·¥ç¨‹ä¸­é€šè¿‡ <code>#import &quot;swift_static_lib-Swift.h&quot;</code> å³å¯ä½¿ç”¨åˆ° swift_static_lib ä¸­æš´éœ²ç»™ Obj-C çš„ç±»æˆ–å‡½æ•°ç­‰äº†ã€‚</p>

<h3 id="swift-å·¥ç¨‹å¼•å…¥-obj-c-é™æ€åº“">Swift å·¥ç¨‹å¼•å…¥ Obj-C é™æ€åº“</h3>

<p>å¦‚æœæƒ³è¦åœ¨ Swift å·¥ç¨‹ä¸­å¼•å…¥ Obj-C é™æ€åº“ï¼ˆæ³¨æ„å¦‚æœ‰åˆ†ç±»ä»éœ€åŠ  <code>-ObjC</code>ï¼‰ï¼Œåˆ™ä¹Ÿéœ€è¦æ¡¥æ¥å¤´æ–‡ä»¶çš„ä¸­ä»‹ã€‚æˆ‘ä»¬å°† oc-static-lib ç¼–è¯‘åçš„ <code>.a</code> ä¸ <code>.h</code> ä¸€èµ·æ‹–å…¥ Swift å·¥ç¨‹ï¼Œå¹¶åœ¨å·¥ç¨‹ä¸­å»ºç«‹ Obj-C ç±»ï¼ŒæŒ‰ Xcode æç¤ºåˆ›å»ºæ¡¥æ¥æ–‡ä»¶ï¼›åœ¨å¤´æ–‡ä»¶ä¸­å¼•å…¥ Obj-C é™æ€åº“å¤´æ–‡ä»¶å³å¯åœ¨ Swift ä¸­ä½¿ç”¨ï¼š</p>

<pre><code class="language-objectivec">// swift-demo-project-Bridging-Header.h

//
//  Use this file to import your target's public headers that you would like to expose to Swift.
//

#import &quot;liboc-static-lib/oc_static_lib.h&quot;
</code></pre>

<h2 id="cocoa-touch-framework">Cocoa Touch Framework</h2>

<p>Cocoa Touch Framework æ˜¯ Xcode ä¸­èƒ½å¤Ÿåˆ›å»ºçš„å¦å¤–ä¸€ç§æ¡†æ¶ï¼ˆFrameworkï¼‰ç±»å‹ï¼ˆæ³¨æ„ï¼Œåœ¨ Xcode 11 ä¸­ï¼Œè¿™é‡Œå·²ç»å˜æˆ Framework ä¸ Libraryï¼Œæ›´åŠ æ¸…æ™°ï¼‰ï¼Œè€Œéåº“ï¼ˆLibraryï¼‰ã€‚ä¸åŒäºåº“ï¼ŒiOS ä¸­çš„æ¡†æ¶æŒ‡çš„æ˜¯åŒ…å«èµ„æºï¼ˆæ¯”å¦‚å›¾ç‰‡ã€æœ¬åœ°åŒ–æ–‡ä»¶ã€Storyboard ç­‰ï¼‰ã€å¤´æ–‡ä»¶ã€ä»¥åŠç¼–è¯‘åçš„äºŒè¿›åˆ¶ç­‰çš„é›†åˆã€‚æ¡†æ¶çš„åç¼€åæ˜¯ <code>.framework</code>ï¼Œå¹¶å¯ä»¥é€šè¿‡ <code>NSBundle</code> API è®¿é—®ï¼Œä¸åŒçš„æ˜¯æ¡†æ¶å¯ä»¥ç›´æ¥å¯¼èˆªåˆ°å…¶ä¸­çš„ç›®å½•å†…å®¹ï¼Œä¾¿äºå¼€å‘è€…æŸ¥çœ‹ï¼š</p>

<pre><code class="language-shell">âœ  oc_framework.framework tree
.
â”œâ”€â”€ Assets.car â¡ï¸ å·¥ç¨‹ä¸­çš„ xcassets èµ„æºå°†è¢«å‹ç¼©ä¸º car
â”œâ”€â”€ Headers
â”‚Â Â  â”œâ”€â”€ NSObject+OC_Framework.h
â”‚Â Â  â”œâ”€â”€ OC_Foo.h
â”‚Â Â  â”œâ”€â”€ PublicHeader.h
â”‚Â Â  â””â”€â”€ oc_framework.h
â”œâ”€â”€ Info.plist
â”œâ”€â”€ Modules
â”‚Â Â  â””â”€â”€ module.modulemap ğŸŒŸ
â”œâ”€â”€ _CodeSignature
â”‚Â Â  â””â”€â”€ CodeResources
â””â”€â”€ oc_framework

3 directories, 9 files

âœ  swift_framework.framework tree
.
â”œâ”€â”€ Headers
â”‚Â Â  â”œâ”€â”€ swift_framework-Swift.h â¡ï¸ è‡ªåŠ¨ç”Ÿæˆçš„ *-Swift.h ä¾¿äº Obj-C å·¥ç¨‹ä½¿ç”¨
â”‚Â Â  â””â”€â”€ swift_framework.h
â”œâ”€â”€ Info.plist
â”œâ”€â”€ Modules
â”‚Â Â  â”œâ”€â”€ module.modulemap ğŸŒŸ
â”‚Â Â  â””â”€â”€ swift_framework.swiftmodule â¡ï¸ ç±»ä¼¼ Swift é™æ€åº“
â”‚Â Â      â”œâ”€â”€ x86_64.swiftdoc
â”‚Â Â      â””â”€â”€ x86_64.swiftmodule
â”œâ”€â”€ _CodeSignature
â”‚Â Â  â””â”€â”€ CodeResources
â”œâ”€â”€ eng.strings â¡ï¸ å·¥ç¨‹ä¸­çš„ strings èµ„æº
â””â”€â”€ swift_framework

4 directories, 9 files
</code></pre>

<p>Framework ä¸­ç¼–è¯‘åçš„ Mach-O å¯ä»¥æ ¹æ®éœ€è¦ä½œä¸ºåŠ¨æ€åº“ã€é™æ€åº“ï¼ˆæ³¨æ„å¦‚æœ‰åˆ†ç±»ä»éœ€åŠ  <code>-ObjC</code>ï¼‰ã€æˆ–è€…å¯æ‰§è¡Œæ–‡ä»¶ç­‰ï¼š</p>

<p><img src="/img/2019/libraries_in_ios/8.png" alt="8" /></p>

<p>Framework ä¸­éœ€è¦æš´éœ²åœ¨å¤–ç•Œçš„å¤´æ–‡ä»¶ï¼Œéœ€è¦åœ¨ Xcode - Targets - Build Phases - Headers - Public ä¸­å…¬å¼€ï¼ˆSwift Framework ä¸­çš„ <code>*-Swift.h</code> åˆ™ä¸éœ€è¦æ‰‹åŠ¨ç§»åŠ¨ï¼‰ï¼›èµ„æºæ–‡ä»¶åˆ™éœ€è¦åŠ å…¥ Copy Bundle Resources ä¸­ï¼ˆä½¿ç”¨æ—¶é€šè¿‡ <code>NSBunlde</code> APIï¼‰ï¼š</p>

<p><img src="/img/2019/libraries_in_ios/10.png" alt="10" /></p>

<h3 id="obj-c-å·¥ç¨‹">Obj-C å·¥ç¨‹</h3>

<p>åœ¨ Obj-C å·¥ç¨‹ä¸­ï¼Œåªéœ€è¦å°† Framework äº§ç‰©æ‹–å…¥å¹¶åœ¨ Xcode - Targets - General - Embedded Binaries &amp; Links Framework and Libraries ä¸­æ·»åŠ å³å¯ï¼š</p>

<p><img src="/img/2019/libraries_in_ios/9.png" alt="9" /></p>

<p>åœ¨å·¥ç¨‹ä¸­æˆ‘ä»¬å°±å¯ä»¥å°†å…¶å¼•å…¥å¹¶ä½¿ç”¨äº†ï¼š</p>

<ul>
<li>oc-framework:</li>
</ul>

<hr />

<pre><code class="language-objectivec">// OC_Foo.m

#import &quot;OC_Foo.h&quot;

@implementation OC_Foo

- (void)foo {
    NSLog(@&quot;%@ - %@&quot;, NSStringFromClass([self class]), NSStringFromSelector(_cmd));
}

- (UIImage *)image {
    // é€šè¿‡ NSBundle è·å–èµ„æº
    NSBundle *bundle = [NSBundle bundleForClass:[self class]];
    return [UIImage imageNamed:@&quot;icon&quot; inBundle:bundle compatibleWithTraitCollection:nil];
}

@end
</code></pre>

<ul>
<li>swift-framework:</li>
</ul>

<hr />

<pre><code class="language-swift">// Swift_Foo.swift

import Foundation

@objc public class Swift_Foo : NSObject {
    @objc public func foo() {
        print(&quot;Swift_Foo - \(#function)&quot;)
    }

    @objc public func strings() -&gt; String {
        let bundle = Bundle(for: Swift_Foo.self)
        return NSLocalizedString(&quot;demo-string&quot;, bundle: bundle, comment: &quot;A demo string.&quot;)
    }
}
</code></pre>

<ul>
<li>Obj-C å·¥ç¨‹ï¼š</li>
</ul>

<hr />

<pre><code class="language-objectivec">// ViewController.m

#import &quot;ViewController.h&quot;
@import oc_framework;
//#import &quot;oc_framework/oc_framework.h&quot;
//#import &lt;oc_framework/oc_framework.h&gt;
//#import &lt;oc_framework/PublicHeader.h&gt;
//#import &lt;oc_framework/OC_Foo.h&gt;

@import swift_framework;
//#import &quot;swift_framework/swift_framework.h&quot;
//#import &quot;swift_framework/swift_framework-Swift.h&quot;
//#import &lt;swift_framework/swift_framework.h&gt;
//#import &lt;swift_framework/swift_framework-Swift.h&gt;

@interface ViewController ()
@property (weak, nonatomic) IBOutlet UIImageView *imageView;

@end

@implementation ViewController

- (void)viewDidLoad {
    [super viewDidLoad];
    // Do any additional setup after loading the view.

    OC_Foo *foo = [OC_Foo new];
    [foo foo];

    self.imageView.image = [foo image];

    Swift_Foo *sFoo = [[Swift_Foo alloc] init];
    [sFoo foo];

    NSLog(@&quot;%@&quot;, [sFoo strings]);
}

@end
</code></pre>

<h3 id="swift-å·¥ç¨‹">Swift å·¥ç¨‹</h3>

<p>Framework çš„å¼•å…¥è¦æ¯”é™æ€åº“ç®€å•è®¸å¤šï¼Œæˆ‘ä»¬åªéœ€è¦å°†å…¶ç›´æ¥å¼•å…¥å·¥ç¨‹ä¸­ï¼ˆæ³¨æ„å¦‚æœ‰åˆ†ç±»ä»éœ€åŠ  <code>-ObjC</code>ï¼‰ï¼Œå¹¶åœ¨ Swift é€šè¿‡ <code>import &lt;FRAMEWORK_NAME&gt;</code> å¯¼å…¥å³å¯ï¼š</p>

<pre><code class="language-swift">import UIKit
import oc_framework
import swift_framework

class ViewController: UIViewController {
    @IBOutlet weak var imageView: UIImageView!

    override func viewDidLoad() {
        super.viewDidLoad()
        // Do any additional setup after loading the view.

        let foo = OC_Foo()
        foo.foo()
        // âš ï¸ æ³¨æ„ï¼Œæ¯”è¾ƒå¥‡æ€ªçš„æ˜¯ï¼š
        // åªæœ‰å½“ Obj-C Framework çš„ Mach-O ç±»å‹ä¸ºåŠ¨æ€åº“æ—¶ï¼Œä»¥ä¸‹çš„èµ„æºæ‰æœ‰æ•ˆ
        imageView.image = foo.image()

        let sFoo = Swift_Foo()
        sFoo.foo()
        print(sFoo.strings())
    }
}
</code></pre>

<h3 id="aggregate-target">Aggregate Target</h3>

<p><img src="/img/2019/libraries_in_ios/11.png" alt="11" /></p>

<p>å…³äº Aggregate Targetï¼Œå®˜æ–¹æä¾›çš„å¯å‚è€ƒèµ„æ–™å¾ˆå°‘ã€‚è€ç‰ˆæœ¬çš„ Xcode ä¸­æè¿°ä¸ºã€ŒThis target is used to aggregate other targets togetherã€ï¼Œå³ aggregate æœ¬èº«å…·æœ‰èšåˆã€æ€»è®¡ä¹‹æ„ï¼Œè€Œ Aggregate Target æ­£æ˜¯ç”¨äºèšåˆå…¶å®ƒ Targetï¼Œä½¿å¾—å¯ä»¥åœ¨ Xcode ä¸­è¾¾åˆ°ä¸€æ¬¡æ€§æ„å»ºå¤šä¸ª Target çš„ç›®çš„ã€‚</p>

<h2 id="cocoapods">CocoaPods</h2>

<p>CocoaPods æ˜¯ iOS/macOS å¼€å‘çš„è€ç‰Œæ­æ¡£ã€‚</p>

<h3 id="é-use-framework">é <code>use_framework</code></h3>

<p>CocoaPods ç°åœ¨é»˜è®¤å¼€å¯äº† <code>use_framework</code> é€‰é¡¹ï¼Œå³ä½¿ç”¨ Framework æ–¹å¼é›†æˆï¼Œæˆ‘ä»¬å°†å…¶æ³¨é‡Šï¼Œå…ˆæ¥çœ‹ä¸‹é <code>use_framework</code> çš„æƒ…å†µã€‚æ­¤æ—¶æˆ‘ä»¬å®šä¹‰åœ¨ Podfile ä¸­çš„ç›¸å…³ä¾èµ–å°†ä½œä¸ºç±»ä¼¼ä¸Šæ–‡ä¸­ Cocoa Touch Static Library ä¸€æ ·çš„ Target è¢« Pods å·¥ç¨‹è‡ªèº«ä¾èµ–ï¼š</p>

<p><img src="/img/2019/libraries_in_ios/13.png" alt="13" /></p>

<p>Pods å·¥ç¨‹ä¹Ÿå°†ä½œä¸ºä¸­ä»‹è¢«æ‰“åŒ…ä¸º <code>.a</code> è¢«ä¸»å·¥ç¨‹ä¾èµ–ï¼š</p>

<p><img src="/img/2019/libraries_in_ios/12.png" alt="12" /></p>

<p>å¦‚å‰æ–‡æ‰€è¿°ï¼Œ<code>.a</code> ä»…ä»…åŒ…å«äº†ç¼–è¯‘åçš„ä»£ç ï¼Œé‚£ä¹ˆå®ƒæ‰€ä»¥ä¾èµ–çš„èµ„æºæ–‡ä»¶å°†å¦‚ä½•å¤„ç†å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸Šå›¾ä¸­çš„ã€Œ[CP] Copy Pods Resourecesã€ï¼Œæ‰§è¡Œäº†å¦‚ä¸‹çš„è„šæœ¬ï¼š</p>

<pre><code class="language-shell">#!/bin/sh
set -e
set -u
set -o pipefail  # è®¾ç½®

function on_error {
  echo &quot;$(realpath -mq &quot;${0}&quot;):$1: error: Unexpected failure&quot;
}
trap 'on_error $LINENO' ERR

# if [ -z #{STR} ]; å¦‚æœ STR é•¿åº¦ä¸º 0 åˆ™çœŸ
# UNLOCALIZED_RESOURCES_FOLDER_PATHï¼ˆapp åï¼‰ï¼šoc-demo-project.app
if [ -z ${UNLOCALIZED_RESOURCES_FOLDER_PATH+x} ]; then
  # If UNLOCALIZED_RESOURCES_FOLDER_PATH is not set, then there's nowhere for us to copy
  # resources to, so exit 0 (signalling the script phase was successful).
  exit 0
fi

# TARGET_BUILD_DIRï¼ˆç›®æ ‡æ„å»ºç›®å½•ï¼‰ï¼š/Users/kingcos/Library/Developer/Xcode/DerivedData/oc-demo-project-fvrppqpxzudpvicewkjnbszgmrll/Build/Products/Debug-iphonesimulator
# ä¸ç®¡æ–‡ä»¶å¤¹æ˜¯å¦å­˜åœ¨ï¼Œå°è¯•åˆ›å»º
mkdir -p &quot;${TARGET_BUILD_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH}&quot;

# RESOURCES_TO_COPYï¼ˆæ¬²æ‹·è´èµ„æºè®°å½•ï¼Œä¸´æ—¶æ–‡ä»¶ï¼‰ï¼šoc-demo-project/Pods/resources-to-copy-oc-demo-project.txt
RESOURCES_TO_COPY=${PODS_ROOT}/resources-to-copy-${TARGETNAME}.txt
# åˆ›å»ºè¯¥æ–‡ä»¶
&gt; &quot;$RESOURCES_TO_COPY&quot;

XCASSET_FILES=()

# é˜²æ­¢å¤šä¸ª target åŒæ—¶æ‹·è´ç›¸åŒçš„æ¡†æ¶ä¾èµ–
# This protects against multiple targets copying the same framework dependency at the same time. The solution
# was originally proposed here: https://lists.samba.org/archive/rsync/2008-February/020158.html
RSYNC_PROTECT_TMP_FILES=(--filter &quot;P .*.??????&quot;)

# TARGETED_DEVICE_FAMILYï¼ˆç›®æ ‡è®¾å¤‡å®¶æ—ï¼‰ï¼š1,2ï¼ˆiPhone &amp; iPadï¼‰
case &quot;${TARGETED_DEVICE_FAMILY:-}&quot; in
  1,2)
    TARGET_DEVICE_ARGS=&quot;--target-device ipad --target-device iphone&quot;
    ;;
  1)
    TARGET_DEVICE_ARGS=&quot;--target-device iphone&quot;
    ;;
  2)
    TARGET_DEVICE_ARGS=&quot;--target-device ipad&quot;
    ;;
  3)
    TARGET_DEVICE_ARGS=&quot;--target-device tv&quot;
    ;;
  4)
    TARGET_DEVICE_ARGS=&quot;--target-device watch&quot;
    ;;
  *)
    TARGET_DEVICE_ARGS=&quot;--target-device mac&quot;
    ;;
esac

# å®‰è£…èµ„æºå‡½æ•°
install_resource()
{
  if [[ &quot;$1&quot; = /* ]] ; then
    RESOURCE_PATH=&quot;$1&quot;
  else
    RESOURCE_PATH=&quot;${PODS_ROOT}/$1&quot;
  fi
  if [[ ! -e &quot;$RESOURCE_PATH&quot; ]] ; then
    cat &lt;&lt; EOM
error: Resource &quot;$RESOURCE_PATH&quot; not found. Run 'pod install' to update the copy resources script.
EOM
    exit 1
  fi
  case $RESOURCE_PATH in
    *.storyboard)
      echo &quot;ibtool --reference-external-strings-file --errors --warnings --notices --minimum-deployment-target ${!DEPLOYMENT_TARGET_SETTING_NAME} --output-format human-readable-text --compile ${TARGET_BUILD_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH}/`basename \&quot;$RESOURCE_PATH\&quot; .storyboard`.storyboardc $RESOURCE_PATH --sdk ${SDKROOT} ${TARGET_DEVICE_ARGS}&quot; || true
      ibtool --reference-external-strings-file --errors --warnings --notices --minimum-deployment-target ${!DEPLOYMENT_TARGET_SETTING_NAME} --output-format human-readable-text --compile &quot;${TARGET_BUILD_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH}/`basename \&quot;$RESOURCE_PATH\&quot; .storyboard`.storyboardc&quot; &quot;$RESOURCE_PATH&quot; --sdk &quot;${SDKROOT}&quot; ${TARGET_DEVICE_ARGS}
      ;;
    *.xib)
      echo &quot;ibtool --reference-external-strings-file --errors --warnings --notices --minimum-deployment-target ${!DEPLOYMENT_TARGET_SETTING_NAME} --output-format human-readable-text --compile ${TARGET_BUILD_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH}/`basename \&quot;$RESOURCE_PATH\&quot; .xib`.nib $RESOURCE_PATH --sdk ${SDKROOT} ${TARGET_DEVICE_ARGS}&quot; || true
      ibtool --reference-external-strings-file --errors --warnings --notices --minimum-deployment-target ${!DEPLOYMENT_TARGET_SETTING_NAME} --output-format human-readable-text --compile &quot;${TARGET_BUILD_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH}/`basename \&quot;$RESOURCE_PATH\&quot; .xib`.nib&quot; &quot;$RESOURCE_PATH&quot; --sdk &quot;${SDKROOT}&quot; ${TARGET_DEVICE_ARGS}
      ;;
    *.framework)
      echo &quot;mkdir -p ${TARGET_BUILD_DIR}/${FRAMEWORKS_FOLDER_PATH}&quot; || true
      mkdir -p &quot;${TARGET_BUILD_DIR}/${FRAMEWORKS_FOLDER_PATH}&quot;
      echo &quot;rsync --delete -av &quot;${RSYNC_PROTECT_TMP_FILES[@]}&quot; $RESOURCE_PATH ${TARGET_BUILD_DIR}/${FRAMEWORKS_FOLDER_PATH}&quot; || true
      rsync --delete -av &quot;${RSYNC_PROTECT_TMP_FILES[@]}&quot; &quot;$RESOURCE_PATH&quot; &quot;${TARGET_BUILD_DIR}/${FRAMEWORKS_FOLDER_PATH}&quot;
      ;;
    *.xcdatamodel)
      echo &quot;xcrun momc \&quot;$RESOURCE_PATH\&quot; \&quot;${TARGET_BUILD_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH}/`basename &quot;$RESOURCE_PATH&quot;`.mom\&quot;&quot; || true
      xcrun momc &quot;$RESOURCE_PATH&quot; &quot;${TARGET_BUILD_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH}/`basename &quot;$RESOURCE_PATH&quot; .xcdatamodel`.mom&quot;
      ;;
    *.xcdatamodeld)
      echo &quot;xcrun momc \&quot;$RESOURCE_PATH\&quot; \&quot;${TARGET_BUILD_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH}/`basename &quot;$RESOURCE_PATH&quot; .xcdatamodeld`.momd\&quot;&quot; || true
      xcrun momc &quot;$RESOURCE_PATH&quot; &quot;${TARGET_BUILD_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH}/`basename &quot;$RESOURCE_PATH&quot; .xcdatamodeld`.momd&quot;
      ;;
    *.xcmappingmodel)
      echo &quot;xcrun mapc \&quot;$RESOURCE_PATH\&quot; \&quot;${TARGET_BUILD_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH}/`basename &quot;$RESOURCE_PATH&quot; .xcmappingmodel`.cdm\&quot;&quot; || true
      xcrun mapc &quot;$RESOURCE_PATH&quot; &quot;${TARGET_BUILD_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH}/`basename &quot;$RESOURCE_PATH&quot; .xcmappingmodel`.cdm&quot;
      ;;
    *.xcassets)
      ABSOLUTE_XCASSET_FILE=&quot;$RESOURCE_PATH&quot;
      XCASSET_FILES+=(&quot;$ABSOLUTE_XCASSET_FILE&quot;)
      ;;
    *)
      echo &quot;$RESOURCE_PATH&quot; || true
      echo &quot;$RESOURCE_PATH&quot; &gt;&gt; &quot;$RESOURCES_TO_COPY&quot;
      ;;
  esac
}

# CONFIGURATIONï¼šè¿è¡Œçš„ scheme é…ç½®æ¨¡å¼ï¼ŒDebug æˆ– Release
if [[ &quot;$CONFIGURATION&quot; == &quot;Debug&quot; ]]; then
  install_resource &quot;${PODS_ROOT}/MJRefresh/MJRefresh/MJRefresh.bundle&quot;
fi
if [[ &quot;$CONFIGURATION&quot; == &quot;Release&quot; ]]; then
  install_resource &quot;${PODS_ROOT}/MJRefresh/MJRefresh/MJRefresh.bundle&quot;
fi

mkdir -p &quot;${TARGET_BUILD_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH}&quot;
rsync -avr --copy-links --no-relative --exclude '*/.svn/*' --files-from=&quot;$RESOURCES_TO_COPY&quot; / &quot;${TARGET_BUILD_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH}&quot;
if [[ &quot;${ACTION}&quot; == &quot;install&quot; ]] &amp;&amp; [[ &quot;${SKIP_INSTALL}&quot; == &quot;NO&quot; ]]; then
  mkdir -p &quot;${INSTALL_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH}&quot;
  rsync -avr --copy-links --no-relative --exclude '*/.svn/*' --files-from=&quot;$RESOURCES_TO_COPY&quot; / &quot;${INSTALL_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH}&quot;
fi
rm -f &quot;$RESOURCES_TO_COPY&quot;

if [[ -n &quot;${WRAPPER_EXTENSION}&quot; ]] &amp;&amp; [ &quot;`xcrun --find actool`&quot; ] &amp;&amp; [ -n &quot;${XCASSET_FILES:-}&quot; ]
then
  # Find all other xcassets (this unfortunately includes those of path pods and other targets).
  OTHER_XCASSETS=$(find &quot;$PWD&quot; -iname &quot;*.xcassets&quot; -type d)
  while read line; do
    if [[ $line != &quot;${PODS_ROOT}*&quot; ]]; then
      XCASSET_FILES+=(&quot;$line&quot;)
    fi
  done &lt;&lt;&lt;&quot;$OTHER_XCASSETS&quot;

  if [ -z ${ASSETCATALOG_COMPILER_APPICON_NAME+x} ]; then
    printf &quot;%s\0&quot; &quot;${XCASSET_FILES[@]}&quot; | xargs -0 xcrun actool --output-format human-readable-text --notices --warnings --platform &quot;${PLATFORM_NAME}&quot; --minimum-deployment-target &quot;${!DEPLOYMENT_TARGET_SETTING_NAME}&quot; ${TARGET_DEVICE_ARGS} --compress-pngs --compile &quot;${BUILT_PRODUCTS_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH}&quot;
  else
    printf &quot;%s\0&quot; &quot;${XCASSET_FILES[@]}&quot; | xargs -0 xcrun actool --output-format human-readable-text --notices --warnings --platform &quot;${PLATFORM_NAME}&quot; --minimum-deployment-target &quot;${!DEPLOYMENT_TARGET_SETTING_NAME}&quot; ${TARGET_DEVICE_ARGS} --compress-pngs --compile &quot;${BUILT_PRODUCTS_DIR}/${UNLOCALIZED_RESOURCES_FOLDER_PATH}&quot; --app-icon &quot;${ASSETCATALOG_COMPILER_APPICON_NAME}&quot; --output-partial-info-plist &quot;${TARGET_TEMP_DIR}/assetcatalog_generated_info_cocoapods.plist&quot;
  fi
fi
</code></pre>

<h3 id="use-framework">use_framework</h3>

<ul class="task-list">
<li>TODO:</li>
<li><label><input type="checkbox" disabled class="task-list-item"> @import</label></li>
<li><label><input type="checkbox" disabled class="task-list-item"> Module Map</label></li>
</ul>

<h2 id="reference">Reference</h2>

<!-- - [Linkers and Loaders](https://book.douban.com/subject/1436811/) -->

<ul>
<li><a href="../../2018/dyld_shared_cache/">è°ˆè°ˆ iOS ä¸­çš„ dyld_shared_cache - kingcos</a></li>
<li><a href="/posts/2019/+load_in_ios/">iOS ä¸­çš„ +load æ–¹æ³• - kingcos</a></li>
<li><a href="https://forums.swift.org/t/whats-in-the-file-of-swiftmodule-how-to-open-it/1032">whatâ€™s in the file of .swiftmodule?how to open it?</a></li>
<li><a href="https://forums.swift.org/t/looking-for-documentation-insight-on-swiftdoc/6869">Looking for documentation/insight on .swiftdoc</a></li>
<li><a href="https://forums.swift.org/t/swift-static-libraries-dont-copy-generated-objective-c-header/19816">Swift static libraries donâ€™t copy generated Objective-C header</a></li>
<li><a href="https://stackoverflow.com/questions/29580438/use-swift-library-in-objc">Use Swift Library in ObjC - StackOverflow</a></li>
<li><a href="https://paul-samuels.com/blog/2018/01/14/swift-static-library-in-objective-c/">Swift static library in Objective-C - Paul Samuels</a></li>
<li><a href="https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPFrameworks/Frameworks.html">Framework Programming Guide - Apple</a></li>
<li><a href="https://developer.apple.com/library/archive/documentation/CoreFoundation/Conceptual/CFBundles/BundleTypes/BundleTypes.html">Bundle Programming Guide - Apple</a></li>
<li><a href="https://developer.apple.com/library/archive/technotes/tn2435/_index.html">Technical Note TN2435 - Embedding Frameworks In An App - Apple</a></li>
<li><a href="https://www.raywenderlich.com/2430-how-to-create-a-framework-for-ios">How to Create a Framework for iOS - Ray Wenderlich</a></li>
</ul>

    </div>
    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h">Read other posts</span>
          <hr />
        </div>
        <div class="pagination__buttons">
          
          
            <span class="button next">
              <a href="/posts/2019/&#43;load_in_ios/">
                <span class="button__text">iOS ä¸­çš„ &#43;load æ–¹æ³•</span>
                <span class="button__icon">â†’</span>
              </a>
            </span>
          
        </div>
      </div>
    

    

    
    
    <div>
      <div id="github-comment">
      </div>

      <script type="text/javascript">
        function getUtterances(isDark) {
          var utterances = document.createElement('script');
          utterances.type = 'text/javascript';
          utterances.async = true;
          utterances.setAttribute('issue-term', "pathname")
          utterances.setAttribute('repo', "kingcos\/kingcos.github.io")
          utterances.setAttribute('label', "comments")
          isDark ? utterances.setAttribute('theme', "github-dark") : utterances.setAttribute('theme', "github-light")
          utterances.crossorigin = 'anonymous';
          utterances.src = 'https://utteranc.es/client.js';

          return utterances
        }

        var themeToggle = document.querySelector(".theme-toggle")
        themeToggle.addEventListener("click", function () {
          var getTheme = window.localStorage && window.localStorage.getItem("theme")
          var divNode = document.getElementById('github-comment')
          while(divNode.hasChildNodes()) {
            divNode.removeChild(divNode.firstChild);
          }
          
          
          

          
          
          
          
          
          
          document.getElementById('github-comment').appendChild(getUtterances(getTheme !== "dark"))
        })

        var getTheme = window.localStorage && window.localStorage.getItem("theme")
        document.getElementById('github-comment').appendChild(getUtterances(getTheme === "dark"))
      </script>
    </div>
    

    </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">Powered by github.com/kingcos</div>
    
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>


      
    </div>

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-138311951-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
  </body>
</html>
