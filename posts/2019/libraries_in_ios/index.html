<!DOCTYPE html>
<html lang="en">
  <head>
    
      <title>iOS ä¸­çš„åº“ä¸æ¡†æ¶ :: iBlog</title>
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Date Notes     2019-09-14 é¦–æ¬¡æäº¤ï¼ŒæŒç»­æ›´æ–°å®Œå–„   2019-09-22 é€‚é… Xcode 11ï¼ŒæŒç»­æ›´æ–°å®Œå–„   2019-10-29 æ·»åŠ  Demoï¼šlibraries_in_ios-demo    Preface éšç€è½¯ä»¶å·¥ç¨‹çš„å‘å±•ï¼Œå¾ˆå¤šæˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½å‰äººéƒ½å·²ç»å¾ˆå¥½åœ°å®ç°äº†ï¼Œä¸ºäº†æé«˜æ•ˆç‡é¿å…é‡å¤å»ºè®¾ï¼Œè¿™äº›åŠŸèƒ½å®ç°çš„ä»£ç è¢«å°è£…ä¸ºä»£ç åº“ï¼Œæœ‰æ—¶ä¹Ÿç§°æ¡†æ¶ã€‚æˆ‘ä»¬åªéœ€è¦åœ¨ç”¨åˆ°çš„æ—¶å€™é€šè¿‡ä¾èµ–ç®¡ç†å·¥å…·å°†å®ƒä»¬ä»¥é€‚å½“çš„æ–¹å¼å¼•å…¥å³å¯ã€‚æœ¬æ–‡å°†ç®€å•èŠèŠ iOS ä¸­çš„åº“ä¸æ¡†æ¶ç›¸å…³æ¦‚å¿µã€‚
åŸºæœ¬æ¦‚å¿µ åœ¨åˆ‡å…¥æ­£é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥è¾¾æˆä¸€äº›å…±è¯†ã€‚
ä¸ç®¡æ˜¯è€æ´¾ Obj-C è¿˜æ˜¯æ–°ç§€ Swiftï¼Œå®ƒä»¬çš„æœ¬è´¨éƒ½æ˜¯ç¼–è¯‘å‹è¯­è¨€ã€‚å¯¹äºç¼–è¯‘å‹è¯­è¨€ï¼Œæºä»£ç ä¼šé¦–å…ˆç»ç”±ç¼–è¯‘å™¨ç¼–è¯‘ä¸ºç›®æ ‡æ–‡ä»¶ï¼Œé“¾æ¥å™¨å†å°†å¤šä¸ªç›®æ ‡æ–‡ä»¶é“¾æ¥ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ã€‚é’ˆå¯¹é“¾æ¥é˜¶æ®µï¼Œä¸»è¦åˆ†ä¸ºé™æ€é“¾æ¥ä¸åŠ¨æ€é“¾æ¥ã€‚
é™æ€ï¼Œå³ Staticã€‚æŒ‰ç…§å­—é¢æ„æ€ï¼Œé™æ€å³ä¸€æ—¦ç¡®å®šï¼Œå°±ä¸å†å®¹æ˜“æ”¹å˜ã€‚é™æ€é“¾æ¥ï¼Œå³åœ¨é“¾æ¥é˜¶æ®µï¼Œç›´æ¥å°†å¤šä¸ªç›®æ ‡æ–‡ä»¶é“¾æ¥ä¸ºä¸€ä¸ªæ–‡ä»¶ã€‚è€Œé™æ€åº“å°±å¯ä»¥ç†è§£ä¸ºå…±åŒç¼–è¯‘ä¸ºä¸€ä¸ªç›®æ ‡æ–‡ä»¶çš„æºä»£ç é›†åˆã€‚
åŠ¨æ€ï¼Œå³ Dynamicã€‚æŒ‰ç…§å­—é¢æ„æ€ï¼ŒåŠ¨æ€å³æ¨è¿Ÿåˆ°è¿è¡Œæ—¶åŠ¨æ€åœ°å†³è®®ã€‚åŠ¨æ€é“¾æ¥ï¼Œå³åœ¨è¿è¡Œæ—¶æ‰å°†å„ä¸ªéƒ¨åˆ†ç»„åˆå½¢æˆå®Œæ•´çš„ç¨‹åºã€‚è€ŒåŠ¨æ€åº“å°±å¯ä»¥ç†è§£ä¸ºæ”¯æŒåŠ¨æ€é“¾æ¥æ–¹å¼çš„æºä»£ç é›†åˆã€‚
é™æ€é“¾æ¥çš„å¥½å¤„æ˜¯ï¼Œè¿è¡Œæ—¶ä¸å†é¢å¤–éœ€è¦æ—¶é—´åŠ¨æ€é“¾æ¥ï¼›åå¤„åˆ™æ˜¯ç”±äºé“¾æ¥çš„ç²’åº¦æ˜¯ç›®æ ‡æ–‡ä»¶ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šé“¾æ¥äº†æ²¡æœ‰ä½¿ç”¨åˆ°çš„å‡½æ•°ï¼Œä¼šé€ æˆå¯æ‰§è¡Œæ–‡ä»¶è¿‡å¤§ï¼›è€Œä¸”å½“æŸä¸€ä¸ªç›®æ ‡æ–‡ä»¶çš„æºä»£ç æ”¹åŠ¨æ—¶ï¼Œé‚£ä¹ˆæ‰€æœ‰ä¾èµ–è¯¥ç›®æ ‡æ–‡ä»¶çš„é™æ€åº“éƒ½éœ€è¦é‡æ–°ç¼–è¯‘ï¼›åŠ¨æ€é“¾æ¥åˆ™è§£å†³äº†é™æ€é“¾æ¥çš„ç©ºé—´æµªè´¹ä¸é‡å¤ç¼–è¯‘é—®é¢˜ï¼Œæ¯”å¦‚åœ¨ iOS ä¸­ï¼Œç³»ç»Ÿåº“é‡‡ç”¨äº† dyld_shared_cache åŠ¨æ€é“¾æ¥ï¼Œè¿™æ ·å…¶å®ƒç¨‹åºå°±æ— éœ€å†å°†ç³»ç»Ÿåº“é‡å¤é“¾æ¥ï¼Œå½“ iOS ç³»ç»Ÿæ›´æ–°æ—¶ä¹Ÿæ— éœ€å°†æ‰€æœ‰ app é‡æ–°ç¼–è¯‘ã€‚è€Œåœ¨ç§»åŠ¨ç«¯å¼€å‘ä¸­ï¼Œapp çš„å¯åŠ¨æ—¶é—´ä¸åŒ…ä½“ç§¯å¤§å°å°†æ˜¯ä¸€ä¸ªæƒè¡¡é—®é¢˜ï¼Œå€¼å¾—æˆ‘ä»¬ä¾§é‡ä¸è€ƒé‡ã€‚
å¦å¤–ï¼Œè™½ç„¶å¹¿ä¹‰ä¸Šçš„åº“ï¼ˆLibraryï¼‰ä¸æ¡†æ¶ï¼ˆFrameworkï¼‰å«ä¹‰æ˜¯ç±»ä¼¼çš„ï¼Œä½†åœ¨ iOS å¼€å‘ä¸­ï¼Œå®˜æ–¹å°†è¿™ä¸¤ä¸ªæ¦‚å¿µè¿›è¡Œäº†åŒºåˆ†ï¼Œå› æ­¤ä¸‹æ–‡ä¸­æˆ‘ä»¬ä¼šæ˜ç¡®ä¸¤ä¸ªè¯çš„ä½¿ç”¨ã€‚
Cocoa Touch Static Library æˆ‘ä»¬å…ˆä» Xcode ä¸­èƒ½å¤Ÿç›´æ¥åˆ›å»ºçš„ Cocoa Touch Static Library è¯´èµ·ï¼ˆæ³¨æ„ï¼Œåœ¨ Xcode 11 ä¸­ï¼Œè¿™é‡Œå·²ç»å˜æˆ Framework ä¸ Libraryï¼Œæ›´åŠ æ¸…æ™°ï¼‰ï¼š"/>
<meta name="keywords" content="ios,static,library,framework,objc,objectivec,objective-c,swift,dev,develop,é™æ€åº“,é™æ€åº“,æ¡†æ¶"/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="/posts/2019/libraries_in_ios/" />





<link rel="stylesheet" href="/assets/style.css">


<link rel="stylesheet" href="/style.css">


<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">
<link rel="shortcut icon" href="/img/favicon.png">


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="iOS ä¸­çš„åº“ä¸æ¡†æ¶"/>
<meta name="twitter:description" content="éšç€è½¯ä»¶å·¥ç¨‹çš„å‘å±•ï¼Œå¾ˆå¤šæˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½å‰äººéƒ½å·²ç»å¾ˆå¥½åœ°å®ç°äº†ï¼Œä¸ºäº†æé«˜æ•ˆç‡é¿å…é‡å¤å»ºè®¾ï¼Œè¿™äº›åŠŸèƒ½å®ç°çš„ä»£ç è¢«å°è£…ä¸ºä»£ç åº“ï¼Œæœ‰æ—¶ä¹Ÿç§°æ¡†æ¶ã€‚æˆ‘ä»¬åªéœ€è¦åœ¨ç”¨åˆ°çš„æ—¶å€™é€šè¿‡ä¾èµ–ç®¡ç†å·¥å…·å°†å®ƒä»¬ä»¥é€‚å½“çš„æ–¹å¼å¼•å…¥å³å¯ã€‚æœ¬æ–‡å°†ç®€å•èŠèŠ iOS ä¸­çš„åº“ä¸æ¡†æ¶ç›¸å…³æ¦‚å¿µã€‚"/>



<meta property="og:title" content="iOS ä¸­çš„åº“ä¸æ¡†æ¶" />
<meta property="og:description" content="éšç€è½¯ä»¶å·¥ç¨‹çš„å‘å±•ï¼Œå¾ˆå¤šæˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½å‰äººéƒ½å·²ç»å¾ˆå¥½åœ°å®ç°äº†ï¼Œä¸ºäº†æé«˜æ•ˆç‡é¿å…é‡å¤å»ºè®¾ï¼Œè¿™äº›åŠŸèƒ½å®ç°çš„ä»£ç è¢«å°è£…ä¸ºä»£ç åº“ï¼Œæœ‰æ—¶ä¹Ÿç§°æ¡†æ¶ã€‚æˆ‘ä»¬åªéœ€è¦åœ¨ç”¨åˆ°çš„æ—¶å€™é€šè¿‡ä¾èµ–ç®¡ç†å·¥å…·å°†å®ƒä»¬ä»¥é€‚å½“çš„æ–¹å¼å¼•å…¥å³å¯ã€‚æœ¬æ–‡å°†ç®€å•èŠèŠ iOS ä¸­çš„åº“ä¸æ¡†æ¶ç›¸å…³æ¦‚å¿µã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/2019/libraries_in_ios/" />
<meta property="article:published_time" content="2019-10-29T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-10-29T00:00:00+00:00" /><meta property="og:site_name" content="iBlog" />




<script data-ad-client="ca-pub-9925978992661955" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

  </head>
  <body class="">
    <div class="container">
      <header class="header">
  <span class="header__inner">
    <a href="/" class="logo" style="text-decoration: none;">
  
    <span class="logo__mark"><svg xmlns="http://www.w3.org/2000/svg" class="greater-icon" viewBox="0 0 44 44">
  <path fill="none" d="M15 8l14.729 14.382L15 35.367"/>
</svg>
</span>
    <span class="logo__text">kingcos.me</span>
    <span class="logo__cursor"></span>
  
</a>

    <span class="header__right">
      
        <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/links">Links</a></li>
        
      
        
          <li><a href="/perspective">Perspective</a></li>
        
      
        
          <li><a href="/words">Words</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/links">Links</a></li>
      
    
      
        <li><a href="/perspective">Perspective</a></li>
      
    
      
        <li><a href="/words">Words</a></li>
      
    
  </ul>
</nav>

        <span class="menu-trigger">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M0 0h24v24H0z" fill="none"/>
            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
          </svg>
        </span>
      
      <span class="theme-toggle">
        <svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>

      </span>
    </span>
  </span>
</header>


      <div class="content">
        
  <div class="post">
    <h2 class="post-title"><a href="/posts/2019/libraries_in_ios/">iOS ä¸­çš„åº“ä¸æ¡†æ¶</a></h2>
    <div class="post-meta">
      
        <span class="post-date">
            2019-10-29
        </span>
      
      
      
        <span class="post-read-time">â€” 17 min read</span>
      
    </div>

    
      <span class="post-tags">
        
          #<a href="/tags/focus/">Focus</a>&nbsp;
        
          #<a href="/tags/ios/">iOS</a>&nbsp;
        
          #<a href="/tags/obj-c/">Obj-C</a>&nbsp;
        
          #<a href="/tags/swift/">Swift</a>&nbsp;
        
          #<a href="/tags//">ğŸš§</a>&nbsp;
        
      </span>
    

    

    <div class="post-content">
      <table>
<thead>
<tr>
<th style="text-align:center">Date</th>
<th style="text-align:center">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">2019-09-14</td>
<td style="text-align:center">é¦–æ¬¡æäº¤ï¼ŒæŒç»­æ›´æ–°å®Œå–„</td>
</tr>
<tr>
<td style="text-align:center">2019-09-22</td>
<td style="text-align:center">é€‚é… Xcode 11ï¼ŒæŒç»­æ›´æ–°å®Œå–„</td>
</tr>
<tr>
<td style="text-align:center">2019-10-29</td>
<td style="text-align:center">æ·»åŠ  Demoï¼š<a href="https://github.com/kingcos/libraries_in_ios-demo">libraries_in_ios-demo</a></td>
</tr>
</tbody>
</table>
<p><img src="/img/2019/libraries_in_ios/0.png" alt="0"></p>
<h2 id="preface">Preface</h2>
<p>éšç€è½¯ä»¶å·¥ç¨‹çš„å‘å±•ï¼Œå¾ˆå¤šæˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½å‰äººéƒ½å·²ç»å¾ˆå¥½åœ°å®ç°äº†ï¼Œä¸ºäº†æé«˜æ•ˆç‡é¿å…é‡å¤å»ºè®¾ï¼Œè¿™äº›åŠŸèƒ½å®ç°çš„ä»£ç è¢«å°è£…ä¸ºä»£ç åº“ï¼Œæœ‰æ—¶ä¹Ÿç§°æ¡†æ¶ã€‚æˆ‘ä»¬åªéœ€è¦åœ¨ç”¨åˆ°çš„æ—¶å€™é€šè¿‡ä¾èµ–ç®¡ç†å·¥å…·å°†å®ƒä»¬ä»¥é€‚å½“çš„æ–¹å¼å¼•å…¥å³å¯ã€‚æœ¬æ–‡å°†ç®€å•èŠèŠ iOS ä¸­çš„åº“ä¸æ¡†æ¶ç›¸å…³æ¦‚å¿µã€‚</p>
<h2 id="åŸºæœ¬æ¦‚å¿µ">åŸºæœ¬æ¦‚å¿µ</h2>
<p>åœ¨åˆ‡å…¥æ­£é¢˜ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥è¾¾æˆä¸€äº›å…±è¯†ã€‚</p>
<p>ä¸ç®¡æ˜¯è€æ´¾ Obj-C è¿˜æ˜¯æ–°ç§€ Swiftï¼Œå®ƒä»¬çš„æœ¬è´¨éƒ½æ˜¯ç¼–è¯‘å‹è¯­è¨€ã€‚å¯¹äºç¼–è¯‘å‹è¯­è¨€ï¼Œæºä»£ç ä¼šé¦–å…ˆç»ç”±ç¼–è¯‘å™¨ç¼–è¯‘ä¸ºç›®æ ‡æ–‡ä»¶ï¼Œé“¾æ¥å™¨å†å°†å¤šä¸ªç›®æ ‡æ–‡ä»¶é“¾æ¥ä¸ºå¯æ‰§è¡Œæ–‡ä»¶ã€‚é’ˆå¯¹é“¾æ¥é˜¶æ®µï¼Œä¸»è¦åˆ†ä¸ºé™æ€é“¾æ¥ä¸åŠ¨æ€é“¾æ¥ã€‚</p>
<p><strong>é™æ€</strong>ï¼Œå³ Staticã€‚æŒ‰ç…§å­—é¢æ„æ€ï¼Œé™æ€å³ä¸€æ—¦ç¡®å®šï¼Œå°±ä¸å†å®¹æ˜“æ”¹å˜ã€‚é™æ€é“¾æ¥ï¼Œå³åœ¨é“¾æ¥é˜¶æ®µï¼Œç›´æ¥å°†å¤šä¸ªç›®æ ‡æ–‡ä»¶é“¾æ¥ä¸ºä¸€ä¸ªæ–‡ä»¶ã€‚è€Œé™æ€åº“å°±å¯ä»¥ç†è§£ä¸ºå…±åŒç¼–è¯‘ä¸ºä¸€ä¸ªç›®æ ‡æ–‡ä»¶çš„æºä»£ç é›†åˆã€‚</p>
<p><strong>åŠ¨æ€</strong>ï¼Œå³ Dynamicã€‚æŒ‰ç…§å­—é¢æ„æ€ï¼ŒåŠ¨æ€å³æ¨è¿Ÿåˆ°è¿è¡Œæ—¶åŠ¨æ€åœ°å†³è®®ã€‚åŠ¨æ€é“¾æ¥ï¼Œå³åœ¨è¿è¡Œæ—¶æ‰å°†å„ä¸ªéƒ¨åˆ†ç»„åˆå½¢æˆå®Œæ•´çš„ç¨‹åºã€‚è€ŒåŠ¨æ€åº“å°±å¯ä»¥ç†è§£ä¸ºæ”¯æŒåŠ¨æ€é“¾æ¥æ–¹å¼çš„æºä»£ç é›†åˆã€‚</p>
<p>é™æ€é“¾æ¥çš„å¥½å¤„æ˜¯ï¼Œè¿è¡Œæ—¶ä¸å†é¢å¤–éœ€è¦æ—¶é—´åŠ¨æ€é“¾æ¥ï¼›åå¤„åˆ™æ˜¯ç”±äºé“¾æ¥çš„ç²’åº¦æ˜¯ç›®æ ‡æ–‡ä»¶ï¼Œé‚£ä¹ˆå¯èƒ½ä¼šé“¾æ¥äº†æ²¡æœ‰ä½¿ç”¨åˆ°çš„å‡½æ•°ï¼Œä¼šé€ æˆå¯æ‰§è¡Œæ–‡ä»¶è¿‡å¤§ï¼›è€Œä¸”å½“æŸä¸€ä¸ªç›®æ ‡æ–‡ä»¶çš„æºä»£ç æ”¹åŠ¨æ—¶ï¼Œé‚£ä¹ˆæ‰€æœ‰ä¾èµ–è¯¥ç›®æ ‡æ–‡ä»¶çš„é™æ€åº“éƒ½éœ€è¦é‡æ–°ç¼–è¯‘ï¼›åŠ¨æ€é“¾æ¥åˆ™è§£å†³äº†é™æ€é“¾æ¥çš„ç©ºé—´æµªè´¹ä¸é‡å¤ç¼–è¯‘é—®é¢˜ï¼Œæ¯”å¦‚åœ¨ iOS ä¸­ï¼Œç³»ç»Ÿåº“é‡‡ç”¨äº† dyld_shared_cache åŠ¨æ€é“¾æ¥ï¼Œè¿™æ ·å…¶å®ƒç¨‹åºå°±æ— éœ€å†å°†ç³»ç»Ÿåº“é‡å¤é“¾æ¥ï¼Œå½“ iOS ç³»ç»Ÿæ›´æ–°æ—¶ä¹Ÿæ— éœ€å°†æ‰€æœ‰ app é‡æ–°ç¼–è¯‘ã€‚è€Œåœ¨ç§»åŠ¨ç«¯å¼€å‘ä¸­ï¼Œapp çš„å¯åŠ¨æ—¶é—´ä¸åŒ…ä½“ç§¯å¤§å°å°†æ˜¯ä¸€ä¸ªæƒè¡¡é—®é¢˜ï¼Œå€¼å¾—æˆ‘ä»¬ä¾§é‡ä¸è€ƒé‡ã€‚</p>
<p>å¦å¤–ï¼Œè™½ç„¶å¹¿ä¹‰ä¸Šçš„åº“ï¼ˆLibraryï¼‰ä¸æ¡†æ¶ï¼ˆFrameworkï¼‰å«ä¹‰æ˜¯ç±»ä¼¼çš„ï¼Œä½†åœ¨ iOS å¼€å‘ä¸­ï¼Œå®˜æ–¹å°†è¿™ä¸¤ä¸ªæ¦‚å¿µè¿›è¡Œäº†åŒºåˆ†ï¼Œå› æ­¤ä¸‹æ–‡ä¸­æˆ‘ä»¬ä¼šæ˜ç¡®ä¸¤ä¸ªè¯çš„ä½¿ç”¨ã€‚</p>
<h2 id="cocoa-touch-static-library">Cocoa Touch Static Library</h2>
<p>æˆ‘ä»¬å…ˆä» Xcode ä¸­èƒ½å¤Ÿç›´æ¥åˆ›å»ºçš„ Cocoa Touch Static Library è¯´èµ·ï¼ˆæ³¨æ„ï¼Œåœ¨ Xcode 11 ä¸­ï¼Œè¿™é‡Œå·²ç»å˜æˆ Framework ä¸ Libraryï¼Œæ›´åŠ æ¸…æ™°ï¼‰ï¼š</p>
<p><img src="/img/2019/libraries_in_ios/1.png" alt="1"></p>
<p>Cocoa Touch Static Library å³é™æ€åº“ã€‚iOS ä¸Šç‹­ä¹‰çš„é™æ€åº“ï¼Œå³<strong>åªåŒ…å«ç¼–è¯‘åä»£ç çš„ <code>.a</code> æ–‡ä»¶</strong>ã€‚æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª oc-static-lib çš„é™æ€åº“ï¼Œä¸ºå…¶é»˜è®¤æä¾›çš„ <code>oc_static_lib</code> ç±»æ·»åŠ  <code>foo</code> æ–¹æ³•ï¼Œå¹¶æ·»åŠ ä¸€ä¸ª <code>NSObject</code> çš„åˆ†ç±»ï¼Œå®ç° +load å’Œ <code>foo</code> æ–¹æ³•ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objectivec" data-lang="objectivec"><span style="color:#75715e">// oc_static_lib.h
</span><span style="color:#75715e"></span>
<span style="color:#75715e">#import &lt;Foundation/Foundation.h&gt;
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">@interface</span> <span style="color:#a6e22e">oc_static_lib</span> : <span style="color:#a6e22e">NSObject</span>
- (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">foo</span>;
<span style="color:#66d9ef">@end</span>

<span style="color:#75715e">// oc_static_lib.m
</span><span style="color:#75715e"></span>
<span style="color:#75715e">#import &#34;oc_static_lib.h&#34;
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">@implementation</span> <span style="color:#a6e22e">oc_static_lib</span>
- (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">foo</span> {
    NSLog(<span style="color:#e6db74">@&#34;%@ - %@&#34;</span>, NSStringFromClass([self <span style="color:#66d9ef">class</span>]), NSStringFromSelector(_cmd));
}
<span style="color:#66d9ef">@end</span>

<span style="color:#75715e">// NSObject+OC_Static_Lib.h
</span><span style="color:#75715e"></span>
<span style="color:#75715e">#import &lt;Foundation/Foundation.h&gt;
</span><span style="color:#75715e"></span>
NS_ASSUME_NONNULL_BEGIN
<span style="color:#66d9ef">@interface</span> <span style="color:#a6e22e">NSObject</span> (OC_Static_Lib)
- (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">foo</span>;
<span style="color:#66d9ef">@end</span>
NS_ASSUME_NONNULL_END

<span style="color:#75715e">// NSObject+OC_Static_Lib.m
</span><span style="color:#75715e"></span>
<span style="color:#75715e">#import &#34;NSObject+OC_Static_Lib.h&#34;
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">@implementation</span> <span style="color:#a6e22e">NSObject</span> (OC_Static_Lib)
+ (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">load</span> {
    NSLog(<span style="color:#e6db74">@&#34;%@ - %@&#34;</span>, NSStringFromClass([self <span style="color:#66d9ef">class</span>]), NSStringFromSelector(_cmd));
}
- (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">foo</span> {
    NSLog(<span style="color:#e6db74">@&#34;%@ - %@&#34;</span>, NSStringFromClass([self <span style="color:#66d9ef">class</span>]), NSStringFromSelector(_cmd));
}
<span style="color:#66d9ef">@end</span>
</code></pre></div><p>éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬éœ€è¦å°†æ–°åˆ›å»ºçš„ <code>.h</code> åŠ å…¥åˆ° Xcode - Targets - Build Phases - Copy Files ä¸­ï¼Œè¿™æ ·å¤–ç•Œæ‰èƒ½é€šè¿‡å¼•å…¥è¯¥å¤´æ–‡ä»¶æ¥è®¿é—®å…¶ä¸­çš„å†…å®¹ï¼š</p>
<p><img src="/img/2019/libraries_in_ios/2.png" alt="2"></p>
<blockquote>
<p>âš ï¸ æ³¨æ„ï¼š</p>
<p>è¿™é‡Œæˆ‘ä»¬çš„ç›®æ ‡è®¾å¤‡é€‰æ‹©çš„æ˜¯æ¨¡æ‹Ÿå™¨ï¼Œæ‰€ä»¥é»˜è®¤ç¼–è¯‘åçš„ <code>.a</code> æ–‡ä»¶ä¹Ÿå°†åªé€‚ç”¨äºæ¨¡æ‹Ÿå™¨æ¶æ„ï¼ˆx86_64ï¼‰ï¼Œä¸ºäº†åŒæ—¶èƒ½å¤ŸçœŸæœºè¿è¡Œå’Œæ¨¡æ‹Ÿå™¨è°ƒè¯•ï¼Œé€šå¸¸ä¼šä½¿ç”¨ <code>lipo</code> å‘½ä»¤å°†å¤šç§æ¶æ„çš„ <code>.a</code> æ–‡ä»¶è¿›è¡Œåˆå¹¶ä¸ºèƒ–äºŒè¿›åˆ¶ï¼ˆFat-Binaryï¼‰æ–‡ä»¶ã€‚</p>
</blockquote>
<h3 id="obj-c-å·¥ç¨‹å¼•å…¥-obj-c-é™æ€åº“">Obj-C å·¥ç¨‹å¼•å…¥ Obj-C é™æ€åº“</h3>
<p><img src="/img/2019/libraries_in_ios/3.png" alt="3"></p>
<p>æˆ‘ä»¬å°† oc-static-lib ç¼–è¯‘åçš„ <code>.a</code> ä¸ <code>.h</code> ä¸€èµ·æ‹–å…¥ Obj-C å·¥ç¨‹ï¼ˆå‹¾é€‰ã€ŒAdd to targetsã€æ·»åŠ è‡³ç›®æ ‡ Targetï¼Œæˆ–è€…æ‰‹åŠ¨å°† <code>.a</code> åŠ å…¥åˆ°ã€ŒLink Binary With Librariesã€ä¸­ï¼‰ï¼Œå³å¯ä½¿ç”¨ <code>#import &quot;&quot;</code> æ¥å¼•å…¥å¹¶è°ƒç”¨ï¼ˆéœ€è¦æ³¨æ„çš„æ˜¯ï¼šé™æ€åº“ä¸­å¦‚æœå­˜åœ¨åˆ†ç±»ï¼Œéœ€è¦æ·»åŠ  <code>-ObjC</code> ä½œä¸º Other Linker Flagsï¼Œå…·ä½“å¯è¯¦è§ã€Š<a href="/posts/2019/+load_in_ios/">iOS ä¸­çš„ +load æ–¹æ³•</a>ã€‹ä¸€æ–‡ï¼‰ï¼š</p>
<blockquote>
<p><strong>Tips</strong></p>
<p>åœ¨ C/C++ ä¸­ï¼Œä¸ºäº†æ›´åŠ æ¸…æ™°åŒ–å£°æ˜ä¸å®ç°ï¼Œå£°æ˜å’Œå®ç°éœ€è¦åˆ†åˆ«å†™åœ¨ <code>.h</code>ï¼ˆå¤´æ–‡ä»¶ï¼‰å’Œ <code>.c</code> / <code>.cpp</code>ï¼ˆå®ç°æ–‡ä»¶ï¼‰ä¸­ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œå¼€å‘è€…å¯ä»¥æ— éœ€é¢å¤–çš„è®¿é—®æ§åˆ¶ç¬¦å³å¯å°†éœ€è¦æš´éœ²åœ¨å¤–ç•Œçš„å£°æ˜æ”¾ç½®åœ¨å¤´æ–‡ä»¶ä¸­ï¼Œå¤–ç•Œä½¿ç”¨æ—¶é€šè¿‡ <code>#include</code> å¼•ç”¨å¤´æ–‡ä»¶å³å¯ã€‚Obj-C/C++ ä¹Ÿå»¶ç»­äº†è¿™ä¸€ä¼ ç»Ÿï¼Œä¸åŒçš„æ˜¯å®ç°æ–‡ä»¶çš„åç¼€åˆ†åˆ«ä¸º <code>.m</code> å’Œ <code>.mm</code>ï¼Œå¹¶ä¸ºäº†é¿å…é‡å¤å¼•ç”¨æ–°æ¨å‡ºäº† <code>#import</code>ã€‚</p>
<p><code>#include</code> å’Œ <code>#import</code> åé¢éƒ½å¯ä»¥åŠ  <code>&lt;XXX.h&gt;</code> æˆ– <code>&quot;XXX.h&quot;</code>ã€‚é€šå¸¸æ¥è¯´åŠ  <code>&quot;&quot;</code> çš„å¤´æ–‡ä»¶ä¼˜å…ˆä»æœ¬åœ°å½“å‰æ–‡ä»¶ç›®å½•æŸ¥æ‰¾ï¼Œå…¶ä¸­ä¹Ÿå¯ä»¥åŒ…å«ç›¸å¯¹è·¯å¾„ï¼Œå³ <code>#import &quot;oc-static-lib/oc_static_lib.h&quot;</code> / <code>#import &quot;NSObject+OC_Static_Lib.h&quot;</code> éƒ½æ˜¯æ”¯æŒçš„ï¼›è€ŒåŠ  <code>&lt;&gt;</code> çš„å¤´æ–‡ä»¶åˆ™ä¼šä½¿å¾—ç¼–è¯‘å™¨ä¼˜å…ˆåˆ°ç³»ç»Ÿç›®å½•ä¸‹å…¨å±€æŸ¥æ‰¾ã€‚</p>
</blockquote>
<h3 id="swift-å·¥ç¨‹å¼•å…¥-swift-é™æ€åº“">Swift å·¥ç¨‹å¼•å…¥ Swift é™æ€åº“</h3>
<p>åœ¨ Xcode 9 ä¹‹åï¼ŒSwift ä¹Ÿæ”¯æŒäº†é™æ€åº“ã€‚ä¸ Obj-C ä¸åŒï¼ŒSwift æ²¡æœ‰å¤´æ–‡ä»¶çš„æ¦‚å¿µï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å°†æš´éœ²ç»™å¤–ç•Œçš„ç±»å’Œå‡½æ•°ç­‰ä½¿ç”¨ <code>public</code> ä¿®é¥°ã€‚ç¼–è¯‘åçš„ Swift é™æ€åº“ä¹Ÿæ˜¯ <code>.a</code> æ–‡ä»¶ï¼Œä½†ä¸åŒçš„æ˜¯å¤šäº† <code>.swiftmodule</code> ä»¥åŠ <code>.swiftdoc</code>ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">âœ  Debug-iphonesimulator tree
.
â”œâ”€â”€ libswift-static-lib.a
â””â”€â”€ swift_static_lib.swiftmodule
    â”œâ”€â”€ x86_64.swiftdoc
    â””â”€â”€ x86_64.swiftmodule

<span style="color:#ae81ff">1</span> directory, <span style="color:#ae81ff">3</span> files
</code></pre></div><p><code>.swiftmodule</code> åŒ…å«äº†åºåˆ—åŒ–è¿‡çš„ ASTï¼ˆæŠ½è±¡è¯­æ³•æ ‘ï¼ŒAbstract Syntax Treeï¼‰ï¼Œå¯èƒ½ä¹ŸåŒ…å« SILï¼ˆSwift ä¸­é—´è¯­è¨€ï¼ŒSwift Intermediate Languageï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ç†è§£ä¸ºç±»ä¼¼ C è¯­è¨€åº“æˆ–æ¡†æ¶ä¸­å¤´æ–‡ä»¶çš„äºŒè¿›åˆ¶æ ¼å¼æ–‡ä»¶ï¼›<code>.swiftdoc</code> åˆ™æ˜¯ Swift æ–‡æ¡£æ³¨é‡Šç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œç”± <code>Serialization::writeDocToStream()</code> ç”Ÿæˆï¼Œå› æ­¤å¹¶éæ˜¯å¿…è¦çš„ã€‚ç”±äº Swift çš„ Module æœºåˆ¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ Xcode - Targets - Build Settings - Swift Compiler - Search Paths - Import Paths ä¸­å¼•å…¥ï¼š</p>
<p><img src="/img/2019/libraries_in_ios/4.png" alt="4"></p>
<p>è¿™æ ·æˆ‘ä»¬æ‰èƒ½åœ¨ Swift å·¥ç¨‹ä¸­æ­£å¸¸ä½¿ç”¨ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#75715e">// swift_static_lib.swift</span>

<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Foundation</span>

<span style="color:#66d9ef">@objc</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">swift_static_lib</span>: NSObject {
    <span style="color:#66d9ef">@objc</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">foo</span>() {
        print(<span style="color:#e6db74">&#34;swift_static_lib - </span><span style="color:#e6db74">\(</span><span style="color:#66d9ef">#function</span><span style="color:#e6db74">)</span><span style="color:#e6db74">&#34;</span>)
    }
}

<span style="color:#75715e">// ViewController.swift</span>

<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">UIKit</span>
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">swift_static_lib</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ViewController</span>: UIViewController {
    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">viewDidLoad</span>() {
        <span style="color:#66d9ef">super</span>.viewDidLoad()
        swift_static_lib().foo()
    }
}
</code></pre></div><h3 id="obj-c-å·¥ç¨‹å¼•å…¥-swift-é™æ€åº“">Obj-C å·¥ç¨‹å¼•å…¥ Swift é™æ€åº“</h3>
<p>ä¸ºäº†ã€Œææ‹”ã€æ–°ç§€ï¼ŒSwift æ”¯æŒä¸ Obj-C æ··ç¼–ï¼Œç„¶è€Œæ··ç¼–ä¸‹çš„å„ç§æƒ…å†µå°±ä¼šå˜å¾—ååˆ†ç‰¹æ®Šã€‚åœ¨åŒä¸€ä¸ªå·¥ç¨‹ä¸‹ Swift æ–‡ä»¶ä¸ Obj-C æ–‡ä»¶æ··ç¼–æ—¶ï¼ŒXcode ä¼šæç¤ºæˆ‘ä»¬åˆ›å»ºæ¡¥æ¥å¤´æ–‡ä»¶ <code>&lt;PROJECT_NAME&gt;-Bridging-Header.h</code>ï¼Œæˆ‘ä»¬å¯ä»¥å°†éœ€è¦æš´éœ²ç»™ Swift çš„ Obj-C ä»£ç åœ¨è¯¥æ¡¥æ¥æ–‡ä»¶ä¸­å¼•å…¥ï¼›è€Œ Obj-C ä»£ç ä¸­å¸Œæœ›ä½¿ç”¨ Swift ä¸­çš„ç›¸å…³å®šä¹‰æ—¶ï¼Œå¯ä»¥å¼•å…¥è‡ªåŠ¨ç”Ÿæˆä½†ä¸å¯è§çš„ <code>&lt;PROJECT_NAME&gt;-Swift.h</code>ï¼Œå¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæš´éœ²ç»™ Obj-C çš„ç±»æˆ–å‡½æ•°ç­‰éœ€è¦ä½¿ç”¨ <code>@objc</code> æˆ– <code>dynamic</code> ä¿®é¥°ï¼Œ<strong>ä½†å‰è€…ä¸èƒ½å†³å®šå‡½æ•°æœ€ç»ˆæ´¾å‘æ–¹å¼ï¼Œè€Œåè€…åˆ™ä¸ºåŠ¨æ€æ´¾å‘</strong>ã€‚</p>
<p>é‚£ä¹ˆå¦‚æœè¦åœ¨ Obj-C å·¥ç¨‹å¼•å…¥ Swift é™æ€åº“ï¼Œé¦–å…ˆè¦åœ¨å·¥ç¨‹ä¸­å¼•å…¥ä¸€ä¸ªå ä½ Swift æ–‡ä»¶ï¼Œå¹¶åˆ›å»ºæ¡¥æ¥æ–‡ä»¶ï¼Œè¿™æ · Xcode ä¸­ Swift ç›¸å…³çš„ä¾èµ–é…ç½®æ‰èƒ½å¾—ä»¥å»ºç«‹ï¼š</p>
<p><img src="/img/2019/libraries_in_ios/7.png" alt="7"></p>
<p>Swift é™æ€åº“ä¹Ÿå¯ä»¥è‡ªåŠ¨ç”Ÿæˆ <code>&lt;PROJECT_NAME&gt;-Swift.h</code>ï¼Œä½†å…¶å¹¶æ²¡æœ‰å’Œæœ€ç»ˆäº§ç‰© <code>.a</code> æ”¾ç½®åœ¨ä¸€èµ·ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">âœ  Build tree
.
â”œâ”€â”€ Intermediates.noindex
â”‚Â Â  â”œâ”€â”€ XCBuildData
â”‚Â Â  â”‚Â Â  â””â”€â”€ ...
â”‚Â Â  â””â”€â”€ swift_static_lib.build
â”‚Â Â      â””â”€â”€ Debug-iphonesimulator
â”‚Â Â          â””â”€â”€ swift_static_lib.build
â”‚Â Â              â”œâ”€â”€ DerivedSources
â”‚Â Â              â”‚Â Â  â””â”€â”€ swift_static_lib-Swift.h â¬…ï¸
â”‚Â Â              â””â”€â”€ ...
â””â”€â”€ Products
    â””â”€â”€ ...

<span style="color:#ae81ff">17</span> directories, <span style="color:#ae81ff">41</span> files
</code></pre></div><p>å› æ­¤æˆ‘ä»¬å¯ä»¥å°†ä»¥ä¸‹è„šæœ¬æ·»åŠ åˆ° Xcode - Targets - Build Phases - New Run Script Phase ä¸­ï¼Œè¿™æ ·æ¯æ¬¡æ„å»ºå³å¯å°† <code>&lt;PROJECT_NAME&gt;-Swift.h</code> ä¸€å¹¶æ‹·è´åˆ°äº§ç‰©ç›®å½•ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># Powered by https://paul-samuels.com/blog/2018/01/14/swift-static-library-in-objective-c/</span>

<span style="color:#75715e"># BUILT_PRODUCTS_DIRï¼šæ„å»ºäº§ç‰©ç›®å½•ï¼›PRODUCT_MODULE_NAMEï¼šäº§ç‰©åç§°</span>
target_dir<span style="color:#f92672">=</span><span style="color:#e6db74">${</span>BUILT_PRODUCTS_DIR<span style="color:#e6db74">}</span>/include/<span style="color:#e6db74">${</span>PRODUCT_MODULE_NAME<span style="color:#e6db74">}</span>/

<span style="color:#75715e"># Ensure the target include path exists</span>
<span style="color:#75715e"># é€’å½’åˆ›å»ºæ–‡ä»¶å¤¹</span>
mkdir -p <span style="color:#e6db74">${</span>target_dir<span style="color:#e6db74">}</span>

<span style="color:#75715e"># Copy any file that looks like a Swift generated header to the include path</span>
<span style="color:#75715e"># å¤åˆ¶åˆ°äº§ç‰©è·¯å¾„</span>
cp <span style="color:#e6db74">${</span>DERIVED_SOURCES_DIR<span style="color:#e6db74">}</span>/*-Swift.h <span style="color:#e6db74">${</span>target_dir<span style="color:#e6db74">}</span>
</code></pre></div><p>ä¹‹åæˆ‘ä»¬éœ€è¦å°†ç”Ÿæˆçš„äº§ç‰©æ”¾ swift_static_lib æ–‡ä»¶ä¸­ä¸€èµ·æ‹–åˆ° Obj-C å·¥ç¨‹ä¸­ï¼ˆå‹¾é€‰ã€ŒAdd to targetsã€æ·»åŠ è‡³ç›®æ ‡ Targetï¼Œæˆ–è€…æ‰‹åŠ¨å°† <code>.a</code> åŠ å…¥åˆ°ã€ŒLink Binary With Librariesã€ä¸­ï¼‰ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">âœ  swift_static_lib tree
.
â”œâ”€â”€ include
â”‚Â Â  â””â”€â”€ swift_static_lib
â”‚Â Â      â””â”€â”€ swift_static_lib-Swift.h
â”œâ”€â”€ libswift_static_lib.a
â””â”€â”€ swift_static_lib.swiftmodule
    â”œâ”€â”€ x86_64.swiftdoc
    â””â”€â”€ x86_64.swiftmodule

<span style="color:#ae81ff">3</span> directories, <span style="color:#ae81ff">4</span> files
</code></pre></div><!-- æœ€åå†åœ¨ Xcode - Targets - Build Settings - Header Search Paths & Library Search Paths ä¸­æ·»åŠ ä¸Š `.a` çš„çˆ¶çº§è·¯å¾„ `$(PROJECT_DIR)/oc-demo-project/swift_static_lib` å³å¯ï¼ˆæ¯”è¾ƒç¥å¥‡çš„æ˜¯ï¼Œåœ¨ Xcode 11 ä¸­å³ä½¿ä¸æ‰‹åŠ¨æŒ‡å®šï¼Œä¹Ÿå¯æ­£å¸¸ç¼–è¯‘é€šè¿‡è¿è¡Œï¼‰ï¼š

![6](/img/2019/libraries_in_ios/6.png) -->
<p>è¿™æ ·ï¼Œåœ¨ Obj-C å·¥ç¨‹ä¸­é€šè¿‡ <code>#import &quot;swift_static_lib-Swift.h&quot;</code> å³å¯ä½¿ç”¨ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objectivec" data-lang="objectivec"><span style="color:#75715e">// ViewController.m
</span><span style="color:#75715e"></span>
<span style="color:#75715e">//#import &#34;swift-static-lib/include/swift_static_lib/swift_static_lib-Swift.h&#34;
</span><span style="color:#75715e"></span><span style="color:#75715e">#import &#34;swift_static_lib-Swift.h&#34;
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">@implementation</span> <span style="color:#a6e22e">ViewController</span>

- (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">viewDidLoad</span> {
    [super viewDidLoad];

    [[swift_static_lib new] foo];
}
</code></pre></div><h3 id="swift-å·¥ç¨‹å¼•å…¥-obj-c-é™æ€åº“">Swift å·¥ç¨‹å¼•å…¥ Obj-C é™æ€åº“</h3>
<p>å¦‚æœæƒ³è¦åœ¨ Swift å·¥ç¨‹ä¸­å¼•å…¥ Obj-C é™æ€åº“ï¼ˆæ³¨æ„å¦‚æœ‰åˆ†ç±»ä»éœ€åŠ  <code>-ObjC</code>ï¼‰ï¼Œåˆ™ä¹Ÿéœ€è¦æ¡¥æ¥å¤´æ–‡ä»¶ä½œä¸ºä¸­ä»‹ã€‚æˆ‘ä»¬åœ¨å·¥ç¨‹ä¸­æ–°å»ºä¸€ä¸ªå ä½ Obj-C æ–‡ä»¶ï¼ŒæŒ‰ Xcode æç¤ºåˆ›å»ºæ¡¥æ¥æ–‡ä»¶ï¼›å°† oc-static-lib ç¼–è¯‘åçš„äº§ç‰©ä¸€èµ·æ‹–å…¥ Swift å·¥ç¨‹ï¼Œå¹¶åœ¨æ¡¥æ¥æ–‡ä»¶ä¸­å¼•å…¥ Obj-C é™æ€åº“ä¸­çš„ç›¸å…³å¤´æ–‡ä»¶ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objectivec" data-lang="objectivec"><span style="color:#75715e">// swift-demo-project-Bridging-Header.h
</span><span style="color:#75715e"></span>
<span style="color:#75715e">//#import &#34;liboc-static-lib/include/oc-static-lib/oc_static_lib.h&#34;
</span><span style="color:#75715e"></span><span style="color:#75715e">#import &#34;oc_static_lib.h&#34;
</span></code></pre></div><p>ä¹‹åå³å¯ç›´æ¥åœ¨ Swift ä¸­ä½¿ç”¨ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#75715e">// ViewController.swift</span>

<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">UIKit</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ViewController</span>: UIViewController {
    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">viewDidLoad</span>() {
        <span style="color:#66d9ef">super</span>.viewDidLoad()

        oc_static_lib().foo()
    }
}
</code></pre></div><h2 id="cocoa-touch-framework">Cocoa Touch Framework</h2>
<p>Cocoa Touch Framework æ˜¯ Xcode ä¸­èƒ½å¤Ÿåˆ›å»ºçš„å¦å¤–ä¸€ç§æ¡†æ¶ï¼ˆFrameworkï¼‰ç±»å‹ï¼ˆæ³¨æ„ï¼Œåœ¨ Xcode 11 ä¸­ï¼Œè¿™é‡Œå·²ç»å˜æˆ Framework ä¸ Libraryï¼Œæ›´åŠ æ¸…æ™°ï¼‰ï¼Œè€Œéåº“ï¼ˆLibraryï¼‰ã€‚ä¸åŒäºåº“ï¼ŒiOS ä¸­çš„æ¡†æ¶æŒ‡çš„æ˜¯åŒ…å«èµ„æºï¼ˆæ¯”å¦‚å›¾ç‰‡ã€æœ¬åœ°åŒ–æ–‡ä»¶ã€Storyboard ç­‰ï¼‰ã€å¤´æ–‡ä»¶ã€ä»¥åŠç¼–è¯‘åçš„äºŒè¿›åˆ¶ç­‰çš„é›†åˆã€‚æ¡†æ¶çš„åç¼€åæ˜¯ <code>.framework</code>ï¼Œå¹¶å¯ä»¥é€šè¿‡ <code>NSBundle</code> API è®¿é—®ï¼Œä¸åŒçš„æ˜¯æ¡†æ¶å¯ä»¥ç›´æ¥å¯¼èˆªåˆ°å…¶ä¸­çš„ç›®å½•å†…å®¹ï¼Œä¾¿äºå¼€å‘è€…æŸ¥çœ‹ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">âœ  oc_framework.framework tree
.
â”œâ”€â”€ Assets.car â¡ï¸ å·¥ç¨‹ä¸­çš„ xcassets èµ„æºå°†è¢«å‹ç¼©ä¸º car
â”œâ”€â”€ Headers
â”‚Â Â  â”œâ”€â”€ NSObject+OC_Framework.h
â”‚Â Â  â”œâ”€â”€ OC_Foo.h
â”‚Â Â  â”œâ”€â”€ PublicHeader.h
â”‚Â Â  â””â”€â”€ oc_framework.h
â”œâ”€â”€ Info.plist
â”œâ”€â”€ Modules
â”‚Â Â  â””â”€â”€ module.modulemap ğŸŒŸ
â”œâ”€â”€ _CodeSignature
â”‚Â Â  â””â”€â”€ CodeResources
â””â”€â”€ oc_framework

<span style="color:#ae81ff">3</span> directories, <span style="color:#ae81ff">9</span> files

âœ  swift_framework.framework tree
.
â”œâ”€â”€ Headers
â”‚Â Â  â”œâ”€â”€ swift_framework-Swift.h â¡ï¸ è‡ªåŠ¨ç”Ÿæˆçš„ *-Swift.h ä¾¿äº Obj-C å·¥ç¨‹ä½¿ç”¨
â”‚Â Â  â””â”€â”€ swift_framework.h
â”œâ”€â”€ Info.plist
â”œâ”€â”€ Modules
â”‚Â Â  â”œâ”€â”€ module.modulemap ğŸŒŸ
â”‚Â Â  â””â”€â”€ swift_framework.swiftmodule â¡ï¸ ç±»ä¼¼ Swift é™æ€åº“
â”‚Â Â      â”œâ”€â”€ x86_64.swiftdoc
â”‚Â Â      â””â”€â”€ x86_64.swiftmodule
â”œâ”€â”€ _CodeSignature
â”‚Â Â  â””â”€â”€ CodeResources
â”œâ”€â”€ eng.strings â¡ï¸ å·¥ç¨‹ä¸­çš„ strings èµ„æº
â””â”€â”€ swift_framework

<span style="color:#ae81ff">4</span> directories, <span style="color:#ae81ff">9</span> files
</code></pre></div><p>Framework ä¸­ç¼–è¯‘åçš„ Mach-O å¯ä»¥æ ¹æ®éœ€è¦ä½œä¸ºåŠ¨æ€åº“ã€é™æ€åº“ï¼ˆæ³¨æ„å¦‚æœ‰åˆ†ç±»ä»éœ€åŠ  <code>-ObjC</code>ï¼‰ã€æˆ–è€…å¯æ‰§è¡Œæ–‡ä»¶ç­‰ï¼š</p>
<p><img src="/img/2019/libraries_in_ios/8.png" alt="8"></p>
<p>Framework ä¸­éœ€è¦æš´éœ²åœ¨å¤–ç•Œçš„å¤´æ–‡ä»¶ï¼Œéœ€è¦åœ¨ Xcode - Targets - Build Phases - Headers - Public ä¸­å…¬å¼€ï¼ˆSwift Framework ä¸­çš„ <code>*-Swift.h</code> åˆ™ä¸éœ€è¦æ‰‹åŠ¨ç§»åŠ¨ï¼‰ï¼›èµ„æºæ–‡ä»¶åˆ™éœ€è¦åŠ å…¥ Copy Bundle Resources ä¸­ï¼ˆä½¿ç”¨æ—¶é€šè¿‡ <code>NSBunlde</code> APIï¼‰ï¼š</p>
<p><img src="/img/2019/libraries_in_ios/10.png" alt="10"></p>
<h3 id="obj-c-å·¥ç¨‹">Obj-C å·¥ç¨‹</h3>
<p>åœ¨ Obj-C å·¥ç¨‹ä¸­ï¼Œåªéœ€è¦å°† Framework äº§ç‰©æ‹–å…¥å¹¶åœ¨ Xcode - Targets - General - Embedded Binaries &amp; Links Framework and Libraries ä¸­æ·»åŠ å³å¯(Xcode 11 ä¸­éœ€å°† Framework åœ¨ Xcode - General - Frameworks, Libraries, and Embedded Content ä¸­è®¾ç½®ä¸º Embedï¼‰ï¼š</p>
<p><img src="/img/2019/libraries_in_ios/9.png" alt="9"></p>
<p>åœ¨å·¥ç¨‹ä¸­æˆ‘ä»¬å°±å¯ä»¥å°†å…¶å¼•å…¥å¹¶ä½¿ç”¨äº†ï¼š</p>
<p><strong>oc-framework:</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objectivec" data-lang="objectivec"><span style="color:#75715e">// OC_Foo.m
</span><span style="color:#75715e"></span>
<span style="color:#75715e">#import &#34;OC_Foo.h&#34;
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">@implementation</span> <span style="color:#a6e22e">OC_Foo</span>
- (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">foo</span> {
    NSLog(<span style="color:#e6db74">@&#34;%@ - %@&#34;</span>, NSStringFromClass([self <span style="color:#66d9ef">class</span>]), NSStringFromSelector(_cmd));
}

- (UIImage <span style="color:#f92672">*</span>)<span style="color:#a6e22e">image</span> {
    <span style="color:#75715e">// é€šè¿‡ NSBundle è·å–èµ„æº
</span><span style="color:#75715e"></span>    NSBundle <span style="color:#f92672">*</span>bundle <span style="color:#f92672">=</span> [NSBundle bundleForClass:[self <span style="color:#66d9ef">class</span>]];
    <span style="color:#66d9ef">return</span> [UIImage imageNamed:<span style="color:#e6db74">@&#34;blog&#34;</span> inBundle:bundle compatibleWithTraitCollection:nil];
}
<span style="color:#66d9ef">@end</span>
</code></pre></div><p><strong>swift-framework:</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#75715e">// Swift_Foo.swift</span>

<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Foundation</span>

<span style="color:#66d9ef">@objc</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Swift_Foo</span> : NSObject {
    <span style="color:#66d9ef">@objc</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">foo</span>() {
        print(<span style="color:#e6db74">&#34;Swift_Foo - </span><span style="color:#e6db74">\(</span><span style="color:#66d9ef">#function</span><span style="color:#e6db74">)</span><span style="color:#e6db74">&#34;</span>)
    }

    <span style="color:#66d9ef">@objc</span> <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">strings</span>() -&gt; String {
        <span style="color:#66d9ef">let</span> bundle = Bundle(<span style="color:#66d9ef">for</span>: Swift_Foo.<span style="color:#66d9ef">self</span>)
        <span style="color:#66d9ef">return</span> NSLocalizedString(<span style="color:#e6db74">&#34;my_blog&#34;</span>, bundle: bundle, comment: <span style="color:#e6db74">&#34;My blog link.&#34;</span>)
    }
}
</code></pre></div><p><strong>Obj-C å·¥ç¨‹ï¼š</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objectivec" data-lang="objectivec"><span style="color:#75715e">// ViewController.m
</span><span style="color:#75715e"></span>
<span style="color:#75715e">#import &#34;ViewController.h&#34;
</span><span style="color:#75715e"></span>@import oc_framework;
<span style="color:#75715e">//#import &#34;oc_framework/oc_framework.h&#34;
</span><span style="color:#75715e">//#import &lt;oc_framework/oc_framework.h&gt;
</span><span style="color:#75715e">//#import &lt;oc_framework/PublicHeader.h&gt;
</span><span style="color:#75715e">//#import &lt;oc_framework/OC_Foo.h&gt;
</span><span style="color:#75715e"></span>
@import swift_framework;
<span style="color:#75715e">//#import &#34;swift_framework/swift_framework.h&#34;
</span><span style="color:#75715e">//#import &#34;swift_framework/swift_framework-Swift.h&#34;
</span><span style="color:#75715e">//#import &lt;swift_framework/swift_framework.h&gt;
</span><span style="color:#75715e">//#import &lt;swift_framework/swift_framework-Swift.h&gt;
</span><span style="color:#75715e"></span>
<span style="color:#66d9ef">@interface</span> <span style="color:#a6e22e">ViewController</span> ()
<span style="color:#66d9ef">@property</span> (<span style="color:#66d9ef">weak</span>, <span style="color:#66d9ef">nonatomic</span>) <span style="color:#66d9ef">IBOutlet</span> UIImageView <span style="color:#f92672">*</span>imageView;
<span style="color:#66d9ef">@end</span>

<span style="color:#66d9ef">@implementation</span> <span style="color:#a6e22e">ViewController</span>

- (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">viewDidLoad</span> {
    [super viewDidLoad];

    OC_Foo <span style="color:#f92672">*</span>foo <span style="color:#f92672">=</span> [OC_Foo new];
    [foo foo];

    self.imageView.image <span style="color:#f92672">=</span> [foo image];

    Swift_Foo <span style="color:#f92672">*</span>sFoo <span style="color:#f92672">=</span> [[Swift_Foo alloc] init];
    [sFoo foo];

    NSLog(<span style="color:#e6db74">@&#34;%@&#34;</span>, [sFoo strings]);
}

<span style="color:#66d9ef">@end</span>
</code></pre></div><h3 id="swift-å·¥ç¨‹">Swift å·¥ç¨‹</h3>
<p>Framework çš„å¼•å…¥è¦æ¯”é™æ€åº“ç®€å•è®¸å¤šï¼Œæˆ‘ä»¬åªéœ€è¦å°†å…¶ç›´æ¥å¼•å…¥å·¥ç¨‹ä¸­ï¼ˆæ³¨æ„å¦‚æœ‰åˆ†ç±»ä»éœ€åŠ  <code>-ObjC</code>ï¼‰ï¼Œå¹¶åœ¨ Swift é€šè¿‡ <code>import &lt;FRAMEWORK_NAME&gt;</code> å¯¼å…¥å³å¯ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">UIKit</span>
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">oc_framework</span>
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">swift_framework</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ViewController</span>: UIViewController {
    <span style="color:#66d9ef">@IBOutlet</span> <span style="color:#66d9ef">weak</span> <span style="color:#66d9ef">var</span> imageView: UIImageView!

    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">viewDidLoad</span>() {
        <span style="color:#66d9ef">super</span>.viewDidLoad()

        <span style="color:#66d9ef">let</span> foo = OC_Foo()
        foo.foo()
        <span style="color:#75715e">// âš ï¸ æ³¨æ„ï¼Œæ¯”è¾ƒå¥‡æ€ªçš„æ˜¯ï¼š</span>
        <span style="color:#75715e">// åªæœ‰å½“ Obj-C Framework çš„ Mach-O ç±»å‹ä¸ºåŠ¨æ€åº“æ—¶ï¼Œä»¥ä¸‹çš„èµ„æºæ‰æœ‰æ•ˆ</span>
        imageView.image = foo.image()

        <span style="color:#66d9ef">let</span> sFoo = Swift_Foo()
        sFoo.foo()
        print(sFoo.strings())
    }
}
</code></pre></div><h3 id="aggregate-target">Aggregate Target</h3>
<p><img src="/img/2019/libraries_in_ios/11.png" alt="11"></p>
<p>å…³äº Aggregate Targetï¼Œå®˜æ–¹æä¾›çš„å¯å‚è€ƒèµ„æ–™å¾ˆå°‘ã€‚è€ç‰ˆæœ¬çš„ Xcode ä¸­å°†å…¶æè¿°ä¸ºã€ŒThis target is used to aggregate other targets togetherã€ï¼Œå³ aggregate æœ¬èº«å…·æœ‰èšåˆã€æ€»è®¡ä¹‹æ„ï¼Œè€Œ Aggregate Target æ­£æ˜¯ç”¨äºèšåˆå…¶å®ƒ Targetï¼Œä½¿å¾—å¯ä»¥åœ¨ Xcode ä¸­è¾¾åˆ°ä¸€æ¬¡æ€§æ„å»ºå¤šä¸ª Target çš„ç›®çš„ã€‚æ¯”å¦‚æˆ‘ä»¬è¿™é‡Œæœ‰å¤šä¸ª Frameworkï¼Œå³å¯ä½¿ç”¨ Aggregate Target åŒæ—¶æ„å»ºï¼Œä½†è¿™å¹¶ä¸ä¼šå½±å“æœ€ç»ˆäº§ç‰©ï¼š</p>
<p><img src="/img/2019/libraries_in_ios/17.png" alt="17"></p>
<h2 id="cocoapods">CocoaPods</h2>
<p>iOS å¼€å‘å‘å±•çš„è¿™äº›å¹´ï¼ŒCocoaPods æ˜¯ iOS/macOS å¼€å‘çš„è€ç‰Œæ­æ¡£ï¼Œç”¨æ¥å¸®åŠ©æˆ‘ä»¬ç®¡ç†å·¥ç¨‹ä¾èµ–ã€‚</p>
<h3 id="é-use_frameworks">é use_frameworks!</h3>
<h4 id="obj-c-å·¥ç¨‹ä¸-obj-c-pod">Obj-C å·¥ç¨‹ä¸ Obj-C Pod</h4>
<p>ä½¿ç”¨ <code>pod lib create oc-pod</code> å³å¯ä»¥åˆ›å»ºæˆ‘ä»¬çš„ç§æœ‰ Podï¼Œèµ„æºæ–‡ä»¶çš„ç®¡ç†è¿™é‡Œæˆ‘ä»¬å°è¯•ä½¿ç”¨ä¸¤ç§æ–¹å¼ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#75715e"># å°†é€šè¿‡è„šæœ¬å¼•å…¥ï¼ˆå°†ç›´æ¥æŠŠæ–‡ä»¶æœ¬èº«ç§»åŠ¨åˆ°ä¸» Bundle ä¸‹ï¼‰</span>
s<span style="color:#f92672">.</span>resources <span style="color:#f92672">=</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#39;oc-pod/Assets/info.json&#39;</span><span style="color:#f92672">]</span>

<span style="color:#75715e"># å°†åˆ›å»º oc-pod çš„ Bundleï¼ˆå°†æŠŠ Bundle ç§»åŠ¨åˆ°ä¸» Bundle ä¸‹ï¼‰ï¼Œç­‰åŒäº s.resources = [&#39;oc-pod/Assets/oc-pod.bundle&#39;]</span>
s<span style="color:#f92672">.</span>resource_bundles <span style="color:#f92672">=</span> {
    <span style="color:#e6db74">&#39;oc-pod&#39;</span> <span style="color:#f92672">=&gt;</span> <span style="color:#f92672">[</span><span style="color:#e6db74">&#39;oc-pod/Assets/info-bundle.json&#39;</span><span style="color:#f92672">]</span>
}
</code></pre></div><p>è¿™é‡Œæˆ‘ä»¬å°†æ”¾ç½®åœ¨ä¸ oc-demo-project-pod åŒä¸€çˆ¶ç›®å½•ä¸‹ï¼Œå¹¶å°†è¯­è¨€é€‰æ‹© Obj-Cï¼Œéšååœ¨ oc-demo-project-pod ç›®å½•ä¸‹ï¼Œ<code>pod init</code> å¹¶ä»¥è·¯å¾„æŒ‡å®šæ–¹å¼å¼•ç”¨åˆšæ‰åˆ›å»ºçš„ Podï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#75715e"># Uncomment the next line to define a global platform for your project</span>
platform <span style="color:#e6db74">:ios</span>, <span style="color:#e6db74">&#39;13.0&#39;</span>

target <span style="color:#e6db74">&#39;oc-demo-project-pod&#39;</span> <span style="color:#66d9ef">do</span>
  <span style="color:#75715e"># Uncomment the next line if you&#39;re using Swift or would like to use dynamic frameworks</span>
  <span style="color:#75715e"># use_frameworks!</span>

  <span style="color:#75715e"># Pods for oc-demo-project-pod</span>
  pod <span style="color:#e6db74">&#39;oc-pod&#39;</span>, <span style="color:#e6db74">:path</span> <span style="color:#f92672">=&gt;</span> <span style="color:#e6db74">&#39;../oc-pod&#39;</span>
<span style="color:#66d9ef">end</span>

</code></pre></div><p>æˆ‘ä»¬å°†ä¸Šæ–‡å·²æœ‰ä»£ç æ”¾åœ¨ oc-pod çš„ <code>Classes</code> æ–‡ä»¶å¤¹ä¸‹ï¼Œå¹¶å°†èµ„æºæ”¾åœ¨ <code>Assets</code> æ–‡ä»¶å¤¹ä¸‹ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">âœ  oc-pod git:<span style="color:#f92672">(</span>master<span style="color:#f92672">)</span> âœ— tree
.
â”œâ”€â”€ oc-pod
â”‚Â Â  â”œâ”€â”€ Assets  â¡ï¸ èµ„æº
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ info-bundle.json
â”‚Â Â  â”‚Â Â  â””â”€â”€ info.json
â”‚Â Â  â””â”€â”€ Classes â¡ï¸ æºç 
â”‚Â Â      â”œâ”€â”€ NSObject+OC_Pod.h
â”‚Â Â      â”œâ”€â”€ NSObject+OC_Pod.m
â”‚Â Â      â”œâ”€â”€ ObjC_Foo.h
â”‚Â Â      â””â”€â”€ ObjC_Foo.m
â””â”€â”€ oc-pod.podspec

<span style="color:#ae81ff">3</span> directories, <span style="color:#ae81ff">7</span> files

âœ  oc-demo-project-pod git:<span style="color:#f92672">(</span>master<span style="color:#f92672">)</span> âœ— tree
.
â”œâ”€â”€ Podfile
â”œâ”€â”€ Podfile.lock
â”œâ”€â”€ Pods
â”‚Â Â  â”œâ”€â”€ Headers
â”‚Â Â  â”œâ”€â”€ Local<span style="color:#ae81ff">\ </span>Podspecs
â”‚Â Â  â”‚Â Â  â””â”€â”€ oc-pod.podspec.json
â”‚Â Â  â”œâ”€â”€ Manifest.lock
â”‚Â Â  â”œâ”€â”€ Pods.xcodeproj
â”‚Â Â  â””â”€â”€ Target<span style="color:#ae81ff">\ </span>Support<span style="color:#ae81ff">\ </span>Files
â”‚Â Â      â”œâ”€â”€ Pods-oc-demo-project-pod
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ Pods-oc-demo-project-pod-acknowledgements.markdown
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ Pods-oc-demo-project-pod-acknowledgements.plist
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ Pods-oc-demo-project-pod-dummy.m
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ Pods-oc-demo-project-pod-resources.sh â¡ï¸ resources å¤„ç†è„šæœ¬
â”‚Â Â      â”‚Â Â  â”œâ”€â”€ Pods-oc-demo-project-pod.debug.xcconfig
â”‚Â Â      â”‚Â Â  â””â”€â”€ Pods-oc-demo-project-pod.release.xcconfig
â”‚Â Â      â””â”€â”€ oc-pod
â”‚Â Â          â”œâ”€â”€ ResourceBundle-oc-pod-oc-pod-Info.plist
â”‚Â Â          â”œâ”€â”€ oc-pod-dummy.m
â”‚Â Â          â”œâ”€â”€ oc-pod-prefix.pch
â”‚Â Â          â””â”€â”€ oc-pod.xcconfig
â”œâ”€â”€ oc-demo-project-pod
â”œâ”€â”€ oc-demo-project-pod.xcodeproj
â””â”€â”€ oc-demo-project-pod.xcworkspace

<span style="color:#ae81ff">28</span> directories, <span style="color:#ae81ff">42</span> files
</code></pre></div><blockquote>
<p><strong>Tips</strong></p>
<p>CocoaPods ç°åœ¨é»˜è®¤å¼€å¯äº† <code>use_frameworks!</code> é€‰é¡¹ï¼Œå³ä½¿ç”¨ Framework æ–¹å¼é›†æˆï¼Œè¿™é‡Œæˆ‘ä»¬å°†å…ˆå¯¹å…¶è¿›è¡Œæ³¨é‡Šï¼Œçœ‹ä¸‹é <code>use_frameworks!</code> çš„æƒ…å†µã€‚</p>
</blockquote>
<p>æ­¤æ—¶ Pods å·¥ç¨‹å°†åœ¨ä¹‹åä½œä¸ºå•ä¸€çš„é™æ€åº“ä»¥ <code>.a</code> å½¢å¼é›†æˆåˆ°ä¸»å·¥ç¨‹ä¸­ï¼š</p>
<p><img src="/img/2019/libraries_in_ios/13.png" alt="13"></p>
<p>è€Œæˆ‘ä»¬å®šä¹‰åœ¨ Podfile ä¸­çš„ç›¸å…³ä¾èµ–å¦‚ oc-pod å°†ä½œä¸ºç±»ä¼¼ä¸Šæ–‡ä¸­ Cocoa Touch Static Library ä¸€æ ·çš„ Target è¢« Pods å·¥ç¨‹è‡ªèº«ä¾èµ–ï¼š</p>
<p><img src="/img/2019/libraries_in_ios/12.png" alt="12"></p>
<p>Resource Bundle æˆ–è€… <code>s.dependency</code> çš„å­ä¾èµ–å°†è¢« oc-pod ä¾èµ–ï¼š</p>
<p><img src="/img/2019/libraries_in_ios/15.png" alt="15"></p>
<p>å¦‚å‰æ–‡æ‰€è¿°ï¼Œ<code>.a</code> ä»…ä»…åŒ…å«äº†ç¼–è¯‘åçš„ä»£ç ï¼Œé‚£ä¹ˆå®ƒæ‰€ä»¥ä¾èµ–çš„èµ„æºæ–‡ä»¶å°†å¦‚ä½•å¤„ç†å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸Šä¸Šå›¾ä¸­çš„ã€Œ[CP] Copy Pods Resourecesã€æ‰§è¡Œäº†å¦‚ä¸‹çš„è„šæœ¬ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#!/bin/sh
</span><span style="color:#75715e"></span>set -e
set -u
set -o pipefail <span style="color:#75715e"># ä¸€äº›è®¾ç½®</span>

<span style="color:#75715e"># é”™è¯¯å¤„ç†</span>
<span style="color:#66d9ef">function</span> on_error <span style="color:#f92672">{</span>
  echo <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>realpath -mq <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>0<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">:</span>$1<span style="color:#e6db74">: error: Unexpected failure&#34;</span>
<span style="color:#f92672">}</span>
trap <span style="color:#e6db74">&#39;on_error $LINENO&#39;</span> ERR

<span style="color:#75715e"># if [ -z STRING ]; å¦‚æœå­—ç¬¦ä¸² STRING é•¿åº¦ä¸º 0 åˆ™ä¸ºçœŸ</span>
<span style="color:#75715e"># UNLOCALIZED_RESOURCES_FOLDER_PATHï¼ˆæœªæœ¬åœ°åŒ–èµ„æºè·¯å¾„ï¼Œapp åŒ…ï¼‰ï¼šoc-demo-project-pod.app</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -z <span style="color:#e6db74">${</span>UNLOCALIZED_RESOURCES_FOLDER_PATH+x<span style="color:#e6db74">}</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
  <span style="color:#75715e"># If UNLOCALIZED_RESOURCES_FOLDER_PATH is not set, then there&#39;s nowhere for us to copy</span>
  <span style="color:#75715e"># resources to, so exit 0 (signalling the script phase was successful).</span>
  <span style="color:#75715e"># è‹¥ UNLOCALIZED_RESOURCES_FOLDER_PATH æœªè®¾ç½®ï¼Œåˆ™æ— éœ€æ‹·è´èµ„æºå¹¶é€€å‡º</span>
  exit <span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">fi</span>

<span style="color:#75715e"># TARGET_BUILD_DIRï¼ˆç›®æ ‡æ„å»ºç›®å½•ï¼‰ï¼š/Users/kingcos/Library/Developer/Xcode/DerivedData/oc-demo-project-pod-fvrppqpxzudpvicewkjnbszgmrll/Build/Products/Debug-iphonesimulator</span>
<span style="color:#75715e"># é€’å½’åˆ›å»º .app è·¯å¾„</span>
mkdir -p <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TARGET_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>UNLOCALIZED_RESOURCES_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>

<span style="color:#75715e"># RESOURCES_TO_COPYï¼ˆæ¬²æ‹·è´èµ„æºè®°å½•ä¸´æ—¶æ–‡ä»¶ï¼‰ï¼šoc-demo-project-pod/Pods/resources-to-copy-oc-demo-project-pod.txt</span>
RESOURCES_TO_COPY<span style="color:#f92672">=</span><span style="color:#e6db74">${</span>PODS_ROOT<span style="color:#e6db74">}</span>/resources-to-copy-<span style="color:#e6db74">${</span>TARGETNAME<span style="color:#e6db74">}</span>.txt
<span style="color:#75715e"># åˆ›å»ºè¯¥æ–‡ä»¶</span>
&gt; <span style="color:#e6db74">&#34;</span>$RESOURCES_TO_COPY<span style="color:#e6db74">&#34;</span>

XCASSET_FILES<span style="color:#f92672">=()</span>

<span style="color:#75715e"># é˜²æ­¢å¤šä¸ª target åŒæ—¶æ‹·è´ç›¸åŒçš„æ¡†æ¶ä¾èµ–</span>
<span style="color:#75715e"># This protects against multiple targets copying the same framework dependency at the same time. The solution</span>
<span style="color:#75715e"># was originally proposed here: https://lists.samba.org/archive/rsync/2008-February/020158.html</span>
<span style="color:#75715e"># RSYNC_PROTECT_TMP_FILES --filter</span>
RSYNC_PROTECT_TMP_FILES<span style="color:#f92672">=(</span>--filter <span style="color:#e6db74">&#34;P .*.??????&#34;</span><span style="color:#f92672">)</span>

<span style="color:#75715e"># TARGETED_DEVICE_FAMILYï¼ˆç›®æ ‡è®¾å¤‡å®¶æ—ï¼‰ï¼š1,2ï¼ˆiPhone &amp; iPadï¼‰</span>
<span style="color:#66d9ef">case</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TARGETED_DEVICE_FAMILY<span style="color:#66d9ef">:-</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> in
  1,2<span style="color:#f92672">)</span>
    TARGET_DEVICE_ARGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--target-device ipad --target-device iphone&#34;</span>
    ;;
  1<span style="color:#f92672">)</span>
    TARGET_DEVICE_ARGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--target-device iphone&#34;</span>
    ;;
  2<span style="color:#f92672">)</span>
    TARGET_DEVICE_ARGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--target-device ipad&#34;</span>
    ;;
  3<span style="color:#f92672">)</span>
    TARGET_DEVICE_ARGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--target-device tv&#34;</span>
    ;;
  4<span style="color:#f92672">)</span>
    TARGET_DEVICE_ARGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--target-device watch&#34;</span>
    ;;
  *<span style="color:#f92672">)</span>
    TARGET_DEVICE_ARGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;--target-device mac&#34;</span>
    ;;
<span style="color:#66d9ef">esac</span>
<span style="color:#75715e"># TARGET_DEVICE_ARGSï¼ˆç›®æ ‡è®¾å¤‡å‚æ•°ï¼‰ï¼š--target-device ipad --target-device iphoneï¼ˆé»˜è®¤ï¼‰</span>

<span style="color:#75715e"># å®‰è£…èµ„æºå‡½æ•°</span>
install_resource<span style="color:#f92672">()</span>
<span style="color:#f92672">{</span>
  <span style="color:#75715e"># åˆ¤æ–­æ˜¯å¦æ˜¯æ ¹è·¯å¾„ï¼ˆç¬¬ä¸€ä¸ªå‚æ•°å¼€å¤´æœ‰æ—  /ï¼‰ï¼Œéæ ¹è·¯å¾„åˆ™æ·»åŠ  Pods æ ¹è·¯å¾„</span>
  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">=</span> /* <span style="color:#f92672">]]</span> ; <span style="color:#66d9ef">then</span>
    RESOURCE_PATH<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span>
  <span style="color:#66d9ef">else</span>
    RESOURCE_PATH<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>PODS_ROOT<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span>$1<span style="color:#e6db74">&#34;</span>
  <span style="color:#66d9ef">fi</span>

  <span style="color:#75715e"># RESOURCE_PATHï¼ˆèµ„æºè·¯å¾„ï¼‰</span>
  <span style="color:#75715e"># PATH/TO/libraries_in_ios-demo/oc-demo-project-pod/Pods/../../oc-pod/oc-pod/Assets/info.json</span>
  <span style="color:#75715e"># /Users/kingcos/Library/Developer/Xcode/DerivedData/oc-demo-project-pod-aaokquikwvguhaglfagfimosuecy/Build/Products/Debug-iphonesimulator/oc-pod/oc-pod.bundle</span>
  <span style="color:#75715e"># PATH/TO/libraries_in_ios-demo/oc-demo-project-pod/Pods/../../swift-pod/swift-pod/Assets/Localizable.strings</span>
  <span style="color:#75715e"># è‹¥èµ„æºè·¯å¾„ä¸å­˜åœ¨åˆ™æç¤ºå¹¶é€€å‡º</span>
  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> ! -e <span style="color:#e6db74">&#34;</span>$RESOURCE_PATH<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]]</span> ; <span style="color:#66d9ef">then</span>
    cat <span style="color:#e6db74">&lt;&lt; EOM
</span><span style="color:#e6db74">error: Resource &#34;$RESOURCE_PATH&#34; not found. Run &#39;pod install&#39; to update the copy resources script.
</span><span style="color:#e6db74">EOM</span>
    exit <span style="color:#ae81ff">1</span>
  <span style="color:#66d9ef">fi</span>
  <span style="color:#66d9ef">case</span> $RESOURCE_PATH in
    <span style="color:#75715e"># storyboard èµ„æºï¼šç¼–è¯‘ä¸º storyboardc</span>
    *.storyboard<span style="color:#f92672">)</span>
      echo <span style="color:#e6db74">&#34;ibtool --reference-external-strings-file --errors --warnings --notices --minimum-deployment-target </span><span style="color:#e6db74">${</span>!DEPLOYMENT_TARGET_SETTING_NAME<span style="color:#e6db74">}</span><span style="color:#e6db74"> --output-format human-readable-text --compile </span><span style="color:#e6db74">${</span>TARGET_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>UNLOCALIZED_RESOURCES_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">/`basename \&#34;</span>$RESOURCE_PATH<span style="color:#e6db74">\&#34; .storyboard`.storyboardc </span>$RESOURCE_PATH<span style="color:#e6db74"> --sdk </span><span style="color:#e6db74">${</span>SDKROOT<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${</span>TARGET_DEVICE_ARGS<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">||</span> true
      ibtool --reference-external-strings-file --errors --warnings --notices --minimum-deployment-target <span style="color:#e6db74">${</span>!DEPLOYMENT_TARGET_SETTING_NAME<span style="color:#e6db74">}</span> --output-format human-readable-text --compile <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TARGET_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>UNLOCALIZED_RESOURCES_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">/`basename \&#34;</span>$RESOURCE_PATH<span style="color:#e6db74">\&#34; .storyboard`.storyboardc&#34;</span> <span style="color:#e6db74">&#34;</span>$RESOURCE_PATH<span style="color:#e6db74">&#34;</span> --sdk <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>SDKROOT<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">${</span>TARGET_DEVICE_ARGS<span style="color:#e6db74">}</span>
      ;;
    <span style="color:#75715e"># xib èµ„æºï¼šç¼–è¯‘ä¸º nib</span>
    *.xib<span style="color:#f92672">)</span>
      echo <span style="color:#e6db74">&#34;ibtool --reference-external-strings-file --errors --warnings --notices --minimum-deployment-target </span><span style="color:#e6db74">${</span>!DEPLOYMENT_TARGET_SETTING_NAME<span style="color:#e6db74">}</span><span style="color:#e6db74"> --output-format human-readable-text --compile </span><span style="color:#e6db74">${</span>TARGET_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>UNLOCALIZED_RESOURCES_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">/`basename \&#34;</span>$RESOURCE_PATH<span style="color:#e6db74">\&#34; .xib`.nib </span>$RESOURCE_PATH<span style="color:#e6db74"> --sdk </span><span style="color:#e6db74">${</span>SDKROOT<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${</span>TARGET_DEVICE_ARGS<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">||</span> true
      ibtool --reference-external-strings-file --errors --warnings --notices --minimum-deployment-target <span style="color:#e6db74">${</span>!DEPLOYMENT_TARGET_SETTING_NAME<span style="color:#e6db74">}</span> --output-format human-readable-text --compile <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TARGET_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>UNLOCALIZED_RESOURCES_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">/`basename \&#34;</span>$RESOURCE_PATH<span style="color:#e6db74">\&#34; .xib`.nib&#34;</span> <span style="color:#e6db74">&#34;</span>$RESOURCE_PATH<span style="color:#e6db74">&#34;</span> --sdk <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>SDKROOT<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">${</span>TARGET_DEVICE_ARGS<span style="color:#e6db74">}</span>
      ;;
    *.framework<span style="color:#f92672">)</span>
      echo <span style="color:#e6db74">&#34;mkdir -p </span><span style="color:#e6db74">${</span>TARGET_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>FRAMEWORKS_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">||</span> true
      mkdir -p <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TARGET_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>FRAMEWORKS_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
      echo <span style="color:#e6db74">&#34;rsync --delete -av &#34;</span><span style="color:#e6db74">${</span>RSYNC_PROTECT_TMP_FILES[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34; </span>$RESOURCE_PATH<span style="color:#e6db74"> </span><span style="color:#e6db74">${</span>TARGET_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>FRAMEWORKS_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">||</span> true
      rsync --delete -av <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>RSYNC_PROTECT_TMP_FILES[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span>$RESOURCE_PATH<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TARGET_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>FRAMEWORKS_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
      ;;
    *.xcdatamodel<span style="color:#f92672">)</span>
      echo <span style="color:#e6db74">&#34;xcrun momc \&#34;</span>$RESOURCE_PATH<span style="color:#e6db74">\&#34; \&#34;</span><span style="color:#e6db74">${</span>TARGET_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>UNLOCALIZED_RESOURCES_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">/`basename &#34;</span>$RESOURCE_PATH<span style="color:#e6db74">&#34;`.mom\&#34;&#34;</span> <span style="color:#f92672">||</span> true
      xcrun momc <span style="color:#e6db74">&#34;</span>$RESOURCE_PATH<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TARGET_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>UNLOCALIZED_RESOURCES_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">/`basename &#34;</span>$RESOURCE_PATH<span style="color:#e6db74">&#34; .xcdatamodel`.mom&#34;</span>
      ;;
    *.xcdatamodeld<span style="color:#f92672">)</span>
      echo <span style="color:#e6db74">&#34;xcrun momc \&#34;</span>$RESOURCE_PATH<span style="color:#e6db74">\&#34; \&#34;</span><span style="color:#e6db74">${</span>TARGET_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>UNLOCALIZED_RESOURCES_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">/`basename &#34;</span>$RESOURCE_PATH<span style="color:#e6db74">&#34; .xcdatamodeld`.momd\&#34;&#34;</span> <span style="color:#f92672">||</span> true
      xcrun momc <span style="color:#e6db74">&#34;</span>$RESOURCE_PATH<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TARGET_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>UNLOCALIZED_RESOURCES_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">/`basename &#34;</span>$RESOURCE_PATH<span style="color:#e6db74">&#34; .xcdatamodeld`.momd&#34;</span>
      ;;
    *.xcmappingmodel<span style="color:#f92672">)</span>
      echo <span style="color:#e6db74">&#34;xcrun mapc \&#34;</span>$RESOURCE_PATH<span style="color:#e6db74">\&#34; \&#34;</span><span style="color:#e6db74">${</span>TARGET_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>UNLOCALIZED_RESOURCES_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">/`basename &#34;</span>$RESOURCE_PATH<span style="color:#e6db74">&#34; .xcmappingmodel`.cdm\&#34;&#34;</span> <span style="color:#f92672">||</span> true
      xcrun mapc <span style="color:#e6db74">&#34;</span>$RESOURCE_PATH<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TARGET_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>UNLOCALIZED_RESOURCES_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">/`basename &#34;</span>$RESOURCE_PATH<span style="color:#e6db74">&#34; .xcmappingmodel`.cdm&#34;</span>
      ;;
    *.xcassets<span style="color:#f92672">)</span>
      ABSOLUTE_XCASSET_FILE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$RESOURCE_PATH<span style="color:#e6db74">&#34;</span>
      XCASSET_FILES<span style="color:#f92672">+=(</span><span style="color:#e6db74">&#34;</span>$ABSOLUTE_XCASSET_FILE<span style="color:#e6db74">&#34;</span><span style="color:#f92672">)</span>
      ;;
    <span style="color:#75715e"># å…¶å®ƒï¼Œæ¯”å¦‚ bundle / json</span>
    *<span style="color:#f92672">)</span>
      echo <span style="color:#e6db74">&#34;</span>$RESOURCE_PATH<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">||</span> true
      <span style="color:#75715e"># å°†èµ„æºè·¯å¾„å†™å…¥æ¬²æ‹·è´èµ„æºè®°å½•ä¸´æ—¶æ–‡ä»¶ä¸­</span>
      echo <span style="color:#e6db74">&#34;</span>$RESOURCE_PATH<span style="color:#e6db74">&#34;</span> &gt;&gt; <span style="color:#e6db74">&#34;</span>$RESOURCES_TO_COPY<span style="color:#e6db74">&#34;</span>
      ;;
  <span style="color:#66d9ef">esac</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e"># CONFIGURATIONï¼šè¿è¡Œçš„ scheme é…ç½®æ¨¡å¼ï¼ŒDebug æˆ– Release</span>
<span style="color:#75715e"># ç›®å‰ Debug å’Œ Release æ¨¡å¼å¤„ç†ä¸€è‡´</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span>$CONFIGURATION<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Debug&#34;</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
  install_resource <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>PODS_ROOT<span style="color:#e6db74">}</span><span style="color:#e6db74">/../../oc-pod/oc-pod/Assets/info.json&#34;</span>
  install_resource <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>PODS_CONFIGURATION_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/oc-pod/oc-pod.bundle&#34;</span>
  install_resource <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>PODS_ROOT<span style="color:#e6db74">}</span><span style="color:#e6db74">/../../swift-pod/swift-pod/Assets/Localizable.strings&#34;</span>
<span style="color:#66d9ef">fi</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span>$CONFIGURATION<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Release&#34;</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
  install_resource <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>PODS_ROOT<span style="color:#e6db74">}</span><span style="color:#e6db74">/../../oc-pod/oc-pod/Assets/info.json&#34;</span>
  install_resource <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>PODS_CONFIGURATION_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/oc-pod/oc-pod.bundle&#34;</span>
  install_resource <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>PODS_ROOT<span style="color:#e6db74">}</span><span style="color:#e6db74">/../../swift-pod/swift-pod/Assets/Localizable.strings&#34;</span>
<span style="color:#66d9ef">fi</span>

<span style="color:#75715e"># å†æ¬¡å°è¯•ç¡®ä¿åŒä¸€æ–‡ä»¶å¤¹åˆ›å»º</span>
mkdir -p <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TARGET_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>UNLOCALIZED_RESOURCES_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>

<span style="color:#75715e"># rsyncï¼šå¿«é€Ÿã€å¤šåŠŸèƒ½ã€è¿œç¨‹ï¼ˆå’Œæœ¬åœ°ï¼‰æ–‡ä»¶å¤åˆ¶å·¥å…·ï¼Œ-aï¼šä¿ç•™æ‰€æœ‰ï¼›-vï¼šè¾“å‡ºä¿¡æ¯ï¼›-rï¼šé€’å½’ï¼›</span>
<span style="color:#75715e"># --copy-linksï¼šå½“é‡åˆ°ç¬¦å·é“¾æ¥æ—¶ï¼ŒæŒ‡å‘çš„é¡¹ç›®ï¼ˆå¼•ç”¨ï¼‰è¢«å¤åˆ¶ï¼Œè€Œä¸æ˜¯ç¬¦å·é“¾æ¥ï¼›</span>
<span style="color:#75715e"># --no-relativeï¼šéç›¸å¯¹è·¯å¾„ï¼Œå³ç»å¯¹è·¯å¾„</span>
<span style="color:#75715e"># --excludeï¼šæ’é™¤æŸä¸ªæ¨¡å¼çš„ç›®å½•</span>
<span style="color:#75715e"># --files-fromï¼šæ–‡ä»¶æ¥æº</span>
<span style="color:#75715e"># /ï¼šæ–‡ä»¶ç›®çš„</span>
rsync -avr --copy-links --no-relative --exclude <span style="color:#e6db74">&#39;*/.svn/*&#39;</span> --files-from<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$RESOURCES_TO_COPY<span style="color:#e6db74">&#34;</span> / <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TARGET_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>UNLOCALIZED_RESOURCES_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>

<span style="color:#75715e"># ACTIONï¼ˆè¡Œä¸ºï¼‰ï¼šæ„å»ºå³ buildï¼Œä¸å¤ªæ¸…æ¥šä½•æ—¶ä¸º install</span>
<span style="color:#75715e"># SKIP_INSTALLï¼ˆæ˜¯å¦è·³è¿‡å®‰è£…ï¼‰ï¼šå¦ä¸º NO</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>ACTION<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;install&#34;</span> <span style="color:#f92672">]]</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>SKIP_INSTALL<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;NO&#34;</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
  mkdir -p <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>INSTALL_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>UNLOCALIZED_RESOURCES_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
  rsync -avr --copy-links --no-relative --exclude <span style="color:#e6db74">&#39;*/.svn/*&#39;</span> --files-from<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$RESOURCES_TO_COPY<span style="color:#e6db74">&#34;</span> / <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>INSTALL_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>UNLOCALIZED_RESOURCES_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
<span style="color:#66d9ef">fi</span>

<span style="color:#75715e"># åˆ é™¤å­˜å‚¨èµ„æºè·¯å¾„çš„ä¸´æ—¶æ–‡ä»¶</span>
rm -f <span style="color:#e6db74">&#34;</span>$RESOURCES_TO_COPY<span style="color:#e6db74">&#34;</span>

<span style="color:#75715e"># WRAPPER_EXTENSIONï¼ˆæ‰©å±•ï¼‰ï¼šapp</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>WRAPPER_EXTENSION<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]]</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;`xcrun --find actool`&#34;</span> <span style="color:#f92672">]</span> <span style="color:#f92672">&amp;&amp;</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>XCASSET_FILES<span style="color:#66d9ef">:-</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>
<span style="color:#66d9ef">then</span>
  <span style="color:#75715e"># Find all other xcassets (this unfortunately includes those of path pods and other targets).</span>
  <span style="color:#75715e"># æŸ¥æ‰¾å…¶ä»–æ‰€æœ‰ xcassets</span>
  OTHER_XCASSETS<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>find <span style="color:#e6db74">&#34;</span>$PWD<span style="color:#e6db74">&#34;</span> -iname <span style="color:#e6db74">&#34;*.xcassets&#34;</span> -type d<span style="color:#66d9ef">)</span>
  <span style="color:#66d9ef">while</span> read line; <span style="color:#66d9ef">do</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> $line !<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>PODS_ROOT<span style="color:#e6db74">}</span><span style="color:#e6db74">*&#34;</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
      XCASSET_FILES<span style="color:#f92672">+=(</span><span style="color:#e6db74">&#34;</span>$line<span style="color:#e6db74">&#34;</span><span style="color:#f92672">)</span>
    <span style="color:#66d9ef">fi</span>
  <span style="color:#66d9ef">done</span> <span style="color:#f92672">&lt;&lt;&lt;</span><span style="color:#e6db74">&#34;</span>$OTHER_XCASSETS<span style="color:#e6db74">&#34;</span>

  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -z <span style="color:#e6db74">${</span>ASSETCATALOG_COMPILER_APPICON_NAME+x<span style="color:#e6db74">}</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
    printf <span style="color:#e6db74">&#34;%s\0&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>XCASSET_FILES[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> | xargs -0 xcrun actool --output-format human-readable-text --notices --warnings --platform <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>PLATFORM_NAME<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> --minimum-deployment-target <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>!DEPLOYMENT_TARGET_SETTING_NAME<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">${</span>TARGET_DEVICE_ARGS<span style="color:#e6db74">}</span> --compress-pngs --compile <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>BUILT_PRODUCTS_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>UNLOCALIZED_RESOURCES_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
  <span style="color:#66d9ef">else</span>
    printf <span style="color:#e6db74">&#34;%s\0&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>XCASSET_FILES[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> | xargs -0 xcrun actool --output-format human-readable-text --notices --warnings --platform <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>PLATFORM_NAME<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> --minimum-deployment-target <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>!DEPLOYMENT_TARGET_SETTING_NAME<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">${</span>TARGET_DEVICE_ARGS<span style="color:#e6db74">}</span> --compress-pngs --compile <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>BUILT_PRODUCTS_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>UNLOCALIZED_RESOURCES_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> --app-icon <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>ASSETCATALOG_COMPILER_APPICON_NAME<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> --output-partial-info-plist <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TARGET_TEMP_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/assetcatalog_generated_info_cocoapods.plist&#34;</span>
  <span style="color:#66d9ef">fi</span>
<span style="color:#66d9ef">fi</span>
</code></pre></div><p>å› æ­¤æœ€ç»ˆçš„ <code>oc-demo-project-pod.app</code> ç»“æ„å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">âœ  oc-demo-project-pod.app tree
.
â”œâ”€â”€ Base.lproj
â”‚Â Â  â”œâ”€â”€ LaunchScreen.storyboardc
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ 01J-lp-oVM-view-Ze5-6b-2t3.nib
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ Info.plist
â”‚Â Â  â”‚Â Â  â””â”€â”€ UIViewController-01J-lp-oVM.nib
â”‚Â Â  â””â”€â”€ Main.storyboardc
â”‚Â Â      â”œâ”€â”€ BYZ-38-t0r-view-8bC-Xf-vdC.nib
â”‚Â Â      â”œâ”€â”€ Info.plist
â”‚Â Â      â””â”€â”€ UIViewController-BYZ-38-t0r.nib
â”œâ”€â”€ Info.plist
â”œâ”€â”€ PkgInfo
â”œâ”€â”€ _CodeSignature
â”‚Â Â  â””â”€â”€ CodeResources
â”œâ”€â”€ info.json  â¡ï¸ è„šæœ¬æ‹·è´ï¼ˆs.resourcesï¼‰è‡³æ­¤
â”œâ”€â”€ oc-demo-project-pod â¡ï¸ å¯æ‰§è¡Œ Mach-O æ–‡ä»¶
â””â”€â”€ oc-pod.bundle â¡ï¸ è„šæœ¬æ‹·è´ï¼ˆs.resource_bundlesï¼‰è‡³æ­¤
    â”œâ”€â”€ Info.plist
    â”œâ”€â”€ _CodeSignature
    â”‚Â Â  â”œâ”€â”€ CodeDirectory
    â”‚Â Â  â”œâ”€â”€ CodeRequirements
    â”‚Â Â  â”œâ”€â”€ CodeRequirements-1
    â”‚Â Â  â”œâ”€â”€ CodeResources
    â”‚Â Â  â””â”€â”€ CodeSignature
    â”œâ”€â”€ info-bundle.json
    â””â”€â”€ oc-pod.json

<span style="color:#ae81ff">6</span> directories, <span style="color:#ae81ff">19</span> files
</code></pre></div><p>èµ„æºæ–‡ä»¶ Bundle ä»¥åŠ JSON æ–‡ä»¶è¢«åŸå°ä¸åŠ¨åœ°æŒªåŠ¨åˆ° <code>oc-demo-project-pod.app</code> ä¸‹ï¼Œè€Œç¬¬ä¸‰æ–¹å’Œ Pods ä¸­ä»‹çš„ <code>.a</code> å°±å·²ç»è¢«æ‰“å…¥äº†å¯æ‰§è¡Œæ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>nm</code> å°è¯•æ‰“å°å…¶ä¸­çš„ç¬¦å·ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">âœ  oc-demo-project-pod.app nm oc-demo-project-pod | grep ObjC_Foo
0000000100038a50 t -<span style="color:#f92672">[</span>ObjC_Foo foo<span style="color:#f92672">]</span>
0000000100038b00 t -<span style="color:#f92672">[</span>ObjC_Foo resources<span style="color:#f92672">]</span>
<span style="color:#ae81ff">0000000100053220</span> S _OBJC_CLASS_$_ObjC_Foo
00000001000531f8 S _OBJC_METACLASS_$_ObjC_Foo

âœ  oc-demo-project-pod.app nm oc-demo-project-pod | grep Pods
0000000100052b90 S _OBJC_CLASS_$_PodsDummy_AFNetworking
00000001000532c0 S _OBJC_CLASS_$_PodsDummy_Pods_oc_demo_project_pod
<span style="color:#ae81ff">0000000100053270</span> S _OBJC_CLASS_$_PodsDummy_oc_pod
0000000100052b68 S _OBJC_METACLASS_$_PodsDummy_AFNetworking
<span style="color:#ae81ff">0000000100053298</span> S _OBJC_METACLASS_$_PodsDummy_Pods_oc_demo_project_pod
<span style="color:#ae81ff">0000000100053248</span> S _OBJC_METACLASS_$_PodsDummy_oc_pod
</code></pre></div><p>è™½ç„¶èµ„æºå‡è¢«æ‹·è´åˆ°äº† <code>.app</code> ä¸‹ï¼Œä½†åœ¨ä»£ç ä¸­ç›¸åº”çš„è·å–æ–¹å¼å´æœ‰ä¸€å®šå·®åˆ«ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objectivec" data-lang="objectivec">- (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">resources</span> {
    <span style="color:#75715e">// s.resources
</span><span style="color:#75715e"></span>    NSBundle <span style="color:#f92672">*</span>bundle <span style="color:#f92672">=</span> [NSBundle bundleForClass:[self <span style="color:#66d9ef">class</span>]];
    NSString <span style="color:#f92672">*</span>path <span style="color:#f92672">=</span> [bundle pathForResource:<span style="color:#e6db74">@&#34;info&#34;</span> ofType:<span style="color:#e6db74">@&#34;json&#34;</span>];
    NSData <span style="color:#f92672">*</span>data <span style="color:#f92672">=</span> [NSData dataWithContentsOfFile:path];

    <span style="color:#66d9ef">if</span> (data) {
        NSDictionary <span style="color:#f92672">*</span>dict <span style="color:#f92672">=</span> [NSJSONSerialization JSONObjectWithData:data options:NSJSONReadingMutableContainers error:nil];
        NSLog(<span style="color:#e6db74">@&#34;%@ - %@&#34;</span>, dict[<span style="color:#e6db74">@&#34;blog&#34;</span>], dict[<span style="color:#e6db74">@&#34;github&#34;</span>]);
    }

    <span style="color:#75715e">// s.resource_bundles
</span><span style="color:#75715e"></span>    NSBundle <span style="color:#f92672">*</span>bundle2 <span style="color:#f92672">=</span> [NSBundle bundleWithPath:[[NSBundle mainBundle] pathForResource:<span style="color:#e6db74">@&#34;oc-pod&#34;</span> ofType:<span style="color:#e6db74">@&#34;bundle&#34;</span>]];
    NSString <span style="color:#f92672">*</span>path2 <span style="color:#f92672">=</span> [bundle2 pathForResource:<span style="color:#e6db74">@&#34;oc-pod&#34;</span> ofType:<span style="color:#e6db74">@&#34;json&#34;</span>];
    NSData <span style="color:#f92672">*</span>data2 <span style="color:#f92672">=</span> [NSData dataWithContentsOfFile:path2];

    <span style="color:#66d9ef">if</span> (data2) {
        NSDictionary <span style="color:#f92672">*</span>dict <span style="color:#f92672">=</span> [NSJSONSerialization JSONObjectWithData:data options:NSJSONReadingMutableContainers error:nil];
        NSLog(<span style="color:#e6db74">@&#34;%@ - %@&#34;</span>, dict[<span style="color:#e6db74">@&#34;blog&#34;</span>], dict[<span style="color:#e6db74">@&#34;github&#34;</span>]);
    }
}
</code></pre></div><h4 id="obj-c-å·¥ç¨‹ä¸-swift-pod">Obj-C å·¥ç¨‹ä¸ Swift Pod</h4>
<p>åœ¨ Obj-C å·¥ç¨‹ä¸‹å¼•å…¥ Swift Pod ä¸ Obj-C Pod å¹¶æ— å¤ªå¤šå·®åˆ«ã€‚ä¸è¿‡æœ‰æ—¶å¯èƒ½ä¼šé‡åˆ° CocoaPods æç¤ºä¸‹é¢è¿™ä¸ªé—®é¢˜ï¼Œæˆ–è€…åœ¨ç¼–è¯‘æ—¶æç¤ºæ‰¾ä¸åˆ°è®¸å¤š Swift ç›¸å…³çš„ç¬¦å·ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#f92672">[</span>!<span style="color:#f92672">]</span> Unable to determine Swift version <span style="color:#66d9ef">for</span> the following pods:

- <span style="color:#e6db74">`</span>swift-pod<span style="color:#e6db74">`</span> does not specify a Swift version and none of the targets <span style="color:#f92672">(</span><span style="color:#e6db74">`</span>oc-demo-project-pod<span style="color:#e6db74">`</span><span style="color:#f92672">)</span> integrating it have the <span style="color:#e6db74">`</span>SWIFT_VERSION<span style="color:#e6db74">`</span> attribute set. Please contact the author or set the <span style="color:#e6db74">`</span>SWIFT_VERSION<span style="color:#e6db74">`</span> attribute in at least one of the targets that integrate this pod.
</code></pre></div><p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥åœ¨ Obj-C å·¥ç¨‹ä¸­æ–°å»ºä¸€ä¸ªå ä½ Swift æ–‡ä»¶å³å¯ä½¿å…¶è·å¾— Swift èƒ½åŠ›ï¼š</p>
<p><img src="/img/2019/libraries_in_ios/14.png" alt="14"></p>
<p>å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒSwift Pod å¼•å…¥æ—¶éœ€è¦ä½¿ç”¨ <code>@import</code>ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objectivec" data-lang="objectivec">@import swift_pod;

<span style="color:#66d9ef">@implementation</span> <span style="color:#a6e22e">ViewController</span>
- (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">viewDidLoad</span> {
    [super viewDidLoad];

    [[[Swift_Foo alloc] init] foo];
    NSLog(<span style="color:#e6db74">@&#34;%@&#34;</span>, [[[Swift_Foo alloc] init] strings]);
}
<span style="color:#66d9ef">@end</span>
</code></pre></div><h4 id="swift-å·¥ç¨‹ä¸-obj-c-pod">Swift å·¥ç¨‹ä¸ Obj-C Pod</h4>
<p>Swift å·¥ç¨‹ä¾èµ– Obj-C Pod çš„æ–¹å¼ä¸ Obj-C å·¥ç¨‹ä¸€è‡´ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥åœ¨ Swift ä»£ç ä¸­ <code>import</code> Obj-C Podã€‚è¿™é‡Œä¹Ÿéœ€è¦æ¡¥æ¥æ–‡ä»¶æ¥å¼•å…¥ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»º Obj-C ç±»å‹çš„å ä½æ–‡ä»¶ï¼Œå¹¶åˆ›å»ºæ¡¥æ¥æ–‡ä»¶ï¼Œåœ¨å…¶ä¸­å¼•å…¥æš´éœ²ç»™ Swift å·¥ç¨‹çš„å¤´æ–‡ä»¶ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objectivec" data-lang="objectivec"><span style="color:#75715e">//
</span><span style="color:#75715e">//  Use this file to import your target&#39;s public headers that you would like to expose to Swift.
</span><span style="color:#75715e">//
</span><span style="color:#75715e"></span>
<span style="color:#75715e">#import &lt;oc-pod/ObjC_Foo.h&gt;
</span></code></pre></div><p>è¿™æ ·å³å¯åœ¨ Swift å·¥ç¨‹ä¸­ä½¿ç”¨ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">UIKit</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ViewController</span>: UIViewController {
    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">viewDidLoad</span>() {
        <span style="color:#66d9ef">super</span>.viewDidLoad()

        ObjC_Foo().foo()
    }
}
</code></pre></div><p>å¯¹äºåŒæ ·æœªå¼€å¯ <code>use_frameworks</code> çš„ Swift å·¥ç¨‹æ¥è¯´ï¼ŒCocoaPods å¤„ç†èµ„æºçš„è„šæœ¬å’Œé€»è¾‘æ˜¯ä¸€è‡´çš„ã€‚</p>
<h4 id="swift-å·¥ç¨‹ä¸-swift-pod">Swift å·¥ç¨‹ä¸ Swift Pod</h4>
<p>Swift å·¥ç¨‹ä¾èµ– Swift Pod çš„æ–¹å¼åˆ™æ›´åŠ ç®€å•ï¼Œåªéœ€è¦ä½¿ç”¨ <code>import</code> å¼•å…¥ Pod å³å¯ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">swift_pod</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ViewController</span>: UIViewController {
    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">viewDidLoad</span>() {
        <span style="color:#66d9ef">super</span>.viewDidLoad()

        Swift_Foo().foo()
        print(Swift_Foo().strings())
    }
}
</code></pre></div><h3 id="use_frameworks">use_frameworks!</h3>
<h4 id="obj-c-å·¥ç¨‹-1">Obj-C å·¥ç¨‹</h4>
<p>å°† <code>use_frameworks!</code> å¼€å¯æ—¶ï¼ŒPods å·¥ç¨‹å°†ä»¥æ¡†æ¶æ–¹å¼ä¾èµ–ï¼š</p>
<p><img src="/img/2019/libraries_in_ios/16.png" alt="16"></p>
<p>åœ¨ä¸Šé¢æˆ‘ä»¬äº†è§£è¿‡ Frameworkï¼Œå…¶ä¸­èšåˆäº†å¯æ‰§è¡Œæ–‡ä»¶ä»¥åŠèµ„æºç­‰æ–‡ä»¶ï¼Œå› æ­¤å…¶ä¸€èˆ¬ä¸å†éœ€è¦å•ç‹¬çš„è„šæœ¬æ¥å¤„ç†èµ„æºï¼Œè€Œæ˜¯éœ€è¦ã€Œ[CP] Embed Pods Frameworksã€æ¥é’ˆå¯¹ Framework è¿›è¡Œæ“ä½œï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e">#!/bin/sh
</span><span style="color:#75715e"></span>set -e
set -u
set -o pipefail <span style="color:#75715e"># ä¸€äº›è®¾ç½®</span>

<span style="color:#75715e"># é”™è¯¯å¤„ç†</span>
<span style="color:#66d9ef">function</span> on_error <span style="color:#f92672">{</span>
  echo <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>realpath -mq <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>0<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">:</span>$1<span style="color:#e6db74">: error: Unexpected failure&#34;</span>
<span style="color:#f92672">}</span>
trap <span style="color:#e6db74">&#39;on_error $LINENO&#39;</span> ERR

<span style="color:#75715e"># FRAMEWORKS_FOLDER_PATHï¼ˆæ¡†æ¶æ–‡ä»¶å¤¹è·¯å¾„ï¼‰ï¼šoc-demo-project-pod.app/Frameworks</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -z <span style="color:#e6db74">${</span>FRAMEWORKS_FOLDER_PATH+x<span style="color:#e6db74">}</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
  <span style="color:#75715e"># If FRAMEWORKS_FOLDER_PATH is not set, then there&#39;s nowhere for us to copy</span>
  <span style="color:#75715e"># frameworks to, so exit 0 (signalling the script phase was successful).</span>
  <span style="color:#75715e"># FRAMEWORKS_FOLDER_PATH æœªè®¾ç½®ï¼Œåˆ™æ— éœ€æ‹·è´èµ„æºå¹¶é€€å‡º</span>
  exit <span style="color:#ae81ff">0</span>
<span style="color:#66d9ef">fi</span>

<span style="color:#75715e"># CONFIGURATION_BUILD_DIRï¼ˆé…ç½®æ„å»ºç›®å½•ï¼‰ï¼š/Users/kingcos/Library/Developer/Xcode/DerivedData/oc-demo-project-pod-gmhizsqflcuavpebfzsfyychzzuj/Build/Products/Debug-iphonesimulator</span>
<span style="color:#75715e"># é€’å½’åˆ›å»ºæ¡†æ¶è·¯å¾„</span>
echo <span style="color:#e6db74">&#34;mkdir -p </span><span style="color:#e6db74">${</span>CONFIGURATION_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>FRAMEWORKS_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
mkdir -p <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>CONFIGURATION_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>FRAMEWORKS_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>

<span style="color:#75715e"># COCOAPODS_PARALLEL_CODE_SIGNï¼ˆCocoaPods å¹¶è¡Œç­¾åï¼‰ï¼šfalseï¼ˆé»˜è®¤ï¼‰</span>
COCOAPODS_PARALLEL_CODE_SIGN<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>COCOAPODS_PARALLEL_CODE_SIGN<span style="color:#66d9ef">:-</span>false<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>

<span style="color:#75715e"># DT_TOOLCHAIN_DIRï¼ˆå·¥å…·é“¾ç›®å½•ï¼‰ï¼š/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain</span>
<span style="color:#75715e"># PLATFORM_NAMEï¼ˆç›®æ ‡å¹³å°åï¼‰ï¼šiphonesimulator</span>
<span style="color:#75715e"># SWIFT_STDLIB_PATHï¼ˆSwift æ ‡å‡†åº“è·¯å¾„ï¼‰ï¼š/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/lib/swift/iphonesimulator</span>
SWIFT_STDLIB_PATH<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>DT_TOOLCHAIN_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/usr/lib/swift/</span><span style="color:#e6db74">${</span>PLATFORM_NAME<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>

<span style="color:#75715e"># Used as a return value for each invocation of `strip_invalid_archs` function.</span>
<span style="color:#75715e"># ä½œä¸ºæ¯æ¬¡è°ƒç”¨ strip_invalid_archs å‡½æ•°çš„è¿”å›å€¼</span>
STRIP_BINARY_RETVAL<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>

<span style="color:#75715e"># é˜²æ­¢å¤šä¸ª target åŒæ—¶æ‹·è´ç›¸åŒçš„æ¡†æ¶ä¾èµ–</span>
<span style="color:#75715e"># This protects against multiple targets copying the same framework dependency at the same time. The solution</span>
<span style="color:#75715e"># was originally proposed here: https://lists.samba.org/archive/rsync/2008-February/020158.html</span>
RSYNC_PROTECT_TMP_FILES<span style="color:#f92672">=(</span>--filter <span style="color:#e6db74">&#34;P .*.??????&#34;</span><span style="color:#f92672">)</span>

<span style="color:#75715e"># Copies and strips a vendored framework</span>
<span style="color:#75715e"># æ‹·è´å¹¶åˆ é™¤ vendored æ¡†æ¶</span>
install_framework<span style="color:#f92672">()</span>
<span style="color:#f92672">{</span>
  <span style="color:#75715e"># BUILT_PRODUCTS_DIRï¼ˆæ„å»ºäº§ç‰©ç›®å½•ï¼‰ï¼š/Users/kingcos/Library/Developer/Xcode/DerivedData/oc-demo-project-pod-gmhizsqflcuavpebfzsfyychzzuj/Build/Products/Debug-iphonesimulator</span>
  <span style="color:#75715e"># if [ -r FILE ]; å¦‚æœæ–‡ä»¶ FILE å¯è¯»ï¼ˆrï¼šreadï¼‰åˆ™ä¸ºçœŸ</span>
  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -r <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>BUILT_PRODUCTS_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span>$1<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
    local source<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>BUILT_PRODUCTS_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span>$1<span style="color:#e6db74">&#34;</span>
  <span style="color:#66d9ef">elif</span> <span style="color:#f92672">[</span> -r <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>BUILT_PRODUCTS_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#66d9ef">$(</span>basename <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
    local source<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>BUILT_PRODUCTS_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#66d9ef">$(</span>basename <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
  <span style="color:#66d9ef">elif</span> <span style="color:#f92672">[</span> -r <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
    local source<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span>
  <span style="color:#66d9ef">fi</span>

  local destination<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>TARGET_BUILD_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>FRAMEWORKS_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>

  <span style="color:#75715e"># if [ -L FILE ]; å¦‚æœæ–‡ä»¶ FILE æ˜¯é“¾æ¥ï¼ˆLï¼šLinkï¼‰æ–‡ä»¶åˆ™ä¸ºçœŸ</span>
  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -L <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>source<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
    echo <span style="color:#e6db74">&#34;Symlinked...&#34;</span>
    <span style="color:#75715e"># è¯»å–é“¾æ¥çš„çœŸå®æ–‡ä»¶</span>
    source<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>readlink <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>source<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
  <span style="color:#66d9ef">fi</span>

  <span style="color:#75715e"># Use filter instead of exclude so missing patterns don&#39;t throw errors.</span>
  echo <span style="color:#e6db74">&#34;rsync --delete -av &#34;</span><span style="color:#e6db74">${</span>RSYNC_PROTECT_TMP_FILES[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34; --filter \&#34;- CVS/\&#34; --filter \&#34;- .svn/\&#34; --filter \&#34;- .git/\&#34; --filter \&#34;- .hg/\&#34; --filter \&#34;- Headers\&#34; --filter \&#34;- PrivateHeaders\&#34; --filter \&#34;- Modules\&#34; \&#34;</span><span style="color:#e6db74">${</span>source<span style="color:#e6db74">}</span><span style="color:#e6db74">\&#34; \&#34;</span><span style="color:#e6db74">${</span>destination<span style="color:#e6db74">}</span><span style="color:#e6db74">\&#34;&#34;</span>
  rsync --delete -av <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>RSYNC_PROTECT_TMP_FILES[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> --filter <span style="color:#e6db74">&#34;- CVS/&#34;</span> --filter <span style="color:#e6db74">&#34;- .svn/&#34;</span> --filter <span style="color:#e6db74">&#34;- .git/&#34;</span> --filter <span style="color:#e6db74">&#34;- .hg/&#34;</span> --filter <span style="color:#e6db74">&#34;- Headers&#34;</span> --filter <span style="color:#e6db74">&#34;- PrivateHeaders&#34;</span> --filter <span style="color:#e6db74">&#34;- Modules&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>source<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>destination<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>

  local basename
  <span style="color:#75715e"># basenameï¼ˆåŸºæœ¬åï¼‰ï¼šAFNetworking / oc_pod / swift_pod</span>
  <span style="color:#75715e"># binaryï¼ˆäºŒè¿›åˆ¶è·¯å¾„ï¼‰</span>
  basename<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>basename -s .framework <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
  binary<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>destination<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>basename<span style="color:#e6db74">}</span><span style="color:#e6db74">.framework/</span><span style="color:#e6db74">${</span>basename<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>

  <span style="color:#66d9ef">if</span> ! <span style="color:#f92672">[</span> -r <span style="color:#e6db74">&#34;</span>$binary<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
    binary<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>destination<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>basename<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
  <span style="color:#66d9ef">elif</span> <span style="color:#f92672">[</span> -L <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>binary<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
    echo <span style="color:#e6db74">&#34;Destination binary is symlinked...&#34;</span>
    dirname<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>dirname <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>binary<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
    binary<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>dirname<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#66d9ef">$(</span>readlink <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>binary<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
  <span style="color:#66d9ef">fi</span>

  <span style="color:#75715e"># /Users/kingcos/Library/Developer/Xcode/DerivedData/oc-demo-project-pod-gmhizsqflcuavpebfzsfyychzzuj/Build/Products/Debug-iphonesimulator/oc-demo-project-pod.app/Frameworks/AFNetworking.framework/AFNetworking: Mach-O 64-bit dynamically linked shared library x86_64</span>
  <span style="color:#75715e"># Strip invalid architectures so &#34;fat&#34; simulator / device frameworks work on device</span>
  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>file <span style="color:#e6db74">&#34;</span>$binary<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> *<span style="color:#e6db74">&#34;dynamically linked shared library&#34;</span>* <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
    <span style="color:#75715e"># è‹¥ä¸ºåŠ¨æ€é“¾æ¥å…±äº«åº“ï¼Œåˆ™åˆ é™¤æ— æ•ˆæ¶æ„</span>
    strip_invalid_archs <span style="color:#e6db74">&#34;</span>$binary<span style="color:#e6db74">&#34;</span>
  <span style="color:#66d9ef">fi</span>

  <span style="color:#75715e"># Resign the code if required by the build settings to avoid unstable apps</span>
  <span style="color:#75715e"># é‡ç­¾å Build Settings é‡Œè®¾ç½®ä¸ºå¿…é¡»çš„ä»£ç ï¼Œä»¥é¿å…é€ æˆ app ä¸ç¨³å®š</span>
  code_sign_if_enabled <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>destination<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#66d9ef">$(</span>basename <span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>

  <span style="color:#75715e"># Embed linked Swift runtime libraries. No longer necessary as of Xcode 7.</span>
  <span style="color:#75715e"># åµŒå…¥ Swift è¿è¡Œæ—¶åº“ï¼ŒXcode 7 ä¹‹åä¸å†éœ€è¦ã€‚</span>
  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>XCODE_VERSION_MAJOR<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -lt <span style="color:#ae81ff">7</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
    local swift_runtime_libs
    swift_runtime_libs<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>xcrun otool -LX <span style="color:#e6db74">&#34;</span>$binary<span style="color:#e6db74">&#34;</span> | grep --color<span style="color:#f92672">=</span>never @rpath/libswift | sed -E s/@rpath<span style="color:#ae81ff">\\</span>/<span style="color:#ae81ff">\(</span>.+dylib<span style="color:#ae81ff">\)</span>.*/<span style="color:#ae81ff">\\</span>1/g | uniq -u<span style="color:#66d9ef">)</span>
    <span style="color:#66d9ef">for</span> lib in $swift_runtime_libs; <span style="color:#66d9ef">do</span>
      echo <span style="color:#e6db74">&#34;rsync -auv \&#34;</span><span style="color:#e6db74">${</span>SWIFT_STDLIB_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>lib<span style="color:#e6db74">}</span><span style="color:#e6db74">\&#34; \&#34;</span><span style="color:#e6db74">${</span>destination<span style="color:#e6db74">}</span><span style="color:#e6db74">\&#34;&#34;</span>
      rsync -auv <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>SWIFT_STDLIB_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>lib<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>destination<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
      code_sign_if_enabled <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>destination<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>lib<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
    <span style="color:#66d9ef">done</span>
  <span style="color:#66d9ef">fi</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e"># Copies and strips a vendored dSYM</span>
<span style="color:#75715e"># æ‹·è´å¹¶åˆ é™¤ vendored dSYM</span>
install_dsym<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
  local source<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span>
  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -r <span style="color:#e6db74">&#34;</span>$source<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
    <span style="color:#75715e"># Copy the dSYM into a the targets temp dir.</span>
    echo <span style="color:#e6db74">&#34;rsync --delete -av &#34;</span><span style="color:#e6db74">${</span>RSYNC_PROTECT_TMP_FILES[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34; --filter \&#34;- CVS/\&#34; --filter \&#34;- .svn/\&#34; --filter \&#34;- .git/\&#34; --filter \&#34;- .hg/\&#34; --filter \&#34;- Headers\&#34; --filter \&#34;- PrivateHeaders\&#34; --filter \&#34;- Modules\&#34; \&#34;</span><span style="color:#e6db74">${</span>source<span style="color:#e6db74">}</span><span style="color:#e6db74">\&#34; \&#34;</span><span style="color:#e6db74">${</span>DERIVED_FILES_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">\&#34;&#34;</span>
    rsync --delete -av <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>RSYNC_PROTECT_TMP_FILES[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> --filter <span style="color:#e6db74">&#34;- CVS/&#34;</span> --filter <span style="color:#e6db74">&#34;- .svn/&#34;</span> --filter <span style="color:#e6db74">&#34;- .git/&#34;</span> --filter <span style="color:#e6db74">&#34;- .hg/&#34;</span> --filter <span style="color:#e6db74">&#34;- Headers&#34;</span> --filter <span style="color:#e6db74">&#34;- PrivateHeaders&#34;</span> --filter <span style="color:#e6db74">&#34;- Modules&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>source<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>DERIVED_FILES_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>

    local basename
    basename<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>basename -s .framework.dSYM <span style="color:#e6db74">&#34;</span>$source<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
    binary<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>DERIVED_FILES_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>basename<span style="color:#e6db74">}</span><span style="color:#e6db74">.framework.dSYM/Contents/Resources/DWARF/</span><span style="color:#e6db74">${</span>basename<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>

    <span style="color:#75715e"># Strip invalid architectures so &#34;fat&#34; simulator / device frameworks work on device</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>file <span style="color:#e6db74">&#34;</span>$binary<span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> *<span style="color:#e6db74">&#34;Mach-O &#34;</span>*<span style="color:#e6db74">&#34;dSYM companion&#34;</span>* <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
      strip_invalid_archs <span style="color:#e6db74">&#34;</span>$binary<span style="color:#e6db74">&#34;</span>
    <span style="color:#66d9ef">fi</span>

    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> $STRIP_BINARY_RETVAL <span style="color:#f92672">==</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
      <span style="color:#75715e"># Move the stripped file into its final destination.</span>
      echo <span style="color:#e6db74">&#34;rsync --delete -av &#34;</span><span style="color:#e6db74">${</span>RSYNC_PROTECT_TMP_FILES[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34; --filter \&#34;- CVS/\&#34; --filter \&#34;- .svn/\&#34; --filter \&#34;- .git/\&#34; --filter \&#34;- .hg/\&#34; --filter \&#34;- Headers\&#34; --filter \&#34;- PrivateHeaders\&#34; --filter \&#34;- Modules\&#34; \&#34;</span><span style="color:#e6db74">${</span>DERIVED_FILES_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>basename<span style="color:#e6db74">}</span><span style="color:#e6db74">.framework.dSYM\&#34; \&#34;</span><span style="color:#e6db74">${</span>DWARF_DSYM_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">\&#34;&#34;</span>
      rsync --delete -av <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>RSYNC_PROTECT_TMP_FILES[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> --filter <span style="color:#e6db74">&#34;- CVS/&#34;</span> --filter <span style="color:#e6db74">&#34;- .svn/&#34;</span> --filter <span style="color:#e6db74">&#34;- .git/&#34;</span> --filter <span style="color:#e6db74">&#34;- .hg/&#34;</span> --filter <span style="color:#e6db74">&#34;- Headers&#34;</span> --filter <span style="color:#e6db74">&#34;- PrivateHeaders&#34;</span> --filter <span style="color:#e6db74">&#34;- Modules&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>DERIVED_FILES_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>basename<span style="color:#e6db74">}</span><span style="color:#e6db74">.framework.dSYM&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>DWARF_DSYM_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
    <span style="color:#66d9ef">else</span>
      <span style="color:#75715e"># The dSYM was not stripped at all, in this case touch a fake folder so the input/output paths from Xcode do not reexecute this script because the file is missing.</span>
      touch <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>DWARF_DSYM_FOLDER_PATH<span style="color:#e6db74">}</span><span style="color:#e6db74">/</span><span style="color:#e6db74">${</span>basename<span style="color:#e6db74">}</span><span style="color:#e6db74">.framework.dSYM&#34;</span>
    <span style="color:#66d9ef">fi</span>
  <span style="color:#66d9ef">fi</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e"># Copies the bcsymbolmap files of a vendored framework</span>
<span style="color:#75715e"># å¤åˆ¶ vendored æ¡†æ¶çš„ bcsymbolmap æ–‡ä»¶</span>
install_bcsymbolmap<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
    local bcsymbolmap_path<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span>
    local destination<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>BUILT_PRODUCTS_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
    echo <span style="color:#e6db74">&#34;rsync --delete -av &#34;</span><span style="color:#e6db74">${</span>RSYNC_PROTECT_TMP_FILES[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34; --filter &#34;</span>- CVS/<span style="color:#e6db74">&#34; --filter &#34;</span>- .svn/<span style="color:#e6db74">&#34; --filter &#34;</span>- .git/<span style="color:#e6db74">&#34; --filter &#34;</span>- .hg/<span style="color:#e6db74">&#34; --filter &#34;</span>- Headers<span style="color:#e6db74">&#34; --filter &#34;</span>- PrivateHeaders<span style="color:#e6db74">&#34; --filter &#34;</span>- Modules<span style="color:#e6db74">&#34; &#34;</span><span style="color:#e6db74">${</span>bcsymbolmap_path<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34; &#34;</span><span style="color:#e6db74">${</span>destination<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;&#34;</span>
    rsync --delete -av <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>RSYNC_PROTECT_TMP_FILES[@]<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> --filter <span style="color:#e6db74">&#34;- CVS/&#34;</span> --filter <span style="color:#e6db74">&#34;- .svn/&#34;</span> --filter <span style="color:#e6db74">&#34;- .git/&#34;</span> --filter <span style="color:#e6db74">&#34;- .hg/&#34;</span> --filter <span style="color:#e6db74">&#34;- Headers&#34;</span> --filter <span style="color:#e6db74">&#34;- PrivateHeaders&#34;</span> --filter <span style="color:#e6db74">&#34;- Modules&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>bcsymbolmap_path<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>destination<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e"># Signs a framework with the provided identity</span>
<span style="color:#75715e"># ä½¿ç”¨æä¾›çš„è¯æ˜ç­¾åæ¡†æ¶</span>
code_sign_if_enabled<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>EXPANDED_CODE_SIGN_IDENTITY<span style="color:#66d9ef">:-</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> -a <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>CODE_SIGNING_REQUIRED<span style="color:#66d9ef">:-</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> !<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;NO&#34;</span> -a <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>CODE_SIGNING_ALLOWED<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> !<span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;NO&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
    <span style="color:#75715e"># Use the current code_sign_identity</span>
    echo <span style="color:#e6db74">&#34;Code Signing </span>$1<span style="color:#e6db74"> with Identity </span><span style="color:#e6db74">${</span>EXPANDED_CODE_SIGN_IDENTITY_NAME<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
    local code_sign_cmd<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/usr/bin/codesign --force --sign </span><span style="color:#e6db74">${</span>EXPANDED_CODE_SIGN_IDENTITY<span style="color:#e6db74">}</span><span style="color:#e6db74"> </span><span style="color:#e6db74">${</span>OTHER_CODE_SIGN_FLAGS<span style="color:#66d9ef">:-</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> --preserve-metadata=identifier,entitlements &#39;</span>$1<span style="color:#e6db74">&#39;&#34;</span>

    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>COCOAPODS_PARALLEL_CODE_SIGN<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;true&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
      code_sign_cmd<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$code_sign_cmd<span style="color:#e6db74"> &amp;&#34;</span>
    <span style="color:#66d9ef">fi</span>
    echo <span style="color:#e6db74">&#34;</span>$code_sign_cmd<span style="color:#e6db74">&#34;</span>
    eval <span style="color:#e6db74">&#34;</span>$code_sign_cmd<span style="color:#e6db74">&#34;</span>
  <span style="color:#66d9ef">fi</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e"># Strip invalid architectures</span>
<span style="color:#75715e"># åˆ é™¤æ— æ•ˆæ¶æ„å‡½æ•°</span>
strip_invalid_archs<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
  binary<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$1<span style="color:#e6db74">&#34;</span>
  <span style="color:#75715e"># Get architectures for current target binary</span>
  <span style="color:#75715e"># è·å–å½“å‰äºŒè¿›åˆ¶æ¶æ„ï¼Œx86_64 æ¨¡æ‹Ÿå™¨</span>
  binary_archs<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>lipo -info <span style="color:#e6db74">&#34;</span>$binary<span style="color:#e6db74">&#34;</span> | rev | cut -d <span style="color:#e6db74">&#39;:&#39;</span> -f1 | awk <span style="color:#e6db74">&#39;{$1=$1;print}&#39;</span> | rev<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>

  <span style="color:#75715e"># Intersect them with the architectures we are building for</span>
  <span style="color:#75715e"># ä¸ç›®æ ‡æ¶æ„å–äº¤é›†</span>
  intersected_archs<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>echo <span style="color:#e6db74">${</span>ARCHS[@]<span style="color:#e6db74">}</span> <span style="color:#e6db74">${</span>binary_archs[@]<span style="color:#e6db74">}</span> | tr <span style="color:#e6db74">&#39; &#39;</span> <span style="color:#e6db74">&#39;\n&#39;</span> | sort | uniq -d<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
  <span style="color:#75715e"># If there are no archs supported by this binary then warn the user</span>
  <span style="color:#75715e"># å¦‚æœäº¤é›†ä¸ºç©ºï¼Œå³æ²¡æœ‰æ”¯æŒçš„æ¶æ„ï¼Œåˆ™è­¦å‘Šç”¨æˆ·</span>
  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> -z <span style="color:#e6db74">&#34;</span>$intersected_archs<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
    echo <span style="color:#e6db74">&#34;warning: [CP] Vendored binary &#39;</span>$binary<span style="color:#e6db74">&#39; contains architectures (</span>$binary_archs<span style="color:#e6db74">) none of which match the current build architectures (</span>$ARCHS<span style="color:#e6db74">).&#34;</span>
    STRIP_BINARY_RETVAL<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>
    <span style="color:#66d9ef">return</span>
  <span style="color:#66d9ef">fi</span>
  stripped<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>
  <span style="color:#66d9ef">for</span> arch in $binary_archs; <span style="color:#66d9ef">do</span>
    <span style="color:#66d9ef">if</span> ! <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>ARCHS<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> *<span style="color:#e6db74">&#34;</span>$arch<span style="color:#e6db74">&#34;</span>* <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
      <span style="color:#75715e"># Strip non-valid architectures in-place</span>
      <span style="color:#75715e"># åˆ é™¤æ— æ•ˆæ¶æ„</span>
      lipo -remove <span style="color:#e6db74">&#34;</span>$arch<span style="color:#e6db74">&#34;</span> -output <span style="color:#e6db74">&#34;</span>$binary<span style="color:#e6db74">&#34;</span> <span style="color:#e6db74">&#34;</span>$binary<span style="color:#e6db74">&#34;</span>
      stripped<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$stripped<span style="color:#e6db74"> </span>$arch<span style="color:#e6db74">&#34;</span>
    <span style="color:#66d9ef">fi</span>
  <span style="color:#66d9ef">done</span>
  <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span>$stripped<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
    echo <span style="color:#e6db74">&#34;Stripped </span>$binary<span style="color:#e6db74"> of architectures:</span>$stripped<span style="color:#e6db74">&#34;</span>
  <span style="color:#66d9ef">fi</span>
  STRIP_BINARY_RETVAL<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>
<span style="color:#f92672">}</span>

<span style="color:#75715e"># CONFIGURATIONï¼šè¿è¡Œçš„ scheme é…ç½®æ¨¡å¼ï¼ŒDebug æˆ– Release</span>
<span style="color:#75715e"># ç›®å‰ Debug å’Œ Release æ¨¡å¼å¤„ç†ä¸€è‡´</span>
<span style="color:#75715e"># /Users/kingcos/Library/Developer/Xcode/DerivedData/oc-demo-project-pod-gmhizsqflcuavpebfzsfyychzzuj/Build/Products/Debug-iphonesimulator/AFNetworking/AFNetworking.framework</span>

<span style="color:#75715e"># /Users/kingcos/Library/Developer/Xcode/DerivedData/oc-demo-project-pod-gmhizsqflcuavpebfzsfyychzzuj/Build/Products/Debug-iphonesimulator/oc-pod/oc_pod.framework</span>
<span style="color:#75715e"># /Users/kingcos/Library/Developer/Xcode/DerivedData/oc-demo-project-pod-gmhizsqflcuavpebfzsfyychzzuj/Build/Products/Debug-iphonesimulator/swift-pod/swift_pod.framework</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span>$CONFIGURATION<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Debug&#34;</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
  install_framework <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>BUILT_PRODUCTS_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/AFNetworking/AFNetworking.framework&#34;</span>
  install_framework <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>BUILT_PRODUCTS_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/oc-pod/oc_pod.framework&#34;</span>
  install_framework <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>BUILT_PRODUCTS_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/swift-pod/swift_pod.framework&#34;</span>
<span style="color:#66d9ef">fi</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span>$CONFIGURATION<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;Release&#34;</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
  install_framework <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>BUILT_PRODUCTS_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/AFNetworking/AFNetworking.framework&#34;</span>
  install_framework <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>BUILT_PRODUCTS_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/oc-pod/oc_pod.framework&#34;</span>
  install_framework <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>BUILT_PRODUCTS_DIR<span style="color:#e6db74">}</span><span style="color:#e6db74">/swift-pod/swift_pod.framework&#34;</span>
<span style="color:#66d9ef">fi</span>
<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>COCOAPODS_PARALLEL_CODE_SIGN<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;true&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
  wait
<span style="color:#66d9ef">fi</span>
</code></pre></div><p>ä½¿ç”¨ <code>use_frameworks!</code> ä¾èµ–çš„ Pod åº“å³å¯åœ¨ Obj-C å·¥ç¨‹ä¸­ä½¿ç”¨ <code>@import</code> å¼•å…¥ï¼Œæˆ–è€…å°†å…±æœ‰å¤´æ–‡ä»¶å¼•å…¥ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸åŒäºä¸Šè¿°é <code>use_frameworks!</code> æƒ…å†µï¼Œ<code>#import</code> æ˜¯å¼•å…¥ç›¸å¯¹äº Framework çš„å¤´æ–‡ä»¶ä½ç½®ã€‚å¯¹äº Swift Pod åˆ™æ— ä¸åŒï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-objectivec" data-lang="objectivec"><span style="color:#75715e">#import &#34;ViewController.h&#34;
</span><span style="color:#75715e"></span>
<span style="color:#75715e">//#import &lt;oc-pod/ObjC_Foo.h&gt; âŒï¼Œä»…åœ¨é `use_frameworks!` ä¸‹ä»¥æ–‡ä»¶å¤¹ç›¸å¯¹è·¯å¾„å¼•å…¥è€Œæ”¯æŒ `-`
</span><span style="color:#75715e"></span><span style="color:#75715e">#import &lt;oc_pod/ObjC_Foo.h&gt;
</span><span style="color:#75715e"></span><span style="color:#75715e">//#import &lt;ObjC_Foo.h&gt;
</span><span style="color:#75715e">//#import &#34;ObjC_Foo.h&#34;
</span><span style="color:#75715e">//@import oc_pod;
</span><span style="color:#75715e"></span>
@import swift_pod;

<span style="color:#66d9ef">@interface</span> <span style="color:#a6e22e">ViewController</span> ()
<span style="color:#66d9ef">@end</span>

<span style="color:#66d9ef">@implementation</span> <span style="color:#a6e22e">ViewController</span>
- (<span style="color:#66d9ef">void</span>)<span style="color:#a6e22e">viewDidLoad</span> {
    [super viewDidLoad];

    [[[ObjC_Foo alloc] init] foo];

    [[[Swift_Foo alloc] init] foo];
    NSLog(<span style="color:#e6db74">@&#34;%@&#34;</span>, [[[Swift_Foo alloc] init] strings]);
}
<span style="color:#66d9ef">@end</span>
</code></pre></div><h4 id="swift-å·¥ç¨‹-1">Swift å·¥ç¨‹</h4>
<p>Swift å·¥ç¨‹ä¸‹ä¹Ÿæ˜¯ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ¡¥æ¥æ–‡ä»¶ä¸­ä½¿ç”¨ <code>@import</code> å¼•å…¥ï¼Œæˆ–è€…å°†å…±æœ‰å¤´æ–‡ä»¶å¼•å…¥ã€‚ä½†å…¶å®æ­¤æ—¶æ¡¥æ¥æ–‡ä»¶æœ¬èº«å³æ˜¯å¤šä½™çš„ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ Swift å·¥ç¨‹ä¸­ç›´æ¥ä½¿ç”¨ <code>import</code> å³å¯ï¼š</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-swift" data-lang="swift"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">UIKit</span>
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">swift_pod</span>
<span style="color:#66d9ef">import</span> <span style="color:#a6e22e">oc_pod</span>

<span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ViewController</span>: UIViewController {
    <span style="color:#66d9ef">override</span> <span style="color:#66d9ef">func</span> <span style="color:#a6e22e">viewDidLoad</span>() {
        <span style="color:#66d9ef">super</span>.viewDidLoad()

        ObjC_Foo().foo()

<span style="color:#75715e">//        Swift_Foo().foo()</span>
        print(Swift_Foo().strings())
    }
}
</code></pre></div><ul>
<li>TODO:</li>
<li><input disabled="" type="checkbox"> @import</li>
<li><input disabled="" type="checkbox"> Module Map</li>
</ul>
<h2 id="reference">Reference</h2>
<!-- - [Linkers and Loaders](https://book.douban.com/subject/1436811/) -->
<ul>
<li><a href="../../2018/dyld_shared_cache/">è°ˆè°ˆ iOS ä¸­çš„ dyld_shared_cache - kingcos</a></li>
<li><a href="/posts/2019/+load_in_ios/">iOS ä¸­çš„ +load æ–¹æ³• - kingcos</a></li>
<li><a href="https://forums.swift.org/t/whats-in-the-file-of-swiftmodule-how-to-open-it/1032">whatâ€™s in the file of .swiftmodule?how to open it?</a></li>
<li><a href="https://forums.swift.org/t/looking-for-documentation-insight-on-swiftdoc/6869">Looking for documentation/insight on .swiftdoc</a></li>
<li><a href="https://forums.swift.org/t/swift-static-libraries-dont-copy-generated-objective-c-header/19816">Swift static libraries donâ€™t copy generated Objective-C header</a></li>
<li><a href="https://stackoverflow.com/questions/29580438/use-swift-library-in-objc">Use Swift Library in ObjC - StackOverflow</a></li>
<li><a href="https://paul-samuels.com/blog/2018/01/14/swift-static-library-in-objective-c/">Swift static library in Objective-C - Paul Samuels</a></li>
<li><a href="https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPFrameworks/Frameworks.html">Framework Programming Guide - Apple</a></li>
<li><a href="https://developer.apple.com/library/archive/documentation/CoreFoundation/Conceptual/CFBundles/BundleTypes/BundleTypes.html">Bundle Programming Guide - Apple</a></li>
<li><a href="https://developer.apple.com/library/archive/technotes/tn2435/_index.html">Technical Note TN2435 - Embedding Frameworks In An App - Apple</a></li>
<li><a href="https://www.raywenderlich.com/2430-how-to-create-a-framework-for-ios">How to Create a Framework for iOS - Ray Wenderlich</a></li>
</ul>

    </div>
    
      <div class="pagination">
        <div class="pagination__title">
          <span class="pagination__title-h">Read other posts</span>
          <hr />
        </div>
        <div class="pagination__buttons">
          
            <span class="button previous">
              <a href="/posts/2019/shopping_1111/">
                <span class="button__icon">â†</span>
                <span class="button__text">åŒ 11 ä¹°ä¹°ä¹° - å¼€å§‹æŠ¢è´­å•¦ ğŸ’°</span>
              </a>
            </span>
          
          
            <span class="button next">
              <a href="/posts/2019/category_in_ios/">
                <span class="button__text">iOS ä¸­çš„ Category</span>
                <span class="button__icon">â†’</span>
              </a>
            </span>
          
        </div>
      </div>
    

    

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<table style="border: 0;">
  <tr>
  <td style="border: 0; width: 30%;">
    <img src='/img/about/1.jpg'>
  </td>
  <td style="border: 0;">
    <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-9925978992661955"
     data-ad-slot="3213735320"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
  </td>
  </tr>
</table>



<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>


    
    
    <div>
      <div id="github-comment">
      </div>

      <script type="text/javascript">
        function getUtterances(isDark) {
          var utterances = document.createElement('script');
          utterances.type = 'text/javascript';
          utterances.async = true;
          utterances.setAttribute('issue-term', "pathname")
          utterances.setAttribute('repo', "kingcos\/kingcos.github.io")
          utterances.setAttribute('label', "comments")
          isDark ? utterances.setAttribute('theme', "github-dark") : utterances.setAttribute('theme', "github-light")
          utterances.crossorigin = 'anonymous';
          utterances.src = 'https://utteranc.es/client.js';

          return utterances
        }

        var themeToggle = document.querySelector(".theme-toggle")
        themeToggle.addEventListener("click", function () {
          var getTheme = window.localStorage && window.localStorage.getItem("theme")
          var divNode = document.getElementById('github-comment')
          while(divNode.hasChildNodes()) {
            divNode.removeChild(divNode.firstChild);
          }
          
          
          

          
          
          
          
          
          
          document.getElementById('github-comment').appendChild(getUtterances(getTheme !== "dark"))
        })

        var getTheme = window.localStorage && window.localStorage.getItem("theme")
        document.getElementById('github-comment').appendChild(getUtterances(getTheme === "dark"))
      </script>
    </div>
    

    </div>

      </div>

      
        <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">All rights reserved by kingcos.me</div>
    
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>



      
    </div>

    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-138311951-1', 'auto');
	
	ga('send', 'pageview');
}
</script>

    
  </body>
</html>
