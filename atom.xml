<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>V2M</title>
  <subtitle>Way to MM.</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://maimieng.com/"/>
  <updated>2016-10-29T16:21:50.000Z</updated>
  <id>https://maimieng.com/</id>
  
  <author>
    <name>kingcos</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>使用 UIColor 生成 UIImage</title>
    <link href="https://maimieng.com/2016/30/"/>
    <id>https://maimieng.com/2016/30/</id>
    <published>2016-10-28T16:00:00.000Z</published>
    <updated>2016-10-29T16:21:50.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote class="blockquote-center"><br>UIColor &lt;-&gt; UIImage<br></blockquote><br><a id="more"></a></p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在平时的练习中，经常需要使用 UIImage，但图片又不好找。为了解决这个问题，我想到了使用 UIColor 生成 UIImage。该部分的具体知识涉及到 Core Graphics，也是一个新的知识点。在网上寻找一番，只有 Objective-C 版本，这次使用 Swift 3.0 进行重写。</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">generateImageWith</span><span class="params">(<span class="number">_</span> color: UIColor, andFrame frame: CGRect)</span></span> -&gt; <span class="type">UIImage</span>? &#123;</div><div class="line">    <span class="comment">// 开始绘图</span></div><div class="line">    <span class="type">UIGraphicsBeginImageContext</span>(frame.size)</div><div class="line">    </div><div class="line">    <span class="comment">// 获取绘图上下文</span></div><div class="line">    <span class="keyword">let</span> context = <span class="type">UIGraphicsGetCurrentContext</span>()</div><div class="line">    <span class="comment">// 设置填充颜色</span></div><div class="line">    context?.setFillColor(color.cgColor)</div><div class="line">    <span class="comment">// 使用填充颜色填充区域</span></div><div class="line">    context?.fill(frame)</div><div class="line">    </div><div class="line">    <span class="comment">// 获取绘制的图像</span></div><div class="line">    <span class="keyword">let</span> image = <span class="type">UIGraphicsGetImageFromCurrentImageContext</span>()</div><div class="line">    </div><div class="line">    <span class="comment">// 结束绘图</span></div><div class="line">    <span class="type">UIGraphicsEndImageContext</span>()</div><div class="line">    <span class="keyword">return</span> image</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>那么反过来呢？</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="type">UIColor</span>(patternImage: image!)</div></pre></td></tr></table></figure>
<p>这样就可以从图片获取颜色。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;UIColor &amp;lt;-&amp;gt; UIImage&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Swift" scheme="https://maimieng.com/tags/Swift/"/>
    
      <category term="iOS" scheme="https://maimieng.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>初探 Swift 中的 KVC 之补充</title>
    <link href="https://maimieng.com/2016/29/"/>
    <id>https://maimieng.com/2016/29/</id>
    <published>2016-10-26T16:00:00.000Z</published>
    <updated>2016-10-27T08:30:17.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote class="blockquote-center"><br>Updated for Swift 3.0.1<br></blockquote><br><a id="more"></a></p>
<h2 id="Swift-3-0-1-中的-KVC"><a href="#Swift-3-0-1-中的-KVC" class="headerlink" title="Swift 3.0.1 中的 KVC"></a>Swift 3.0.1 中的 KVC</h2><p>按照官网，其实在 Swift 3.0 中已经为如下写法，但我是根据 10 月 24 日更新的 KVC 编程指南中的链接才发现该更新的。<code>#keyPath</code> 表达式使得键（路径）更加安全，因为其可以在编译时检查，极大程度避免传入 undefinedkey。但在测试中，也发现了其中的问题，如果该属性在外界无法访问，那么 <code>#keyPath</code> 也无能为力，但仍传入字符串可以做到动态设置。Demo 包含在下面的 Demo 中。</p>
<h2 id="使用-KVC-设置访问控制属性"><a href="#使用-KVC-设置访问控制属性" class="headerlink" title="使用 KVC 设置访问控制属性"></a>使用 KVC 设置访问控制属性</h2><p>在前面，我已经大致总结了 Swift 中的<a href="https://maimieng.com/2016/25/">访问控制</a>以及 <a href="https://maimieng.com/2016/27/">KVC</a>，其实很不全面，而且漏掉了 KVC 可以突破访问控制修饰的限制。似乎这样做会破坏封装，但这也是 Cocoa 的一个特性，使得我们可以在<strong>运行时</strong>进行更加灵活的设置。这次结合两者谈谈简单说下。</p>
<h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><p>在 Demo 中，将各个访问控制修饰符均列出，但他们都能通过 KVC 设值。</p>
<p>Person.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">open <span class="class"><span class="keyword">class</span> <span class="title">Person</span>: <span class="title">NSObject</span> </span>&#123;</div><div class="line">    <span class="keyword">dynamic</span> open <span class="keyword">var</span> openProp = <span class="string">""</span></div><div class="line">    <span class="keyword">dynamic</span> <span class="keyword">public</span> <span class="keyword">var</span> publicProp = <span class="string">""</span></div><div class="line">    <span class="keyword">dynamic</span> <span class="keyword">internal</span> <span class="keyword">var</span> internalProp = <span class="string">""</span></div><div class="line">    <span class="keyword">dynamic</span> fileprivate <span class="keyword">var</span> fileprivateProp = <span class="string">""</span></div><div class="line">    <span class="keyword">dynamic</span> <span class="keyword">private</span> <span class="keyword">var</span> privateProp = <span class="string">""</span></div><div class="line">    </div><div class="line">    <span class="keyword">override</span> open <span class="keyword">var</span> description: <span class="type">String</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"[<span class="subst">\(openProp)</span>, <span class="subst">\(publicProp)</span>, <span class="subst">\(internalProp)</span>, <span class="subst">\(fileprivateProp)</span>, <span class="subst">\(privateProp)</span>]"</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>main.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> p = <span class="type">Person</span>()</div><div class="line"></div><div class="line">p.setValue(<span class="string">"open"</span>, forKey: #keyPath(<span class="type">Person</span>.openProp))</div><div class="line">p.setValue(<span class="string">"public"</span>, forKey: #keyPath(<span class="type">Person</span>.publicProp))</div><div class="line">p.setValue(<span class="string">"internal"</span>, forKey: #keyPath(<span class="type">Person</span>.internalProp))</div><div class="line">p.setValue(<span class="string">"fileprivate"</span>, forKey: <span class="string">"fileprivateProp"</span>)</div><div class="line">p.setValue(<span class="string">"private"</span>, forKey: <span class="string">"privateProp"</span>)</div><div class="line"></div><div class="line"><span class="built_in">print</span>(p)</div><div class="line"></div><div class="line"><span class="comment">// [open, public, internal, fileprivate, private]</span></div></pre></td></tr></table></figure>
<h2 id="浅谈集合属性的-KVC"><a href="#浅谈集合属性的-KVC" class="headerlink" title="浅谈集合属性的 KVC"></a>浅谈集合属性的 KVC</h2><p><a href="http://swiftcafe.io/2016/01/03/kvc/" target="_blank" rel="external">漫谈 KVC 与 KVO</a>，这篇文章在写上篇 KVC 时已经看过，但没有注意末尾提到的集合属性的 KVC，感谢<a href="http://weibo.com/u/2305821027" target="_blank" rel="external">木杉</a>同学的提问，才让我注意到这个细节。</p>
<p>关于这点，我查了很多资料，尤其是关心苹果的官方 KVC 指南，官方的 KVC 编程指南的最新更新日期是 2016 年 10 月 24 日，我特意查了更新历史，上一次更新要追溯的 2012 年。但指南仅仅更新了部分的 Swift 内容，而对于集合属性部分，仍为 Objective-C。</p>
<h3 id="Demo-1"><a href="#Demo-1" class="headerlink" title="Demo-1"></a>Demo-1</h3><p>如果按照<a href="http://swiftcafe.io/2016/01/03/kvc/" target="_blank" rel="external">漫谈 KVC 与 KVO</a>所提到的，Swift 中的写法应当为下，但通过运行发现，并不走 <code>countOfArr()</code> 方法，而是直接输出 <code>arr.count</code>，即 0。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CollectionDemo</span>: <span class="title">NSObject</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> arr = <span class="type">NSMutableArray</span>()</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">countOfArr</span><span class="params">()</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"countOfArr"</span>)</div><div class="line">        <span class="keyword">return</span> <span class="number">100</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// 该方法虽然未调用，但不能缺少</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">objectInArrAt</span><span class="params">(index: Int)</span></span> -&gt; <span class="type">Any</span>? &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"objectInArrAt"</span>)</div><div class="line">        <span class="keyword">return</span> arr.object(at: index)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> obj = <span class="type">CollectionDemo</span>()</div><div class="line"></div><div class="line"><span class="built_in">print</span>(obj.mutableArrayValue(forKeyPath: <span class="string">"arr"</span>).<span class="built_in">count</span>)</div><div class="line"><span class="built_in">print</span>(obj.mutableArrayValue(forKeyPath: #keyPath(<span class="type">CollectionDemo</span>.arr)).<span class="built_in">count</span>)</div><div class="line"></div><div class="line"><span class="comment">// 0</span></div><div class="line"><span class="comment">// 0</span></div></pre></td></tr></table></figure>
<h3 id="Demo-2"><a href="#Demo-2" class="headerlink" title="Demo-2"></a>Demo-2</h3><p><code>mutableArrayValue:</code> 的默认实现为传入键，返回该键对应的可变代理数组。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CollectionDemo</span>: <span class="title">NSObject</span> </span>&#123;</div><div class="line">    <span class="keyword">dynamic</span> <span class="keyword">var</span> <span class="type">Arr</span> = <span class="type">NSMutableArray</span>()</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">countOfArr</span><span class="params">()</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"countOfArr"</span>)</div><div class="line">        <span class="keyword">return</span> <span class="type">Arr</span>.<span class="built_in">count</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">objectInArrAt</span><span class="params">(index: Int)</span></span> -&gt; <span class="type">Any</span>? &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"objectInArrAt"</span>)</div><div class="line">        <span class="keyword">return</span> <span class="type">Arr</span>[index]</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">insertObject</span><span class="params">(<span class="number">_</span> obj: Any, inArrAtIndex index: Int)</span></span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"insertObject"</span>)</div><div class="line">        <span class="type">Arr</span>[index] = obj</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> obj = <span class="type">CollectionDemo</span>()</div><div class="line"><span class="keyword">let</span> arrayProxy = obj.mutableArrayValue(forKeyPath: <span class="string">"arr"</span>)</div><div class="line">arrayProxy.add(<span class="string">"Test1"</span>)</div><div class="line"><span class="comment">// countOfArr</span></div><div class="line"><span class="comment">// countOfArr</span></div><div class="line"><span class="comment">// countOfArr</span></div><div class="line"></div><div class="line">arrayProxy.add(<span class="string">"Test2"</span>)</div><div class="line"><span class="comment">// countOfArr</span></div><div class="line"><span class="comment">// countOfArr</span></div><div class="line"><span class="comment">// countOfArr</span></div><div class="line"><span class="comment">// objectInArrAt</span></div><div class="line"></div><div class="line">arrayProxy.add(<span class="string">"Test3"</span>)</div><div class="line"><span class="comment">// countOfArr</span></div><div class="line"><span class="comment">// countOfArr</span></div><div class="line"><span class="comment">// countOfArr</span></div><div class="line"><span class="comment">// objectInArrAt</span></div><div class="line"><span class="comment">// objectInArrAt</span></div><div class="line"></div><div class="line"><span class="built_in">print</span>(arrayProxy.<span class="built_in">count</span>)</div><div class="line"><span class="comment">// countOfArr</span></div><div class="line"><span class="comment">// 3</span></div><div class="line"></div><div class="line"><span class="built_in">print</span>(arrayProxy[<span class="number">0</span>])</div><div class="line"><span class="comment">// objectInArrAt</span></div><div class="line"><span class="comment">// Test1</span></div></pre></td></tr></table></figure>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="http://stackoverflow.com/questions/31951681/mutablearrayvalueforkey-countofkey-not-being-called-countofsongs?answertab=active#tab-top" target="_blank" rel="external">mutableArrayValueForKey: countOf<key> not being called, countOfSongs</key></a><br><a href="https://developer.apple.com/library/prerelease/content/documentation/Cocoa/Conceptual/KeyValueCoding/index.html#//apple_ref/doc/uid/10000107-SW1" target="_blank" rel="external">Key-Value Coding Programming Guide</a><br><a href="http://swiftcafe.io/2016/01/03/kvc/" target="_blank" rel="external">漫谈 KVC 与 KVO</a><br><a href="https://maimieng.com/2016/27/">初探 Swift 中的 KVC</a><br><a href="https://maimieng.com/2016/25/">浅谈 Swift 3 中的访问控制</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;Updated for Swift 3.0.1&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Swift" scheme="https://maimieng.com/tags/Swift/"/>
    
      <category term="iOS" scheme="https://maimieng.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>浅谈 Swift 中的属性（Property）</title>
    <link href="https://maimieng.com/2016/28/"/>
    <id>https://maimieng.com/2016/28/</id>
    <published>2016-10-24T16:00:00.000Z</published>
    <updated>2016-10-26T09:55:41.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote class="blockquote-center"><br>Stored Properties &amp; Computed Properties<br>Property Observers<br></blockquote><br><a id="more"></a></p>
<ul>
<li>Info:<ul>
<li>macOS 10.12.1</li>
<li>Xcode 8.1 Beta 3</li>
<li>Swift 3.0</li>
</ul>
</li>
</ul>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Swift 中的属性分为存储属性与计算属性，存储属性即为我们平时常用的属性，可以直接赋值使用，而计算属性不直接存储值，而是根据其他（存储）属性计算得来的值。</p>
<p>在其他面向对象的编程语言中，例如 Java 和 Objective-C 中，get 和 set 方法提供了统一、规范的接口，可以使得外部访问或设置对象的私有属性，而不破坏封装性，也可以很好的控制权限（选择性实现 get 或 set 方法）。而 Swift 中似乎并没有见到类似的 get 和 set 方法，而 Swift 使用了一种名为属性观察器的概念来解决该问题。</p>
<p>本文简单介绍下 Swift 中的这两种属性，以及属性观察器。</p>
<h2 id="延迟存储属性"><a href="#延迟存储属性" class="headerlink" title="延迟存储属性"></a>延迟存储属性</h2><p>存储属性使用广泛，即是类或结构体中的变量或常量，可以直接赋初始值，也可以修改其初始值（仅指变量）。延迟存储属性是指第一次使用到该变量再进行运算（这里的运算不能依赖其他属性）。延迟存储属性必须声明为 <code>var</code> 变量，因为其属性值在对象实例化前可能无法得到，而常量必须在初始化完成前拥有初始值。</p>
<p>在 Swift 中，可以将消耗性能才能得到的值的初始化放在延迟存储属性中，即懒加载。</p>
<h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><p>这里假定在 ViewController.swift 有一个属性，需要从 plist 文件读取内容，将其中的字典转为模型。如果 plist 文件内容很多，那么就十分消耗性能。如果用户不触发相应事件，也没有必要加载这些数据。那么这里就很适合使用懒加载，即延迟存储属性。</p>
<p>ViewController.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ViewController</span>: <span class="title">UIViewController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> goods: <span class="type">NSArray</span>? = &#123;</div><div class="line">        <span class="keyword">var</span> goodsArray: <span class="type">NSMutableArray</span> = []</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> path = <span class="type">Bundle</span>.main.path(forResource: <span class="string">"Goods"</span>, ofType: <span class="string">"plist"</span>) &#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> array = <span class="type">NSArray</span>(contentsOfFile: path) &#123;</div><div class="line">                <span class="keyword">for</span> goodsDict <span class="keyword">in</span> array &#123;</div><div class="line">                    goodsArray.add(<span class="type">Goods</span>(goodsDict <span class="keyword">as</span>! <span class="type">NSDictionary</span>))</div><div class="line">                &#125;</div><div class="line">                <span class="keyword">return</span> goodsArray</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">    &#125;()</div><div class="line">    </div><div class="line">    <span class="comment">// 这样也是允许的</span></div><div class="line">    <span class="built_in">lazy</span> <span class="keyword">var</span> testLazy = <span class="type">Person</span>()</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;&#125;</div></pre></td></tr></table></figure>
<p><em>可以在延迟存储属性运算的代码中加入 <code>print()</code>，即可验证其何时初始化。</em></p>
<h2 id="计算属性"><a href="#计算属性" class="headerlink" title="计算属性"></a>计算属性</h2><p>举个例子，一个<strong>矩形</strong>结构体（类同理），拥有<strong>宽度</strong>和<strong>高度</strong>两个存储属性，以及一个只读<strong>面积</strong>的计算属性，因为通过设置矩形的宽度和高度即可<strong>计算</strong>出矩形的面积，而无需直接设置其值。当宽度或高度改变，面积也应当可以跟随其变化（反之不能推算，因此为只读）。为说明 setter 以及便捷 setter 说明，另外添加了<strong>原点</strong>（矩形左下角）存储属性，以及<strong>中心</strong>计算属性。</p>
<h3 id="Demo-1"><a href="#Demo-1" class="headerlink" title="Demo"></a>Demo</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> x = <span class="number">0.0</span></div><div class="line">    <span class="keyword">var</span> y = <span class="number">0.0</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Rectangle</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> width = <span class="number">0.0</span></div><div class="line">    <span class="keyword">var</span> height = <span class="number">0.0</span></div><div class="line">    <span class="keyword">var</span> origin = <span class="type">Point</span>()</div><div class="line">    </div><div class="line">    <span class="comment">// 只读计算属性</span></div><div class="line">    <span class="keyword">var</span> size: <span class="type">Double</span> &#123;</div><div class="line">        <span class="keyword">get</span> &#123;</div><div class="line">            <span class="keyword">return</span> width * height</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// 只读计算属性简写为</span></div><div class="line"><span class="comment">//    var size: Double &#123;</span></div><div class="line"><span class="comment">//        return width * height</span></div><div class="line"><span class="comment">//    &#125;</span></div><div class="line"></div><div class="line">    <span class="keyword">var</span> center: <span class="type">Point</span> &#123;</div><div class="line">        <span class="keyword">get</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="type">Point</span>(x: origin.x + width / <span class="number">2</span>,</div><div class="line">                         y: origin.y + height / <span class="number">2</span>)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">set</span>(newCenter) &#123;</div><div class="line">            origin.x = newCenter.x - width / <span class="number">2</span></div><div class="line">            origin.y = newCenter.y - height / <span class="number">2</span></div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="comment">// 便捷 setter 声明</span></div><div class="line"><span class="comment">//        set &#123;</span></div><div class="line"><span class="comment">//            origin.x = newValue.x - width / 2</span></div><div class="line"><span class="comment">//            origin.y = newValue.y - height / 2</span></div><div class="line"><span class="comment">//        &#125;</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> rect = <span class="type">Rectangle</span>()</div><div class="line">rect.width = <span class="number">100</span></div><div class="line">rect.height = <span class="number">50</span></div><div class="line"><span class="built_in">print</span>(rect.size)</div><div class="line"></div><div class="line">rect.origin = <span class="type">Point</span>(x: <span class="number">0</span>, y: <span class="number">0</span>)</div><div class="line"><span class="built_in">print</span>(rect.center)</div><div class="line"></div><div class="line">rect.center = <span class="type">Point</span>(x: <span class="number">100</span>, y: <span class="number">100</span>)</div><div class="line"><span class="built_in">print</span>(rect.origin)</div><div class="line"></div><div class="line"><span class="comment">// 5000.0</span></div><div class="line"><span class="comment">// Point(x: 50.0, y: 25.0)</span></div><div class="line"><span class="comment">// Point(x: 50.0, y: 75.0)</span></div></pre></td></tr></table></figure>
<p><em>综上，getter 可以根据存储属性推算计算属性的值，setter 可以在被赋值时根据新值倒推存储属性，但它们与我们在其他语言中的 get/set 方法却不一样。</em></p>
<h2 id="属性观察器"><a href="#属性观察器" class="headerlink" title="属性观察器"></a>属性观察器</h2><p>属性观察器算是 Swift 中的一个 feature，变量在设值<strong>前</strong>会先进入 <code>willSet</code>，这时默认 <code>newValue</code> 等于即将要赋值的值，而变量本身尚未改变。变量在设值<strong>后</strong>会先进入 <code>didSet</code>，这时默认 <code>oldValue</code> 等于赋值前变量的值，而变量变为新值。</p>
<p>这样，开发者即可在 <code>willSet</code> 和 <code>didSet</code> 中进行相应的操作，如果只是取值和设值而不进行额外操作，那么直接使用点语法即可。但是有时候一个变量只需要被访问，而不能在外界赋值，那么可以使用<a href="https://maimieng.com/2016/25/">访问控制修饰符</a>加上 <code>(set)</code> 即可私有化 set 方法。例如 <code>fileprivate(set)</code>，<code>private(set)</code>，以及 <code>internal(set)</code>。值得注意的是，这里的访问控制修饰符修饰的是 set 方法，访问权限（即 get）是另外设置的。例如 <code>public fileprivate(set) var prop = 0</code>，该变量全局可以访问，但只有同文件内可以使用 set 方法。</p>
<h3 id="Demo-2"><a href="#Demo-2" class="headerlink" title="Demo"></a>Demo</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Animal</span> </span>&#123;</div><div class="line">    <span class="comment">// internal 为默认权限，可不加</span></div><div class="line">    <span class="keyword">internal</span> <span class="keyword">private</span>(<span class="keyword">set</span>) <span class="keyword">var</span> privateSetProp = <span class="number">0</span></div><div class="line">    </div><div class="line">    <span class="keyword">var</span> hungryValue = <span class="number">0</span> &#123;</div><div class="line">        <span class="comment">// 设置前调用</span></div><div class="line">        <span class="keyword">willSet</span> &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"willSet <span class="subst">\(hungryValue)</span> newValue: <span class="subst">\(newValue)</span>"</span>)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="comment">// 设置后调用</span></div><div class="line">        <span class="keyword">didSet</span> &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"didSet <span class="subst">\(hungryValue)</span> oldValue: <span class="subst">\(oldValue)</span>"</span>)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="comment">// 也可以自己命名默认的 newValue/oldValue</span></div><div class="line">        <span class="comment">// willSet(new) &#123;&#125;</span></div><div class="line">        <span class="comment">// didSet(old) &#123;&#125;</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> cat = <span class="type">Animal</span>()</div><div class="line"></div><div class="line"><span class="comment">// private(set) 即只读</span></div><div class="line"><span class="comment">// cat.privateSetProp = 10</span></div><div class="line"><span class="built_in">print</span>(cat.privateSetProp)</div><div class="line"></div><div class="line">cat.hungryValue += <span class="number">10</span></div><div class="line"><span class="built_in">print</span>(cat.hungryValue)</div><div class="line"></div><div class="line"><span class="comment">// 0</span></div><div class="line"><span class="comment">// willSet 0 newValue: 10</span></div><div class="line"><span class="comment">// didSet 10 oldValue: 0</span></div><div class="line"><span class="comment">// 10</span></div></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>Swift 的这几个 feature 我未曾在其他语言中见过，对于初学者确实容易凌乱。特别是 getter/setter 以及属性观察器中均没有代码提示，容易造成手误，代码似乎也变得臃肿。但是熟悉之后，这些也都能完成之前的功能，甚至更加细分。保持每一部分可控，便使得整个程序更加严谨，更加安全。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://maimieng.com/2016/25/">浅谈 Swift 3 中的访问控制</a><br><a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/AccessControl.html" target="_blank" rel="external">Access Contro</a><br><a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/Properties.html" target="_blank" rel="external">Properties</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;Stored Properties &amp;amp; Computed Properties&lt;br&gt;Property Observers&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Swift" scheme="https://maimieng.com/tags/Swift/"/>
    
      <category term="iOS" scheme="https://maimieng.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>初探 Swift 中的 KVC</title>
    <link href="https://maimieng.com/2016/27/"/>
    <id>https://maimieng.com/2016/27/</id>
    <published>2016-10-20T16:00:00.000Z</published>
    <updated>2016-10-27T08:23:29.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote class="blockquote-center"><br>Key-Value Coding<br></blockquote><br><a id="more"></a></p>
<ul>
<li>Info:<ul>
<li>macOS 10.12.1 Beta 4</li>
<li>Xcode 8.1 Beta 3</li>
<li>Swift 3</li>
</ul>
</li>
</ul>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p><strong>这两天（2016-10-27），苹果一言不合更新了官网的文档，有些文档上次的更新日期甚至为 2012 年，说明这次的更新十分重要且稳定，并且将 Swift 版本更新到 3.0.1，本文中的一些写法随能运行，但已经过时，并非最佳实践，为此以及一些本文未涉及的内容，可以参照另一文——<a href="https://maimieng.com/2016/29/">初探 Swift 中的 KVC 之补充</a>。</strong></p>
<p>Key-Value Coding 中文译为「键值编码」，简称 KVC。是 iOS 开发中极其重要且基础的概念。苹果官网对于 KVC 有详细的编程指南，但均是基于 Objective-C 语言。Swift 也继承了该特性，KVC 常用于从网络获取请求进行处理，这次只是简单探究下 Swift 中的 KVC。</p>
<p>在 Swift 中想要兼容 KVC，需要该类继承 <code>NSObject</code>。下面是 KVC 中常用的几个方法：</p>
<ul>
<li>根据传入的 <code>key</code>，设置 <code>value</code>：</li>
</ul>
<p><code>func setValue(_ value: Any?, forKey key: String)</code></p>
<ul>
<li>根据传入的 <code>keyPath</code>，设置 <code>value</code>，<code>keyPath</code> 即键路径可利用 <code>.</code> 遍历至键：</li>
</ul>
<p><code>func setValue(_ value: Any?, forKeyPath keyPath: String)</code></p>
<ul>
<li>根据传入的字典，设值，如果字典中有对象不存在的属性，则会抛出异常：</li>
</ul>
<p><code>func setValuesForKeys(_ keyedValues: [String : Any])</code></p>
<ul>
<li>当为不存在的某个键设值时，默认调用该方法抛出 <code>NSUndefinedKeyException</code> 异常，子类可重写该方法：</li>
</ul>
<p><code>func setValue(_ value: Any?, forUndefinedKey key: String)</code></p>
<ul>
<li>设置特定键的值为 <code>nil</code> 时，默认调用该方法抛出 <code>NSInvalidArgumentException</code>，子类可重写该方法（注：官方称该方法针对标量值（scalar value），例如整型和浮点型）对于其他类型没有提到，在 Demo 中有详细的列出是否支持）：</li>
</ul>
<p><code>func setNilValueForKey(_ key: String)</code></p>
<ul>
<li>返回传入指定键的对应值：</li>
</ul>
<p><code>func value(forKey key: String) -&gt; Any?</code></p>
<ul>
<li>返回传入指定键路径的对应值：</li>
</ul>
<p><code>func value(forKeyPath keyPath: String) -&gt; Any?</code></p>
<ul>
<li>返回传入未定义的键路径的对应值：</li>
</ul>
<p><code>func value(forUndefinedKey key: String) -&gt; Any?</code></p>
<h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><p>KVC 兼容的类，需要继承自 <code>NSObject</code>。在学习 KVC 的过程中，发现并不是所有的数据类型都支持通过 KVC 设值。KVC 设值的方便之处在于可以动态的设值，即使封装在内部的细节也可以设值，而且可以自动将类型转换（注意：有些类型是不可行的）。这种特性使得从网络获取的数据可以轻松设置到模型中。以下的 Demo，选取了几个常用的 Swift 中的数据类型，测试一下是否支持 KVC 以及是否在设置 <code>nil</code> 值时调用 <code>setNilValueForKey</code> 方法。</p>
<p>DataType.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">DataType</span>: <span class="title">NSObject</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> aInt: <span class="type">Int</span> = <span class="number">0</span></div><div class="line">    <span class="keyword">var</span> bUInt: <span class="type">UInt</span> = <span class="number">0</span></div><div class="line">    <span class="keyword">var</span> cFloat: <span class="type">Float</span> = <span class="number">0.0</span></div><div class="line">    <span class="keyword">var</span> dDouble: <span class="type">Double</span> = <span class="number">0.0</span></div><div class="line">    <span class="keyword">var</span> eBool: <span class="type">Bool</span> = <span class="literal">false</span></div><div class="line">    <span class="keyword">var</span> fCharacter: <span class="type">Character</span> = <span class="string">"f"</span></div><div class="line">    <span class="keyword">var</span> gString: <span class="type">String</span> = <span class="string">""</span></div><div class="line">    <span class="keyword">var</span> hArray: [<span class="type">Any</span>] = [<span class="number">0</span>]</div><div class="line">    <span class="keyword">var</span> iDictionary: [<span class="type">String</span>: <span class="type">Any</span>] = [<span class="string">"0"</span>: <span class="number">0</span>]</div><div class="line">    <span class="keyword">var</span> jTuple: (<span class="type">Int</span>, <span class="type">Int</span>) = (<span class="number">0</span>, <span class="number">0</span>)</div><div class="line">    <span class="keyword">var</span> kOptional: <span class="type">Int</span>?</div><div class="line">    <span class="keyword">var</span> lObject: <span class="type">Type</span> = <span class="type">Type</span>()</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> mNSDictionary: <span class="type">NSDictionary</span> = [<span class="string">"0"</span>: <span class="number">0</span>]</div><div class="line">    <span class="keyword">var</span> nNSArray: <span class="type">NSArray</span> = [<span class="number">0</span>, <span class="string">"0"</span>]</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> oArrayAny: <span class="type">Array</span>&lt;<span class="type">Any</span>&gt; = [<span class="number">0</span>, <span class="string">"0"</span>]</div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">setNilValueForKey</span><span class="params">(<span class="number">_</span> key: String)</span></span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"You set nil for <span class="subst">\(key)</span>"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Type</span>: <span class="title">NSObject</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> prop = <span class="number">0</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>main.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> o = <span class="type">DataType</span>()</div></pre></td></tr></table></figure>
<h3 id="Int"><a href="#Int" class="headerlink" title="Int"></a><code>Int</code></h3><p>main.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">o.setValue(<span class="string">"1"</span>, forKeyPath: <span class="string">"aInt"</span>)</div><div class="line"><span class="built_in">print</span>(<span class="string">"aInt: <span class="subst">\(o.aInt)</span>"</span>)</div><div class="line">o.setValue(<span class="literal">nil</span>, forKeyPath: <span class="string">"aInt"</span>)</div><div class="line"></div><div class="line"><span class="comment">// aInt: 1</span></div><div class="line"><span class="comment">// You set nil for aInt</span></div></pre></td></tr></table></figure>
<p><strong><code>Int</code> 支持 <code>setValue</code> 自动转换设值，且支持设值为 <code>nil</code> 时调用 <code>setNilValueForKey</code> 方法。</strong></p>
<h3 id="UInt"><a href="#UInt" class="headerlink" title="UInt"></a><code>UInt</code></h3><p>main.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 不支持通过自动转换</span></div><div class="line"><span class="comment">// Error: -[Swift._NSContiguousString unsignedLongLongValue]: unrecognized selector sent to instance</span></div><div class="line"><span class="comment">// o.setValue("1", forKeyPath: "bUInt")</span></div><div class="line">o.setValue(<span class="number">1</span>, forKeyPath: <span class="string">"bUInt"</span>)</div><div class="line"><span class="built_in">print</span>(o.bUInt)</div><div class="line">o.setValue(<span class="literal">nil</span>, forKeyPath: <span class="string">"bUInt"</span>)</div><div class="line"></div><div class="line"><span class="comment">// 1</span></div><div class="line"><span class="comment">// You set nil for bUInt</span></div></pre></td></tr></table></figure>
<p><strong><code>UInt</code> 支持 <code>setValue</code> 设值，但不支持自动转换，且支持设值为 <code>nil</code> 时调用 <code>setNilValueForKey</code> 方法。</strong></p>
<h3 id="Float"><a href="#Float" class="headerlink" title="Float"></a><code>Float</code></h3><p>main.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">o.setValue(<span class="string">"1"</span>, forKeyPath: <span class="string">"cFloat"</span>)</div><div class="line"><span class="built_in">print</span>(o.cFloat)</div><div class="line">o.setValue(<span class="literal">nil</span>, forKeyPath: <span class="string">"cFloat"</span>)</div><div class="line"></div><div class="line"><span class="comment">// 1.0</span></div><div class="line"><span class="comment">// You set nil for cFloat</span></div></pre></td></tr></table></figure>
<p><strong><code>Float</code> 支持 <code>setValue</code> 自动转换设值，且支持设值为 <code>nil</code> 时调用 <code>setNilValueForKey</code> 方法。</strong></p>
<h3 id="Double"><a href="#Double" class="headerlink" title="Double"></a><code>Double</code></h3><p>main.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">o.setValue(<span class="string">"1"</span>, forKeyPath: <span class="string">"dDouble"</span>)</div><div class="line"><span class="built_in">print</span>(o.dDouble)</div><div class="line">o.setValue(<span class="literal">nil</span>, forKeyPath: <span class="string">"dDouble"</span>)</div><div class="line"></div><div class="line"><span class="comment">// 1.0</span></div><div class="line"><span class="comment">// You set nil for dDouble</span></div></pre></td></tr></table></figure>
<p><strong><code>Double</code> 支持 <code>setValue</code> 自动转换设值，且支持设值为 <code>nil</code> 时调用 <code>setNilValueForKey</code> 方法。</strong></p>
<h3 id="Bool"><a href="#Bool" class="headerlink" title="Bool"></a><code>Bool</code></h3><p>main.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 不支持通过自动转换</span></div><div class="line"><span class="comment">// Error: -[Swift._NSContiguousString charValue]: unrecognized selector sent to instance</span></div><div class="line"><span class="comment">// o.setValue("true", forKeyPath: "eBool")</span></div><div class="line">o.setValue(<span class="literal">true</span>, forKeyPath: <span class="string">"eBool"</span>)</div><div class="line"><span class="built_in">print</span>(o.eBool)</div><div class="line">o.setValue(<span class="literal">nil</span>, forKeyPath: <span class="string">"eBool"</span>)</div><div class="line"></div><div class="line"><span class="comment">// true</span></div><div class="line"><span class="comment">// You set nil for eBool</span></div></pre></td></tr></table></figure>
<p><strong><code>Bool</code> 支持 <code>setValue</code> 设值，但不支持自动转换，且支持设值为 <code>nil</code> 时调用 <code>setNilValueForKey</code> 方法。</strong></p>
<h3 id="Character"><a href="#Character" class="headerlink" title="Character"></a><code>Character</code></h3><p>main.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 不支持 setValue</span></div><div class="line"><span class="comment">// Error: [&lt;DataType&gt; setValue:forUndefinedKey:]: this class is not key value coding-compliant for the key fCharacter.</span></div><div class="line"><span class="comment">// let b: Character = "b"</span></div><div class="line"><span class="comment">// o.setValue(b, forKeyPath: "fCharacter")</span></div><div class="line"><span class="comment">// o.setValue(nil, forKeyPath: "fCharacter")</span></div></pre></td></tr></table></figure>
<p><strong><code>Character</code> 不支持 setValue。</strong></p>
<h3 id="String"><a href="#String" class="headerlink" title="String"></a><code>String</code></h3><p>main.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">o.setValue(<span class="string">"gString"</span>, forKeyPath: <span class="string">"gString"</span>)</div><div class="line"><span class="built_in">print</span>(o.gString)</div><div class="line">o.setValue(<span class="literal">nil</span>, forKeyPath: <span class="string">"gString"</span>)</div><div class="line"><span class="built_in">print</span>(o.gString)</div><div class="line"></div><div class="line"><span class="comment">// gString</span></div><div class="line"><span class="comment">//</span></div></pre></td></tr></table></figure>
<p><strong><code>String</code> 支持 <code>setValue</code> 设值，设值为 <code>nil</code> 时不调用 <code>setNilValueForKey</code> 方法，但可以清空。</strong></p>
<h3 id="Array-lt-Int-gt"><a href="#Array-lt-Int-gt" class="headerlink" title="Array&lt;Int&gt;"></a><code>Array&lt;Int&gt;</code></h3><p>main.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 不支持自动转换</span></div><div class="line"><span class="comment">// Error: -[Swift._NSContiguousString count]: unrecognized selector sent to instance</span></div><div class="line"><span class="comment">// o.setValue("1", forKeyPath: "hArray")</span></div><div class="line">o.setValue([<span class="number">1</span>], forKeyPath: <span class="string">"hArray"</span>)</div><div class="line"><span class="built_in">print</span>(o.hArray)</div><div class="line">o.setValue(<span class="literal">nil</span>, forKeyPath: <span class="string">"hArray"</span>)</div><div class="line"><span class="built_in">print</span>(o.hArray)</div><div class="line"></div><div class="line"><span class="comment">// [1]</span></div><div class="line"><span class="comment">// []</span></div></pre></td></tr></table></figure>
<p><strong><code>Array&lt;Int&gt;</code> 支持 <code>setValue</code> 设值，但不支持自动转换，设值为 <code>nil</code> 时不调用 <code>setNilValueForKey</code> 方法，但可以清空。</strong></p>
<h3 id="Dictionary"><a href="#Dictionary" class="headerlink" title="Dictionary"></a><code>Dictionary</code></h3><p>main.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 不支持自动转换</span></div><div class="line"><span class="comment">// Error: -[Swift._NSContiguousString count]: unrecognized selector sent to instance</span></div><div class="line"><span class="comment">// o.setValue("[\"2\": 2]", forKeyPath: "iDictionary")</span></div><div class="line">o.setValue([<span class="string">"2"</span>: <span class="number">2</span>], forKeyPath: <span class="string">"iDictionary"</span>)</div><div class="line"><span class="built_in">print</span>(o.iDictionary)</div><div class="line">o.setValue(<span class="literal">nil</span>, forKeyPath: <span class="string">"iDictionary"</span>)</div><div class="line"><span class="built_in">print</span>(o.iDictionary)</div><div class="line"></div><div class="line"><span class="comment">// ["2": 2]</span></div><div class="line"><span class="comment">// [:]</span></div></pre></td></tr></table></figure>
<p><strong><code>Dictionary</code> 支持 <code>setValue</code> 设值，但不支持自动转换，设值为 <code>nil</code> 时不调用 <code>setNilValueForKey</code> 方法，但可以清空。</strong></p>
<h3 id="Tuple"><a href="#Tuple" class="headerlink" title="Tuple"></a><code>Tuple</code></h3><p>main.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 不支持 setValue</span></div><div class="line"><span class="comment">// Error: [&lt;DataType&gt; setValue:forUndefinedKey:]: this class is not key value coding-compliant for the key jTuple.</span></div><div class="line"><span class="comment">// let t = (1, 1)</span></div><div class="line"><span class="comment">// o.setValue(t, forKeyPath: "jTuple")</span></div><div class="line"><span class="comment">// o.setValue(nil, forKeyPath: "jTuple")</span></div></pre></td></tr></table></figure>
<p><strong><code>Tuple</code> 不支持 setValue。</strong></p>
<h3 id="Optional"><a href="#Optional" class="headerlink" title="Optional"></a><code>Optional</code></h3><p>main.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 不支持 setValue</span></div><div class="line"><span class="comment">// Error: [&lt;DataType&gt; setValue:forUndefinedKey:]: this class is not key value coding-compliant for the key kOptional.</span></div><div class="line"><span class="comment">// o.setValue(1, forKeyPath: "kOptional")</span></div><div class="line"><span class="comment">// o.setValue(nil, forKeyPath: "kOptional")</span></div></pre></td></tr></table></figure>
<p><strong><code>Optional</code> 不支持 setValue。</strong></p>
<h3 id="自定义类"><a href="#自定义类" class="headerlink" title="自定义类"></a>自定义类</h3><p>main.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">o.setValue(<span class="string">"1"</span>, forKeyPath: <span class="string">"lObject.prop"</span>)</div><div class="line"><span class="built_in">print</span>(o.lObject.prop)</div><div class="line"><span class="comment">// 不支持设值 nil</span></div><div class="line"><span class="comment">// Error: [&lt;Type&gt; setNilValueForKey]: could not set nil as the value for the key prop.</span></div><div class="line"><span class="comment">//o.setValue(nil, forKeyPath: "lObject.prop")</span></div><div class="line"></div><div class="line"><span class="comment">// 1</span></div></pre></td></tr></table></figure>
<p><strong>自定义类的对象的属性支持 <code>setValue</code> 自动转换设值，但不支持设值为 <code>nil</code>。</strong></p>
<h3 id="NSDictionary"><a href="#NSDictionary" class="headerlink" title="NSDictionary"></a><code>NSDictionary</code></h3><p>main.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> nsDict: <span class="type">NSDictionary</span> = [<span class="string">"1"</span>: <span class="number">1</span>]</div><div class="line">o.setValue(nsDict, forKeyPath: <span class="string">"mNSDictionary"</span>)</div><div class="line"><span class="built_in">print</span>(o.mNSDictionary[<span class="string">"1"</span>])</div><div class="line"></div><div class="line"><span class="keyword">let</span> swiftDict = [<span class="string">"2"</span>: <span class="number">2</span>]</div><div class="line">o.setValue(swiftDict, forKeyPath: <span class="string">"mNSDictionary"</span>)</div><div class="line"><span class="built_in">print</span>(o.mNSDictionary[<span class="string">"2"</span>])</div><div class="line"></div><div class="line">o.setValue(<span class="literal">nil</span>, forKeyPath: <span class="string">"mNSDictionary"</span>)</div><div class="line"><span class="built_in">print</span>(o.mNSDictionary[<span class="string">"2"</span>])</div><div class="line"></div><div class="line"><span class="comment">// Optional(1)</span></div><div class="line"><span class="comment">// Optional(2)</span></div><div class="line"><span class="comment">// nil</span></div></pre></td></tr></table></figure>
<p><strong><code>NSDictionary</code> 支持 <code>setValue</code> 设值（支持 Swift 中的 <code>Dictionary</code> 以及 <code>NSDictionary</code>），但不支持自动转换，设值为 <code>nil</code> 时不调用 <code>setNilValueForKey</code> 方法，但可以清空。</strong></p>
<h3 id="NSArray"><a href="#NSArray" class="headerlink" title="NSArray"></a><code>NSArray</code></h3><p>main.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">o.setValue(<span class="string">"a"</span>, forKeyPath: <span class="string">"nNSArray"</span>)</div><div class="line"><span class="built_in">print</span>(o.nNSArray)</div><div class="line">o.setValue(<span class="literal">nil</span>, forKeyPath: <span class="string">"nNSArray"</span>)</div><div class="line"><span class="built_in">print</span>(o.nNSArray == <span class="literal">nil</span>)</div><div class="line"></div><div class="line"><span class="comment">// a</span></div><div class="line"><span class="comment">// true</span></div></pre></td></tr></table></figure>
<p><strong><code>NSArray</code> 支持 <code>setValue</code> 设值（<code>NSArray</code> 存储 <code>Any</code> 类型，因此不存在自动转换），设值为 <code>nil</code> 时不调用 <code>setNilValueForKey</code> 方法，但会设值为 <code>nil</code>。</strong></p>
<h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>这次将 Swift 中的一些数据类型拿出来单独测试了 KVC，结果来看有部分类型对此支持并不完全，所以在往后从网络获取数据一定要进行相应的处理再 <code>setValue</code>。也最好重写 <code>func setValue(_ value: Any?, forUndefinedKey key: String)</code>，必要时重写 <code>func setNilValueForKey(_ key: String)</code>。Swift 是一门强类型语言，就要求程序员多加注意类型转换等其他问题，以减少或避免程序崩溃，带来不好的用户体验。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;Key-Value Coding&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Swift" scheme="https://maimieng.com/tags/Swift/"/>
    
      <category term="iOS" scheme="https://maimieng.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>浅谈 Swift 3 中的访问控制</title>
    <link href="https://maimieng.com/2016/25/"/>
    <id>https://maimieng.com/2016/25/</id>
    <published>2016-10-19T16:00:00.000Z</published>
    <updated>2016-10-26T09:46:36.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote class="blockquote-center"><br>Access Control in Swift 3.0<br></blockquote><br><a id="more"></a></p>
<ul>
<li>Info:<ul>
<li>macOS 10.12.1 Beta 4</li>
<li>Xcode 8.1 Beta 3</li>
<li>Swift 3.0</li>
</ul>
</li>
</ul>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>学习过 Java 等面向对象语言的同学对访问控制一定不陌生，Swift 3 相较于之前的版本，新加了两个关于访问控制修饰符，<code>open</code> 和 <code>fileprivate</code>。因此，是时候总结一下这四个关键字的<strong>基本用法</strong>，因为暂未涉及到复杂的访问控制，故为浅谈。</p>
<p>另外，由于 Apple.com 的所有文档均无权翻译，所以取消之前的翻译，转为自己的理解和代码，权当给自己做个笔记。</p>
<h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><p>访问控制修饰符的限制性 <strong>高-&gt;低</strong> 排序为下：</p>
<p><code>open</code> &gt; <code>public</code> &gt; <code>internal</code>(默认) &gt; <code>fileprivate</code> &gt; <code>private</code></p>
<p>访问控制的使用原则：<strong>不允许将实体定义在限制性更强的实体内。</strong>所以，以下代码均为错误用法，并注明了错误信息：</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span>: <span class="title">NSObject</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> name: <span class="type">String</span>?</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="keyword">var</span> cat = <span class="type">Cat</span>()</div><div class="line"><span class="comment">// Error: Variable cannot be declared public because its type 'Cat' uses an internal type</span></div><div class="line"><span class="comment">// public 变量不能为 internal，fileprivate，private 类型</span></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">testAccessControl</span><span class="params">(<span class="number">_</span> cat: Cat)</span></span> &#123;</div><div class="line">    <span class="keyword">return</span> cat</div><div class="line">&#125;</div><div class="line"><span class="comment">// Error: Function cannot be declared public because its parameter uses an internal type</span></div><div class="line"><span class="comment">// 函数或方法的访问限制级别不能高于其参数类型</span></div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">testAccessControl</span><span class="params">()</span></span> -&gt; <span class="type">Cat</span> &#123;</div><div class="line">    <span class="keyword">return</span> <span class="type">Cat</span>()</div><div class="line">&#125;</div><div class="line"><span class="comment">// Error: Function cannot be declared public because its result uses an internal type</span></div><div class="line"><span class="comment">// 函数或方法的访问限制级别不能高于其返回值类型</span></div></pre></td></tr></table></figure>
<h3 id="open-amp-public"><a href="#open-amp-public" class="headerlink" title="open &amp; public"></a><code>open</code> &amp; <code>public</code></h3><p><code>open</code> 是 Swift 3 新增的访问控制符，相较于 <code>public</code> 更加开放。<code>open</code> 和 <code>public</code> 都是可以跨 Module 访问的，但 <code>open</code> 修饰的类可以继承，修饰的方法可以重写（此时，<code>open</code> 需同时修饰该方法以及所在类），而 <code>public</code> 不可以。</p>
<p>至于 <code>public final</code> 与 <code>public</code>，前者在任何地方均不可重写，而后者可在本 Module 内重写。</p>
<h4 id="Demo-1"><a href="#Demo-1" class="headerlink" title="Demo"></a>Demo</h4><p>ModuleA: Person.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// open 修饰的类可以为其他 Module 所访问和继承</span></div><div class="line">open <span class="class"><span class="keyword">class</span> <span class="title">Person</span>: <span class="title">NSObject</span> </span>&#123;</div><div class="line">    <span class="comment">// 属性：</span></div><div class="line">    <span class="comment">// 子类可访问，不可重写</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">var</span> note = <span class="string">"maimieng.com"</span></div><div class="line">    </div><div class="line">    <span class="comment">// 方法：</span></div><div class="line">    <span class="comment">// 子类可访问，可重写</span></div><div class="line">    open <span class="function"><span class="keyword">func</span> <span class="title">work</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"Work"</span>)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// 子类可访问，不可重写</span></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">eat</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"Eat it"</span>)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// 子类可访问，不可重写</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="function"><span class="keyword">func</span> <span class="title">walk</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"Take a walk"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ModuleB: Programmer.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> ModuleA</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Programmer</span>: <span class="title">Person</span> </span>&#123;</div><div class="line">    <span class="comment">// 只可重写 open 方法</span></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">work</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="comment">// 可访问父类 public 和 public final 方法</span></div><div class="line">        eat()</div><div class="line">        walk()</div><div class="line">        </div><div class="line">        <span class="built_in">print</span>(<span class="string">"Writing <span class="subst">\(note)</span>"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="错误信息汇总"><a href="#错误信息汇总" class="headerlink" title="错误信息汇总"></a>错误信息汇总</h4><h5 id="重写父类-public-方法"><a href="#重写父类-public-方法" class="headerlink" title="重写父类 public 方法"></a>重写父类 public 方法</h5><p>ModuleA: Person.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">open <span class="class"><span class="keyword">class</span> <span class="title">Person</span>: <span class="title">NSObject</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">eat</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"Eat it"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ModuleB: Programmer.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> ModuleA</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Programmer</span>: <span class="title">Person</span> </span>&#123;</div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">eat</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"Hamburger!!"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>Overriding non-open instance method outside of its defining module</strong></p>
<hr>
<h5 id="重写父类-public-属性"><a href="#重写父类-public-属性" class="headerlink" title="重写父类 public 属性"></a>重写父类 public 属性</h5><p>ModuleA: Person.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">open <span class="class"><span class="keyword">class</span> <span class="title">Person</span>: <span class="title">NSObject</span> </span>&#123;</div><div class="line">    <span class="keyword">public</span> <span class="keyword">var</span> note = <span class="string">"maimieng.com"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ModuleB: Programmer.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> ModuleA</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Programmer</span>: <span class="title">Person</span> </span>&#123;</div><div class="line">    <span class="keyword">override</span> <span class="keyword">var</span> note: <span class="type">String</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">"v1024.cn"</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p><strong>Overriding non-open var outside of its defining module</strong></p>
<h5 id="重写-public-父类"><a href="#重写-public-父类" class="headerlink" title="重写 public 父类"></a>重写 public 父类</h5><p>ModuleA: Animal.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Animal</span>: <span class="title">NSObject</span> </span>&#123;&#125;</div></pre></td></tr></table></figure>
<p>ModuleB: Programmer.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> ModuleA</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span>: <span class="title">Animal</span> </span>&#123;&#125;</div></pre></td></tr></table></figure>
<p><strong>Cannot inherit from non-open class ‘Animal’ outside of its defining module</strong></p>
<h3 id="internal"><a href="#internal" class="headerlink" title="internal"></a><code>internal</code></h3><p><code>internal</code> 是 Swift 中默认／缺省的访问控制级别。网上对于其他修饰符的解释有很多，而 <code>internal</code> 却很少。<code>internal</code> 对自身 Module 开放所有源文件，而对外界源代码屏蔽。</p>
<h4 id="Demo-2"><a href="#Demo-2" class="headerlink" title="Demo"></a>Demo</h4><p>ModuleA: Person.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>: <span class="title">NSObject</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> name = <span class="string">"Person Name"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ModuleA: Designer.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Designer</span>: <span class="title">Person</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"test internal"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="错误信息汇总-1"><a href="#错误信息汇总-1" class="headerlink" title="错误信息汇总"></a>错误信息汇总</h4><p>在 ModuleB 访问 ModuleA</p>
<p>ModuleA: Person.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>: <span class="title">NSObject</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> name = <span class="string">"Person Name"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ModuleB: Programmer.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> ModuleA</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Programmer</span>: <span class="title">Person</span> </span>&#123;&#125;</div></pre></td></tr></table></figure>
<p><strong>Use of undeclared type ‘Person’</strong></p>
<h3 id="fileprivate-amp-private"><a href="#fileprivate-amp-private" class="headerlink" title="fileprivate &amp; private"></a><code>fileprivate</code> &amp; <code>private</code></h3><p>Swift 3 新增的另一个访问修饰符是 <code>fileprivate</code>。</p>
<h4 id="Demo-3"><a href="#Demo-3" class="headerlink" title="Demo"></a>Demo</h4><p>main.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span>: <span class="title">NSObject</span> </span>&#123;</div><div class="line">    <span class="comment">// 默认／缺省 internal</span></div><div class="line">    <span class="keyword">var</span> name: <span class="type">String</span>?</div><div class="line">    </div><div class="line">    <span class="comment">// private 仅可在本类中访问</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> privateProp = <span class="string">"Private Property"</span></div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">privateMethod</span><span class="params">()</span></span> &#123;&#125;</div><div class="line">    </div><div class="line">    <span class="comment">// fileprivate 可在当前文件内所有类访问</span></div><div class="line">    fileprivate <span class="keyword">var</span> filePrivateProp = <span class="string">"File Private Property"</span></div><div class="line">    fileprivate <span class="function"><span class="keyword">func</span> <span class="title">filePrivateMethod</span><span class="params">()</span></span> &#123;&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span>: <span class="title">Animal</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span></span> &#123;</div><div class="line">        filePrivateMethod()</div><div class="line">        <span class="built_in">print</span>(<span class="string">"<span class="subst">\(filePrivateProp)</span>"</span>)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    fileprivate <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">filePrivateMethod</span><span class="params">()</span></span> &#123;&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="错误信息汇总-2"><a href="#错误信息汇总-2" class="headerlink" title="错误信息汇总"></a>错误信息汇总</h4><h5 id="子类访问父类-private-成员"><a href="#子类访问父类-private-成员" class="headerlink" title="子类访问父类 private 成员"></a>子类访问父类 private 成员</h5><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span>: <span class="title">NSObject</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">privateMethod</span><span class="params">()</span></span> &#123;&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span>: <span class="title">Animal</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span></span> &#123;</div><div class="line">        privateMethod()</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>‘privateMethod’ is inaccessible due to ‘private’ protection level</strong></p>
<hr>
<h5 id="其他文件的子类访问-fileprivate-成员"><a href="#其他文件的子类访问-fileprivate-成员" class="headerlink" title="其他文件的子类访问 fileprivate 成员"></a>其他文件的子类访问 fileprivate 成员</h5><p>main.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span>: <span class="title">NSObject</span> </span>&#123;</div><div class="line">    fileprivate <span class="keyword">var</span> filePrivateProp = <span class="string">"File Private Property"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Cat.swift</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span>: <span class="title">Animal</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">test</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"<span class="subst">\(filePrivateProp)</span>"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>‘filePrivateProp’ is inaccessible due to ‘fileprivate’ protection level</strong></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>在 Swift 3 中新增的访问控制修饰符，使得 Swift 的访问控制更加灵活。使用不同的访问修饰符，可以使得程序耦合性降低，对外界屏蔽内部的实现细节。但是，Objective-C 是一门允许动态处理的语言，<code>private</code> 只是所谓的私有，而不是真正的私有，通过 KVC 还是可以获取到内部的细节，而 Swift 由于性能的考虑，默认关闭了动态处理，下一篇谈谈 Swift 中的 KVC &amp; KVO。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="https://developer.apple.com/library/content/documentation/Swift/Conceptual/Swift_Programming_Language/AccessControl.html" target="_blank" rel="external">Access Control</a></li>
<li><a href="https://maimieng.com/2016/24/">在 iOS 项目中新建 Module</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;Access Control in Swift 3.0&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Swift" scheme="https://maimieng.com/tags/Swift/"/>
    
      <category term="iOS" scheme="https://maimieng.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>在 iOS 项目中新建 Module</title>
    <link href="https://maimieng.com/2016/24/"/>
    <id>https://maimieng.com/2016/24/</id>
    <published>2016-10-19T16:00:00.000Z</published>
    <updated>2016-10-26T09:46:31.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote class="blockquote-center"><br>Access Control Prerequisite Article<br></blockquote><br><a id="more"></a></p>
<ul>
<li>Info:<ul>
<li>macOS 10.12.1 Beta 4</li>
<li>Xcode 8.1 Beta 3</li>
</ul>
</li>
</ul>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Module，中文译为「标准部件；模块」。iOS 中的 Module 类似于 Java 中的 Jar 包，也可以称作第三方库，或者框架（Framework)。Swift 中的访问控制就涉及到了不同 Module 下的情况，因此简单记录下如何在 iOS 项目中新建 Module。</p>
<h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><p>首先建立一个 iOS Single View Application。</p>
<p>选择 File-New-Target。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/new_module_1.png" alt="File"></p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/new_module_2.png" alt="New"></p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/new_module_3.png" alt="Target"></p>
<p>选择 Cocoa Touch Framework。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/new_module_4.png" alt="Cocoa Touch Framework"></p>
<p>如图，即为建立的 Module（此处建立两个方便后续测试访问控制修饰符）。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/new_module_5.png" alt="新建完成"></p>
<p>使用时，<code>import ModuleA</code> 即可。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;Access Control Prerequisite Article&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="iOS" scheme="https://maimieng.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>生日记</title>
    <link href="https://maimieng.com/2016/26/"/>
    <id>https://maimieng.com/2016/26/</id>
    <published>2016-10-19T16:00:00.000Z</published>
    <updated>2016-10-21T07:58:17.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote class="blockquote-center"><br>生命不息，向死而生。<br></blockquote><br><a id="more"></a><br>在 QQ 空间里朋友送的礼物提醒下，似乎快要过生日了。虽然在今天之前也知道自己快要过生日了，但是到了这一天也似乎没什么分别。可能是最近有些忙碌，可能其实生日也算不了什么吧。也好久没有什么理由写点什么了，这里总是冷冰冰的技术文也不太好，所以还是写点什么，记录下吧。</p>
<p>很遗憾，大学似乎在知乎大神口中是绚丽多彩的，在小时代中也是很精彩的。而我这几年的重心只放在了学习上，虽说可能比不上 985／211</p>
<p>来到大学已两年有余，大一刚进来的时候，一心想要进入卓越班，也想拿到国家奖学金。毕竟这所大学不怎么样，没有什么能够证明自己。结果，卓越班迟迟未开始，拿着专业第一的成绩才发现国家奖学金仅仅属于大三，结果连国家励志也没有拿到。说实话，那时候心里很不服，但我只是想，不就再努力一年嘛，有什么大不了的。</p>
<p>大一的暑假似乎是完全浪费的，由于在家里我的惰性很强，可能是习惯竞争的环境。虽然我不玩游戏，但也没有去学习，只是在暑假的最后一段时间，学了学 Java 基础，很欣慰，当时的笔记得到了浙大翁凯老师的微博推荐。</p>
<p>大一就那样过去了，迎来了大二。大二，进入了卓越班，考过了四级，六级。虽然这样看来算是有点成绩，而且大二的杂事少多了，我也退出了社团，但现在看来，大二这一年所学习的有些杂乱，虽然对于计算机的热情仍在，但缺少方向。由于大四就可以出去实习，最近也看了一些招聘帖，所以也是感觉时间紧迫，要学有所长，而不是蜻蜓点水。</p>
<p>从大一到现在，我的学习环境几乎都是在宿舍，虽然在大二时有去过汇森学习，也去过图书馆，但最久的还是宿舍。虽然有时候觉得在宿舍效率低，但是似乎我已经习惯了这个嘈杂的环境。至少我认为，虽然我身在宿舍，但我所做的事是学习，</p>
<p>今年最好的生日礼物，算是获得了国家奖学金吧。金钱固然重要，但这张奖状算是对我这两年的一个肯定吧。毕竟没有多少人知道我所做的，没有多少人肯定我所做的，没有正面的反馈，想要单单靠热情来驱动，的确是挺难的。老罗曾经说过，具体原话是否如此不太记得:“通过干干净净地赚钱来证明，在中国是可以做到干干净净地赚钱”。我不清楚也不关心老罗是否干净的赚钱。我只是觉得，通过自己的努力，在没有出身也可以尽力做到最好。</p>
<p>今天呢，Apple 宣布 2016 年 10 月 27 日召开发布会，360 云盘宣布即将关闭。每天，都有不同的事情发生，最近在听一档关于日本的播客，很有深度，引人思考。人的一生不过几十年，多去尝试，多去思考，虽然荆棘遍地，人心叵测，但我仍愿意相信美好。生命不息，向死而生。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;生命不息，向死而生。&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Essay" scheme="https://maimieng.com/tags/Essay/"/>
    
  </entry>
  
  <entry>
    <title>Intellij IDEA 配置 Code Style</title>
    <link href="https://maimieng.com/2016/23/"/>
    <id>https://maimieng.com/2016/23/</id>
    <published>2016-10-02T16:00:00.000Z</published>
    <updated>2016-10-03T02:23:05.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote class="blockquote-center"><br>IDE 已经如此完备了，<br>为什么还是懒得用？<br></blockquote><br><a id="more"></a></p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>昨天自说自话，闲扯了界面设计和代码规范。设计确实需要一些经验，也不一定能取悦所有人。而代码规范却是程序员所起码应当做到的，多人协作中，杂乱的代码就好像批阅潦草的作文，可读性极差。</p>
<p>然而这是个懒人驱动的世界，IDE 其实已经为你准备好了各种工具，等着你去使用。但是由于这些软件基本都是国外开发，汉化不全，新手往往望着密密麻麻的按钮不知所措。</p>
<p>但没办法，英文是程序员所不得不克服的一个「障碍」，障碍我打了引号，因为语言并能算是障碍。语言是共同不同种族的桥梁，然而却阻碍了很多人的前进。</p>
<p>这次，就简单介绍下 Intellij IDEA 如何配置 Code Style 文件，之后便可以通过快捷键规整代码。当然，Code Style 能力有限，更高级的开发者也许早已烂熟于胸。</p>
<p>这里以 Google 的 Java Code Style 为例。</p>
<h2 id="intellij-java-google-style-xml"><a href="#intellij-java-google-style-xml" class="headerlink" title="intellij-java-google-style.xml"></a>intellij-java-google-style.xml</h2><p>Google 在 GitHub 上有一个专门放置编码规范的仓库，地址在：<br><a href="https://github.com/google/styleguide" target="_blank" rel="external">https://github.com/google/styleguide</a>。</p>
<p>可以随时在该网站获得最新的代码规范（但大部分规范几乎很少改动）。</p>
<p>找到其中文件名为 <strong>intellij-java-google-style.xml</strong> 的文件，点击打开。或者直接点击<br><a href="https://github.com/google/styleguide/blob/gh-pages/intellij-java-google-style.xml" target="_blank" rel="external">https://github.com/google/styleguide/blob/gh-pages/intellij-java-google-style.xml</a>。</p>
<p>这里需要将其中的内容保存到本地，当然也可以选择下载整个仓库，只提取所需要的文件。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/intellij_idea_code_style_1.png" alt="复制的内容"></p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/intellij_idea_code_style_2.png" alt="保存为 xml 文件"></p>
<h2 id="导入-Code-Style"><a href="#导入-Code-Style" class="headerlink" title="导入 Code Style"></a>导入 Code Style</h2><p>切换到 Intellij IDEA，这里我用的是 Android Studio，同理。Android Studio-Preferences…</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/intellij_idea_code_style_3.png" alt="Preference"></p>
<p>侧栏 Editor-Java，点击 Manage。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/intellij_idea_code_style_4.png" alt="Editor-Java-Manage"></p>
<p>打开后的界面如下图，点击 Import，之后点击 OK。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/intellij_idea_code_style_5.png" alt="Import"></p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/intellij_idea_code_style_6.png" alt="OK"></p>
<p>选中刚刚保存的 xml 文件，点击 OK，之后再次点击 OK。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/intellij_idea_code_style_7.png" alt="选择 Code Style 文件"></p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/intellij_idea_code_style_8.png" alt="再次点击 OK"></p>
<p>如下图，即导入成功。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/intellij_idea_code_style_9.png" alt="导入成功"></p>
<p>回到 Preferences 界面，也可看到当前 Code Style 切换到 Google Style 了。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/intellij_idea_code_style_10.png" alt="Preferences"></p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>之后的使用 IDE 会保证格式的符合，为了确保文件格式的符合，也可以手动格式化代码。</p>
<p>选择菜单栏-Code-Reformat Code，也可以使用相应的快捷键。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/intellij_idea_code_style_11.png" alt="Reformat Code"></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://www.jetbrains.com/help/idea/2016.2/configuring-code-style.html" target="_blank" rel="external">Configuring Code Style by JetBrains</a><br><a href="https://google.github.io/styleguide/javaguide.html" target="_blank" rel="external">Google Java Style Guide</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;IDE 已经如此完备了，&lt;br&gt;为什么还是懒得用？&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Java" scheme="https://maimieng.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>瞎扯界面设计与代码规范</title>
    <link href="https://maimieng.com/2016/22/"/>
    <id>https://maimieng.com/2016/22/</id>
    <published>2016-10-01T16:00:00.000Z</published>
    <updated>2016-10-02T12:17:33.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote class="blockquote-center"><br>而我说的都是错的。<br></blockquote><br><a id="more"></a></p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>身处软件学院，周围是数不胜数的「程序员」。也有看过他们所做的 App，网站，等等项目。具体功能的实现我不清楚是否合格，但几乎都有一个共同点，「mess」。我需要说明的是，杂乱并不等于丑，因为审美各有不同，而杂乱的界面与糟糕的代码却往往被忽视。当然，程序员又不是产品经理，也不是设计师，所以我说的都是错的。</p>
<h2 id="What"><a href="#What" class="headerlink" title="What"></a>What</h2><p>题中的「设计」，我想分为两个截然不同的意义。一是软件的整体设计，即规划，二是软件的界面设计。软件的整体设计可能需要经验的积累，才能做到考虑周到，尽可能不遗漏某些要点，暂且不论。而界面设计则是设计师对流行设计的认知结合特定软件的思考的产物。</p>
<p>私以为会用 Photoshop 等工具则根本不等同于会设计，就好像会用钢笔但不一定写得出庞中华的硬笔书法（注：我不喜欢庞中华的字体，但其能力还是有的）。</p>
<p>题中的「规范」，主要说的是代码规范。暑假时接了一个 Android Project，没有文档，且是 2012 年的代码，资金与精力有限，不可能完全重写。而代码也是十分糟糕的，拼音命名的变量名随处可见，到处充斥的打印日志（个人认为这些用于测试的临时代码应当及时删除），代码风格极差。加上由于是临时组织的团队，我没有主导权。首先尝试了 SVN 管理代码，结果无法连接 SVN 服务器，最后的协作竟然是通过 QQ，Copy-Paste。团队中的成员对代码规范似乎也没有听说过，我无法想象如果未来公司中这样的代码管理会给后期维护造成多大的难度。。。</p>
<p>所以身边也许有会用 Photoshop 切图的人，但没见过几个能设计的；身边都会敲代码，但没过几个代码做到起码的规范。当然，我连 Photoshop 都不会用，也没做过几个项目，所以我说的都是错的。</p>
<h2 id="How"><a href="#How" class="headerlink" title="How"></a>How</h2><p>暑假培训无聊，草草翻看之前借阅的《写给大家看的设计书》，里面的一些原则也都忘记的差不多了。如果想要做一名专业的设计师，那么掌握工具是基本功，也可能需要看一些理论的书籍，甚至用户心理学的书籍。</p>
<p>说句实话，闲扯这篇，其中一个原因是这次的 Android Project。身为学生，且和计院的不熟悉，不清楚他们平时的写代码是否会多加考虑。上次的 Project 原定 1 周完成，结果到现在也无法交付。这次的 Project 是从头做起，所以我希望可以制定一些代码规范，遵照一些设计规则，这也是我假期这几天所考虑的。</p>
<p>此次的 Project 是基于 Android，所以我希望设计是趋于 Material Design，而不是模仿 iOS。虽然 Apple 的产品我拥有一部分，它们也的确好用，但是一个基于 Android 开发的软件就应当遵照其规范。</p>
<p>但，这里有个悖论。Material Design 在国内其实名存实亡。第三方 ROM 已经把 Android 改的面目全非，当然本地化还是值得称赞的。这也导致现今国内的 Android 手机都神似 iPhone。加上 Android 的碎片化，需要考虑到适配较早的 SDK 版本，导致一些设计无法使用，这也是我最近在考虑是否可以建议有一些 Android 的特有设计。</p>
<p>当然，我又不是决策者，这么做于我来说似乎并没有什么益处，所以我说的都是错的。</p>
<h2 id="Why"><a href="#Why" class="headerlink" title="Why"></a>Why</h2><p>界面设计是为了更好的用户体验，让用户乐于打开你的应用。而代码规范也是为了更好的用户体验，只是这里的用户指的是程序员。</p>
<p>功能的实现也许已经不是关键，App Store 和 Google Play 中有无数的天气预报应用，或是无数的浏览器。但是为什么还是有人不断的开发呢？也许解决了一个用户的痛点，也许只是易用性更好，界面更加美观，运行更加高效。</p>
<p>当然，我站在看热闹不嫌事大的角度，所以我说的都是错的。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p>本来重点是准备整理一些 Material Design 的相关资料，工具，没想到瞎扯这么多，一气呵成，也不再去纠正什么了，当作随笔吧。</p>
<p>希望有人可以懂点设计，有点规范，也希望未来进入的公司可以如此。</p>
<p><a href="https://material.uplabs.com" target="_blank" rel="external">MaterialUp</a><br><a href="https://www.materialpalette.com" target="_blank" rel="external">Material Palette</a><br><a href="http://www.calltoidea.com" target="_blank" rel="external">CallToIdea</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;而我说的都是错的。&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Essay" scheme="https://maimieng.com/tags/Essay/"/>
    
      <category term="Design" scheme="https://maimieng.com/tags/Design/"/>
    
  </entry>
  
  <entry>
    <title>使用 Gradle 构建 Struts 2 Web 应用</title>
    <link href="https://maimieng.com/2016/21/"/>
    <id>https://maimieng.com/2016/21/</id>
    <published>2016-09-26T16:00:00.000Z</published>
    <updated>2016-09-28T06:45:47.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote class="blockquote-center"><br>Ant -&gt; Maven -&gt; Gradle<br></blockquote><br><a id="more"></a></p>
<ul>
<li>Info<ul>
<li>JDK 1.8</li>
<li>Tomcat 8.5.5</li>
<li>Intellij IDEA 2016.2.3</li>
<li>macOS 10.12.1 beta</li>
</ul>
</li>
</ul>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>熟悉 Android 开发的程序员都知道，Android Studio 是基于 Intellij IDEA 社区版所开发的。其默认使用 Gradle 构建项目。</p>
<p>与 Maven 不同，Gradle 的配置更为简单，两者的优劣这里略过，。这次就体验一下使用 Gradle 构建最基本的 Struts 2 Web 应用。记录于此，便于往后查阅。</p>
<h2 id="安装-Tomcat"><a href="#安装-Tomcat" class="headerlink" title="安装 Tomcat"></a>安装 Tomcat</h2><p>下载并解压 Tomcat，将其置于 <code>/usr/local</code> 文件夹内，这里以 Tomcat 8.5.5 为例，因为其支持 Servlet 3.1 标准。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_1.png" alt="Tomcat 放置路径"></p>
<h2 id="新建-Gradle-Web-项目"><a href="#新建-Gradle-Web-项目" class="headerlink" title="新建 Gradle Web 项目"></a>新建 Gradle Web 项目</h2><p>菜单栏：File - New - Project…</p>
<p>选择左侧的 Gradle，勾选 Web 选项，因为要建立的是跑在服务器上的应用。点击 Next。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_2.png" alt="New Gradle"></p>
<p>输入 Group ID 以及 Artifact ID，建议输入真实，唯一的 ID。良好的习惯将减小未来发生错误的概率。继续点击 Next。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_3.png" alt="Group ID &amp; Artifact ID"></p>
<p>勾选必要的选项，Next。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_4.png" alt="配置项目"></p>
<p>设置项目的放置目录，Finish。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_5.png" alt="项目的放置目录"></p>
<p>等待 Gradle 构建项目，可以在窗口下部看到当前状态，构建完毕时，则会消失。和 Maven 类似，Gradle 的构建过程也需要联网下载所需的依赖。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_6.png" alt="等待 Gradle 构建项目"></p>
<h2 id="导入-Struts-2"><a href="#导入-Struts-2" class="headerlink" title="导入 Struts 2"></a>导入 Struts 2</h2><p>Gradle 项目建立基本完毕，需要配置 Struts 2 的依赖。和 Maven 类似，可以搜索 Maven Repository，虽然名字是 Maven 仓库，但却提供了多种依赖的部署方式。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_7.png" alt="搜索 Maven Repository"></p>
<p>搜索 struts，我们能得到很多结果，我们需要选择 Struts 2 Core。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_8.png" alt="Struts 2 Core"></p>
<p>打开之后可以看到 Struts 2 的不同版本，Maven 和 Gradle 的方便之处在于，可以很简单的切换不同版本，而不用手动下载相关 JAR 包。对于版本的选择，首先可以优先选择 release 版。测试版（即 Beta 版）在网页上也有清晰的标注。另外通过阅览 Struts 官网我们得知，Struts 3 将基于 2.5 或更新版本，较大版本更迭会有较大不同，甚至是兼容性的差异。所以我们选择当前 2.3 的最高子版本 2.3.30。当然你也可以选择参考书等资料中的版本，但个人偏向较新的版本，不要沉溺于太过时的东西，限制你的思想。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_9.png" alt="Struts 2.3.30"></p>
<p>切换到 Gradle 标签，拷贝其中的内容。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_10.png" alt="拷贝 Gradle 依赖"></p>
<p>回到 IDEA，打开 build.gradle，将其粘贴到 dependencies 中。由于之前勾选过 auto-import，即可自动导入。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_11.png" alt="build.gradle"></p>
<p>如果忘记勾选，也可在此手动刷新，让其导入。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_12.png" alt="手动刷新导入"></p>
<p>至此，Struts 2 已经导入该项目，但距离使用还差一点距离。</p>
<h2 id="配置-Tomcat"><a href="#配置-Tomcat" class="headerlink" title="配置 Tomcat"></a>配置 Tomcat</h2><p>虽然我们安装了 Tomcat，也选择了 Web 应用，但并没有部署项目，所以无法运行。点击图中菜单的下三角，选择 Edit Configurations…。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_13.png" alt="Edit Configurations"></p>
<p>点击左上角加号。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_14.png" alt="点击左上角加号"></p>
<p>选择 Tomcate Server - Local。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_15.png" alt="Tomcate Server"></p>
<p>根据下图即可配置 Tomcat。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_16.png" alt="配置 Tomcat"></p>
<p>如果 IDEA Application server 为空，那么需要首先添加 Tomcat 服务器，点击 Configure…，点击新窗口的左上角的加号添加新的服务器，选择 Tomcat 的路径即可（图上已经拥有配置好的两个不同版本的 Tomcat 服务器）。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_17.png" alt="添加 Tomcat 服务器"></p>
<p>回到配置 Tomcat，切换到 Deployment 标签，点击图中的加号，选择 Aritifacts。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_18.png" alt="Deployment"></p>
<p>这里选择 exploded 结尾的 war 包，这是展开的 war，便于重载资源，在开发阶段建议选择此。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_19.png" alt="选择 exploded"></p>
<p>配置完成，点击 OK。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_20.png" alt="配置完成"></p>
<h2 id="添加-web-xml-amp-struts-xml"><a href="#添加-web-xml-amp-struts-xml" class="headerlink" title="添加 web.xml &amp; struts.xml"></a>添加 web.xml &amp; struts.xml</h2><p>点击菜单栏的 Project Structure。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_21.png" alt="Project Structure"></p>
<p>选择左侧 Modules，当前 Web Gradle，点击加号。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_22.png" alt="Modules-Web Gradle"></p>
<p>选择创建 web.xml 的路径，注意在最后不要忘记 web.xml，否则并不会创建。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_23.png" alt="web.xml 路径"></p>
<p>配置 web.xml 完成，点击 OK。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_24.png" alt="配置完成"></p>
<p>struts.xml 可以直接在 resources 目录右键 - New - XML Configuration File - Struts Config，即可生成。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_25.png" alt="新建 struts.xml"></p>
<p>新建完成，IDEA 会检测到 struts.xml，提示配置，选择 Configure，勾选刚刚创建的 struts.xml 以及下面的 struts-default（图中漏掉了），点击 OK。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_26.png" alt="勾选 struts.xml"></p>
<p>配置完成，点击 OK。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/idea_gradle_struts2_27.png" alt="配置完成"></p>
<p>添加完成这两个 xml 文件，但并没有进行内部的配置，web.xml 是必须配置的，可以按照如下配置 Struts 2 过滤器。</p>
<p>web.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></div><div class="line">         <span class="attr">xmlns</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee"</span></div><div class="line">         <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"</span></div><div class="line">         <span class="attr">version</span>=<span class="string">"3.1"</span>&gt;</div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">filter</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></div><div class="line"></div><div class="line">    <span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h2><p>至此，Struts 2 基本配置已经完成，可以简单的在 index.jsp 中测试 Struts 2 的标签即可验证是否成功。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;Ant -&amp;gt; Maven -&amp;gt; Gradle&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Java" scheme="https://maimieng.com/tags/Java/"/>
    
      <category term="Gradle" scheme="https://maimieng.com/tags/Gradle/"/>
    
  </entry>
  
  <entry>
    <title>几种数据结构的多种语言实现</title>
    <link href="https://maimieng.com/2016/20/"/>
    <id>https://maimieng.com/2016/20/</id>
    <published>2016-09-20T16:00:00.000Z</published>
    <updated>2016-09-24T11:48:54.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote class="blockquote-center"><br>Learning data structures by coding in<br>C/C++/Obj-C/Java/Swift.<br></blockquote><br><a id="more"></a></p>
<ul>
<li>Info<ul>
<li>Xcode 8.0</li>
<li>Intellij IDEA 2016.2</li>
</ul>
</li>
</ul>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>数据结构是一门相对抽象，枯燥的课。</p>
<p>这次算是我第五次学数据结构了吧，之前的几次都没跟上，希望这次至少多敲敲代码，熟悉熟悉。代码全部公开，欢迎指出错误。</p>
<h2 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h2><p>本来准备把代码段粘贴到博客中，但是由于文件较多，不好组织，更不便于阅读。因此我在 GitLab 上建立了一个 Group，将所有项目放置于此。</p>
<p>每种数据结构均使用了 5 种编程语言实现，目的是为了巩固基本的语法，也印证了数据结构与具体的编程语言无关。</p>
<p>由于不同语言的特性不同，C 和 Obj-C 均使用特定的整型数据类型（即 <code>int</code>），而 C++ 使用模版来达到泛型的目的，Swift 和 Java 也原生支持泛型，使得数据结构与数据类型解耦。</p>
<h2 id="Loop-Queue"><a href="#Loop-Queue" class="headerlink" title="Loop Queue"></a>Loop Queue</h2><h3 id="C"><a href="#C" class="headerlink" title="C"></a>C</h3><p><a href="https://gitlab.com/data-structure-learning/Loop-Queue-in-C/tree/master/" target="_blank" rel="external">https://gitlab.com/data-structure-learning/Loop-Queue-in-C</a></p>
<h3 id="C-1"><a href="#C-1" class="headerlink" title="C++"></a>C++</h3><p><a href="https://gitlab.com/data-structure-learning/Loop-Queue-in-Cpp/tree/master/" target="_blank" rel="external">https://gitlab.com/data-structure-learning/Loop-Queue-in-Cpp</a></p>
<h3 id="Objective-C"><a href="#Objective-C" class="headerlink" title="Objective-C"></a>Objective-C</h3><p><a href="https://gitlab.com/data-structure-learning/Loop-Queue-in-ObjC/tree/master/" target="_blank" rel="external">https://gitlab.com/data-structure-learning/Loop-Queue-in-ObjC</a></p>
<h3 id="Swift"><a href="#Swift" class="headerlink" title="Swift"></a>Swift</h3><p><a href="https://gitlab.com/data-structure-learning/Loop-Queue-in-Swift/tree/master/" target="_blank" rel="external">https://gitlab.com/data-structure-learning/Loop-Queue-in-Swift</a></p>
<h3 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h3><p><a href="https://gitlab.com/data-structure-learning/Loop-Queue-in-Java/tree/master/" target="_blank" rel="external">https://gitlab.com/data-structure-learning/Loop-Queue-in-Java</a></p>
<h2 id="Stack"><a href="#Stack" class="headerlink" title="Stack"></a>Stack</h2><h3 id="C-2"><a href="#C-2" class="headerlink" title="C"></a>C</h3><p><a href="https://gitlab.com/data-structure-learning/Stack-in-C/tree/master/" target="_blank" rel="external">https://gitlab.com/data-structure-learning/Stack-in-C</a></p>
<h3 id="C-3"><a href="#C-3" class="headerlink" title="C++"></a>C++</h3><p><a href="https://gitlab.com/data-structure-learning/Stack-in-Cpp/tree/master/" target="_blank" rel="external">https://gitlab.com/data-structure-learning/Stack-in-Cpp</a></p>
<h3 id="Objective-C-1"><a href="#Objective-C-1" class="headerlink" title="Objective-C"></a>Objective-C</h3><p><a href="https://gitlab.com/data-structure-learning/Stack-in-ObjC/tree/master/" target="_blank" rel="external">https://gitlab.com/data-structure-learning/Stack-in-ObjC</a></p>
<h3 id="Swift-1"><a href="#Swift-1" class="headerlink" title="Swift"></a>Swift</h3><p><a href="https://gitlab.com/data-structure-learning/Stack-in-Swift/tree/master/" target="_blank" rel="external">https://gitlab.com/data-structure-learning/Stack-in-Swift</a></p>
<h3 id="Java-1"><a href="#Java-1" class="headerlink" title="Java"></a>Java</h3><p><a href="https://gitlab.com/data-structure-learning/Stack-in-Java/tree/master/" target="_blank" rel="external">https://gitlab.com/data-structure-learning/Stack-in-Java</a></p>
<h2 id="Sequence-List"><a href="#Sequence-List" class="headerlink" title="Sequence List"></a>Sequence List</h2><h3 id="C-4"><a href="#C-4" class="headerlink" title="C"></a>C</h3><p><a href="https://gitlab.com/data-structure-learning/Sequence-List-in-C/tree/master/" target="_blank" rel="external">https://gitlab.com/data-structure-learning/Sequence-List-in-C</a></p>
<h3 id="C-5"><a href="#C-5" class="headerlink" title="C++"></a>C++</h3><p><a href="https://gitlab.com/data-structure-learning/Sequence-List-in-Cpp/tree/master/" target="_blank" rel="external">https://gitlab.com/data-structure-learning/Sequence-List-in-Cpp</a></p>
<h3 id="Objective-C-2"><a href="#Objective-C-2" class="headerlink" title="Objective-C"></a>Objective-C</h3><p><a href="https://gitlab.com/data-structure-learning/Sequence-List-in-ObjC/tree/master/" target="_blank" rel="external">https://gitlab.com/data-structure-learning/Sequence-List-in-ObjC</a></p>
<h3 id="Swift-2"><a href="#Swift-2" class="headerlink" title="Swift"></a>Swift</h3><p><a href="https://gitlab.com/data-structure-learning/Sequence-List-in-Swift/tree/master/" target="_blank" rel="external">https://gitlab.com/data-structure-learning/Sequence-List-in-Swift</a></p>
<h3 id="Java-2"><a href="#Java-2" class="headerlink" title="Java"></a>Java</h3><p><a href="https://gitlab.com/data-structure-learning/Sequence-List-in-Java/tree/master/" target="_blank" rel="external">https://gitlab.com/data-structure-learning/Sequence-List-in-Java</a></p>
<h2 id="Link-List"><a href="#Link-List" class="headerlink" title="Link List"></a>Link List</h2><h3 id="C-6"><a href="#C-6" class="headerlink" title="C"></a>C</h3><p><a href="https://gitlab.com/data-structure-learning/Sequence-List-in-C/tree/master/" target="_blank" rel="external">https://gitlab.com/data-structure-learning/Link-List-in-C</a></p>
<h3 id="C-7"><a href="#C-7" class="headerlink" title="C++"></a>C++</h3><p><a href="https://gitlab.com/data-structure-learning/Link-List-in-Cpp/tree/master/" target="_blank" rel="external">https://gitlab.com/data-structure-learning/Link-List-in-Cpp</a></p>
<h3 id="Objective-C-3"><a href="#Objective-C-3" class="headerlink" title="Objective-C"></a>Objective-C</h3><p><a href="https://gitlab.com/data-structure-learning/Link-List-in-ObjC/tree/master/" target="_blank" rel="external">https://gitlab.com/data-structure-learning/Link-List-in-ObjC</a></p>
<h3 id="Swift-3"><a href="#Swift-3" class="headerlink" title="Swift"></a>Swift</h3><p><a href="https://gitlab.com/data-structure-learning/Link-List-in-Swift/tree/master/" target="_blank" rel="external">https://gitlab.com/data-structure-learning/Link-List-in-Swift</a></p>
<h3 id="Java-3"><a href="#Java-3" class="headerlink" title="Java"></a>Java</h3><p><a href="https://gitlab.com/data-structure-learning/Link-List-in-Java/tree/master/" target="_blank" rel="external">https://gitlab.com/data-structure-learning/Link-List-in-Java</a></p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="https://maimieng.com/ipro/interview/">Daily Interview</a><br><a href="http://www.imooc.com/learn/519" target="_blank" rel="external">数据结构探险—队列篇</a><br><a href="http://www.imooc.com/learn/611" target="_blank" rel="external">数据结构探险—栈篇</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;Learning data structures by coding in&lt;br&gt;C/C++/Obj-C/Java/Swift.&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Data Structure" scheme="https://maimieng.com/tags/Data-Structure/"/>
    
  </entry>
  
  <entry>
    <title>小试爬虫</title>
    <link href="https://maimieng.com/2016/19/"/>
    <id>https://maimieng.com/2016/19/</id>
    <published>2016-09-16T16:00:00.000Z</published>
    <updated>2016-09-19T16:54:37.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote class="blockquote-center"><br>Crawler…<br></blockquote><br><a id="more"></a></p>
<ul>
<li>Info:<ul>
<li>macOS 10.12 beta</li>
<li>Python 2.7.10</li>
<li>PyCharm 2016.2</li>
</ul>
</li>
</ul>
<h2 id="安装-Python"><a href="#安装-Python" class="headerlink" title="安装 Python"></a>安装 Python</h2><p>macOS 自带了 2.7 版本的 Python，因此无需安装。</p>
<blockquote>
<p>注意：<br>在 PyCharm 中开发，有时候会默认为 2.6.9 的 Python，在 Preferences-Project: xxx-Project Interpreter 中，将 Python 版本切换为 2.7.10。（我仅在本文的 Demo Pro 中采用了 PyCharm IDE 开发）</p>
</blockquote>
<p>Terminal 输入 <code>python</code>，即可查看 Python 版本。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Python 2.7.10 (default, Aug  1 2016, 20:48:38) </div><div class="line">[GCC 4.2.1 Compatible Apple LLVM 8.0.0 (clang-800.0.34)] on darwin</div><div class="line">Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.</div></pre></td></tr></table></figure>
<p>众所周知，Python 分为两大版本，2.7.x &amp; 3.x，两者是不兼容的，暂时这里以 2.7.x 版本为例。稍后可能更新 3.x 版甚至 Java 版的爬虫 Demo。</p>
<h2 id="安装-pip"><a href="#安装-pip" class="headerlink" title="安装 pip"></a>安装 pip</h2><p>pip 即 Python 的包管理工具，我们需要包管理工具来下载所需要的第三方包。</p>
<p>macOS 虽然有 Python 环境，但是没有 pip 插件。</p>
<p>Terminal 输入 <code>sudo easy_install pip</code>，再输入用户密码即可安装。</p>
<p>Terminal 输入 <code>pip</code>，即可验证安装成功。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Usage:   </div><div class="line">  pip &lt;command&gt; [options]</div><div class="line"></div><div class="line">...</div></pre></td></tr></table></figure>
<h2 id="使用-pip-安装-Beautiful-Soup-4"><a href="#使用-pip-安装-Beautiful-Soup-4" class="headerlink" title="使用 pip 安装 Beautiful Soup 4"></a>使用 pip 安装 Beautiful Soup 4</h2><p>Beautiful Soup 是 Python 的一个第三方包，用于从 HTML 或 XML 文档中提取数据。安装 BS4 的方法有很多，这里使用 pip 安装。</p>
<p>在 Terminal 输入 <code>sudo pip install beautifulsoup4</code>，再输入用户密码即可安装。</p>
<h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><p>以下 Demo 均可以爬取到相关网页的内容，但由于各种原因，以下网站的链接均删去，参考时请根据具体网站具体分析。有些网站的反爬虫机制比较健全，导致返回错误码，可以查阅相关模拟浏览器或模拟登陆的资料。</p>
<h3 id="爬取学校的某个网站的照片"><a href="#爬取学校的某个网站的照片" class="headerlink" title="爬取学校的某个网站的照片"></a>爬取学校的某个网站的照片</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># coding: utf8</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> urllib, urllib2, os, os.path</div><div class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getSoup</span><span class="params">(url)</span>:</span></div><div class="line">    <span class="keyword">if</span> url <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">        <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line">    response = urllib2.urlopen(url)</div><div class="line"></div><div class="line">    <span class="keyword">if</span> response.getcode() != <span class="number">200</span>:</div><div class="line">        <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line">    </div><div class="line">    soup = BeautifulSoup(response, <span class="string">'html.parser'</span>)</div><div class="line">    <span class="keyword">return</span> soup</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getImage</span><span class="params">(url, prefix)</span>:</span></div><div class="line">    soup = getSoup(url)</div><div class="line">    images = soup.find(name=<span class="string">'div'</span>, attrs=&#123;<span class="string">'class'</span>:<span class="string">'six alpha'</span>&#125;).find_all(<span class="string">'img'</span>)</div><div class="line">    i = <span class="number">0</span></div><div class="line">    <span class="keyword">for</span> img <span class="keyword">in</span> images:</div><div class="line">        image = <span class="string">'http://www.ngsying.cn'</span> + images[i][<span class="string">'src'</span>]</div><div class="line">        i += <span class="number">1</span></div><div class="line">        urllib.urlretrieve(image, prefix + <span class="string">' %d.jpg'</span> % i)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">downloadImages</span><span class="params">(urls, marks)</span>:</span></div><div class="line">    i = <span class="number">0</span></div><div class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> urls:</div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(marks[i]):</div><div class="line">            os.mkdir(marks[i])</div><div class="line">        prefix = os.path.join(marks[i], marks[i])</div><div class="line">        getImage(url, prefix)</div><div class="line">        i += <span class="number">1</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    <span class="keyword">print</span> <span class="string">'Welcome to kingcos\' PicDownloader!'</span></div><div class="line"></div><div class="line">    urls = set()</div><div class="line">    marks = []</div><div class="line">    marks.append(<span class="string">'20160910'</span>)</div><div class="line">    marks.append(<span class="string">'20160911'</span>)</div><div class="line">    marks.append(<span class="string">'20160912'</span>)</div><div class="line">    marks.append(<span class="string">'20160913'</span>)</div><div class="line">    marks.append(<span class="string">'20160914'</span>)</div><div class="line">    marks.append(<span class="string">'20160915'</span>)</div><div class="line">    marks.append(<span class="string">'20160916'</span>)</div><div class="line"></div><div class="line">    urls.add(<span class="string">'http://www.***.cn/show.asp?id=67'</span>)</div><div class="line">    urls.add(<span class="string">'http://www.***.cn/show.asp?id=60'</span>)</div><div class="line">    urls.add(<span class="string">'http://www.***.cn/show.asp?id=61'</span>)</div><div class="line">    urls.add(<span class="string">'http://www.***.cn/show.asp?id=62'</span>)</div><div class="line">    urls.add(<span class="string">'http://www.***.cn/show.asp?id=63'</span>)</div><div class="line">    urls.add(<span class="string">'http://www.***.cn/show.asp?id=64'</span>)</div><div class="line">    urls.add(<span class="string">'http://www.***.cn/show.asp?id=65'</span>)</div><div class="line"></div><div class="line">    downloadImages(urls, marks)</div><div class="line">    <span class="keyword">print</span> <span class="string">'Downloading has been finished.'</span></div></pre></td></tr></table></figure>
<h3 id="爬取某图"><a href="#爬取某图" class="headerlink" title="爬取某图"></a>爬取某图</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># coding: utf8</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> urllib, urllib2, os, os.path, random</div><div class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</div><div class="line"></div><div class="line"><span class="keyword">global</span> n</div><div class="line">n = <span class="number">1</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getSoup</span><span class="params">(url)</span>:</span></div><div class="line">    <span class="keyword">if</span> url <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">        <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line">    response = urllib2.urlopen(url)</div><div class="line"></div><div class="line">    <span class="keyword">if</span> response.getcode() != <span class="number">200</span>:</div><div class="line">        <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line">    </div><div class="line">    soup = BeautifulSoup(response, <span class="string">'html.parser'</span>)</div><div class="line">    <span class="keyword">return</span> soup</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getImage</span><span class="params">(url, prefix)</span>:</span></div><div class="line">    soup = getSoup(url)</div><div class="line">    images = soup.find(name=<span class="string">'div'</span>, attrs=&#123;<span class="string">'id'</span>:<span class="string">'srcPic'</span>&#125;).find_all(<span class="string">'img'</span>)</div><div class="line">    i = <span class="number">0</span></div><div class="line">    <span class="keyword">for</span> img <span class="keyword">in</span> images:</div><div class="line">        image = images[i][<span class="string">'src'</span>]</div><div class="line">        i += <span class="number">1</span></div><div class="line">        <span class="keyword">global</span> n</div><div class="line">        urllib.urlretrieve(image, prefix + <span class="string">' %d.jpg'</span> % n)</div><div class="line">        n += <span class="number">1</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">downloadImages</span><span class="params">(urls, marks)</span>:</span></div><div class="line">    i = <span class="number">0</span></div><div class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> urls:</div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(marks[i]):</div><div class="line">            os.mkdir(marks[i])</div><div class="line">        prefix = os.path.join(marks[i], marks[i])</div><div class="line">        getImage(url, prefix)</div><div class="line">        <span class="comment"># i += 1</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    <span class="keyword">print</span> <span class="string">'Welcome to kingcos\' PicDownloader!'</span></div><div class="line"></div><div class="line">    urls = set()</div><div class="line">    marks = []</div><div class="line">    marks.append(<span class="string">'24974'</span>)</div><div class="line"></div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">10</span>):</div><div class="line">        url = <span class="string">'http://www.***.com/meimei/24974-'</span> + str(i) + <span class="string">'.html'</span></div><div class="line">        urls.add(url)</div><div class="line"></div><div class="line">    downloadImages(urls, marks)</div><div class="line">    <span class="keyword">print</span> <span class="string">'Downloading has been finished.'</span></div></pre></td></tr></table></figure>
<h3 id="爬取某站图片"><a href="#爬取某站图片" class="headerlink" title="爬取某站图片"></a>爬取某站图片</h3><p>该网站有一定的反爬机制，通过设置 header 绕过。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># coding: utf8</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> urllib, urllib2, os, os.path, random</div><div class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getSoup</span><span class="params">(url)</span>:</span></div><div class="line">    <span class="keyword">if</span> url <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">        <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line">    header = &#123; <span class="string">"User-Agent"</span>: <span class="string">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.116 Safari/537.36'</span> &#125;</div><div class="line">    req = urllib2.Request(url, headers=header)</div><div class="line">    response = urllib2.urlopen(req)</div><div class="line"></div><div class="line">    <span class="keyword">if</span> response.getcode() != <span class="number">200</span>:</div><div class="line">        <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line">    </div><div class="line">    soup = BeautifulSoup(response, <span class="string">'html.parser'</span>)</div><div class="line">    <span class="keyword">return</span> soup</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getImage</span><span class="params">(url, prefix)</span>:</span></div><div class="line">    soup = getSoup(url)</div><div class="line">    images = soup.find(name=<span class="string">'div'</span>, attrs=&#123;<span class="string">'class'</span>:<span class="string">'main-body'</span>&#125;).find_all(<span class="string">'a'</span>)</div><div class="line">    i = <span class="number">0</span></div><div class="line">    <span class="keyword">for</span> img <span class="keyword">in</span> images:</div><div class="line">        image = img[<span class="string">'href'</span>]</div><div class="line">        i += <span class="number">1</span></div><div class="line">        urllib.urlretrieve(image, prefix + <span class="string">' %d.jpg'</span> % i)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">downloadImages</span><span class="params">(urls, marks)</span>:</span></div><div class="line">    i = <span class="number">0</span></div><div class="line">    <span class="keyword">for</span> url <span class="keyword">in</span> urls:</div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(marks[i]):</div><div class="line">            os.mkdir(marks[i])</div><div class="line">        prefix = os.path.join(marks[i], marks[i])</div><div class="line">        getImage(url, prefix)</div><div class="line">        i += <span class="number">1</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    <span class="keyword">print</span> <span class="string">'Welcome to kingcos\' PicDownloader!'</span></div><div class="line"></div><div class="line">    urls = set()</div><div class="line">    marks = [<span class="string">'14007'</span>, <span class="string">'13998'</span>, <span class="string">'13987'</span>]</div><div class="line"></div><div class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> marks:</div><div class="line">        url = <span class="string">'http://www.***.***/'</span> + m + <span class="string">'/'</span></div><div class="line">        urls.add(url)</div><div class="line"></div><div class="line">    downloadImages(urls, marks)</div><div class="line">    <span class="keyword">print</span> <span class="string">'Downloading has been finished.'</span></div></pre></td></tr></table></figure>
<h2 id="Demo-Pro"><a href="#Demo-Pro" class="headerlink" title="Demo Pro"></a>Demo Pro</h2><p>上面的 Demo 仅仅是爬去某个单独的网页，下面是可以爬取<strong>相关</strong>链接指定图片的 Demo。即指定一个根 URL，其可以爬取到其他符合条件的 URL，进而爬取其中的内容，而不局限于传入的指定 URL。测试爬取了 1000+ 张图片。</p>
<h3 id="爬去某站的相关图片"><a href="#爬去某站的相关图片" class="headerlink" title="爬去某站的相关图片"></a>爬去某站的相关图片</h3><p>crawler_main.py</p>
<blockquote>
<p>入口主函数：<br>负责统一调用其他类的方法</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># coding: utf8</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> Crawler <span class="keyword">import</span> url_manager, html_downloader, html_parser, html_outputer</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">CrawlerMain</span><span class="params">(object)</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.urls = url_manager.UrlManager()</div><div class="line">        self.downloader = html_downloader.HtmlDownloader()</div><div class="line">        self.parser = html_parser.HtmlParser()</div><div class="line">        self.outputer = html_outputer.HtmlOutputer()</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">craw</span><span class="params">(self, root_url)</span>:</span></div><div class="line">        count = <span class="number">1</span></div><div class="line">        self.urls.add_new_url(root_url)</div><div class="line">        <span class="keyword">while</span> self.urls.has_new_url():</div><div class="line">            <span class="keyword">try</span>:</div><div class="line">                new_url = self.urls.get_new_url()</div><div class="line">                <span class="keyword">print</span> <span class="string">'craw %d: %s'</span> % (count, new_url)</div><div class="line">                html_cont = self.downloader.download(new_url)</div><div class="line">                new_urls, new_data = self.parser.parse(new_url, html_cont)</div><div class="line">                self.urls.add_new_urls(new_urls)</div><div class="line">                self.outputer.collect_data(new_data)</div><div class="line"></div><div class="line">                <span class="keyword">if</span> count == <span class="number">100</span>:</div><div class="line">                    <span class="keyword">break</span></div><div class="line">                count += <span class="number">1</span></div><div class="line">            <span class="keyword">except</span>:</div><div class="line">                <span class="keyword">print</span> <span class="string">'Crawl finished!'</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</div><div class="line">    <span class="keyword">print</span> <span class="string">'Welcome to kingcos\' PicDownloader!'</span></div><div class="line">    root_url = <span class="string">'http://www.***.***/'</span></div><div class="line">    obj_spider = CrawlerMain()</div><div class="line">    obj_spider.craw(root_url)</div></pre></td></tr></table></figure>
<p>url_manager.py</p>
<blockquote>
<p>URL 管理器：<br>负责管理 URL，包括添加新 URL，判断是非存在未爬取链接等方法</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># coding: utf8</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">UrlManager</span><span class="params">()</span>:</span></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></div><div class="line">        self.new_urls = set()</div><div class="line">        self.old_urls = set()</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_new_url</span><span class="params">(self, url)</span>:</span></div><div class="line">        <span class="keyword">if</span> url <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            <span class="keyword">return</span></div><div class="line">        <span class="keyword">if</span> url <span class="keyword">not</span> <span class="keyword">in</span> self.new_urls <span class="keyword">and</span> url <span class="keyword">not</span> <span class="keyword">in</span> self.old_urls:</div><div class="line">            self.new_urls.add(url)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">add_new_urls</span><span class="params">(self, urls)</span>:</span></div><div class="line">        <span class="keyword">if</span> urls <span class="keyword">is</span> <span class="keyword">None</span> <span class="keyword">or</span> len(urls) == <span class="number">0</span>:</div><div class="line">            <span class="keyword">return</span></div><div class="line">        <span class="keyword">for</span> url <span class="keyword">in</span> urls:</div><div class="line">            self.add_new_url(url)</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">has_new_url</span><span class="params">(self)</span>:</span></div><div class="line">        <span class="keyword">return</span> len(self.new_urls) != <span class="number">0</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_new_url</span><span class="params">(self)</span>:</span></div><div class="line">        new_url =  self.new_urls.pop()</div><div class="line">        self.old_urls.add(new_url)</div><div class="line">        <span class="keyword">return</span> new_url</div></pre></td></tr></table></figure>
<p>html_downloader.py</p>
<blockquote>
<p>HTML 下载器：<br>负责传回指定 URL 的响应</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># coding: utf8</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> urllib2</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">HtmlDownloader</span><span class="params">()</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">download</span><span class="params">(self, url)</span>:</span></div><div class="line">        <span class="keyword">if</span> url <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line">        header = &#123;</div><div class="line">            <span class="string">"User-Agent"</span>: <span class="string">'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.116 Safari/537.36'</span>&#125;</div><div class="line">        req = urllib2.Request(url, headers=header)</div><div class="line">        response = urllib2.urlopen(req)</div><div class="line"></div><div class="line">        <span class="keyword">if</span> response.getcode() != <span class="number">200</span>:</div><div class="line">            <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line">        <span class="keyword">return</span> response</div></pre></td></tr></table></figure>
<p>html_parser.py</p>
<blockquote>
<p>HTML 转换器：<br>对新的 URL 对应的 HTML 分析，提取所需内容，并提取符合需求的 URL，加入到待爬取 URL 集合。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># coding: utf8</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> re, urlparse</div><div class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">HtmlParser</span><span class="params">()</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_get_new_urls</span><span class="params">(self, page_url, soup)</span>:</span></div><div class="line">        new_urls = set()</div><div class="line">        links = soup.find_all(<span class="string">'a'</span>, href = re.compile(<span class="string">r"http://www.***.***/\d+/"</span>))</div><div class="line">        <span class="keyword">for</span> link <span class="keyword">in</span> links:</div><div class="line">            new_url = link[<span class="string">'href'</span>]</div><div class="line">            new_full_url = urlparse.urljoin(page_url, new_url)</div><div class="line">            new_urls.add(new_full_url)</div><div class="line">        <span class="keyword">return</span> new_urls</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_get_new_data</span><span class="params">(self, page_url, soup)</span>:</span></div><div class="line">        res_data = &#123;&#125;</div><div class="line">        res_data[<span class="string">'url'</span>] = page_url</div><div class="line">        images = soup.find(name=<span class="string">'div'</span>, attrs=&#123;<span class="string">'class'</span>:<span class="string">'main-body'</span>&#125;).find_all(<span class="string">'a'</span>)</div><div class="line">        <span class="keyword">return</span> images</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">parse</span><span class="params">(self, page_url, html_cont)</span>:</span></div><div class="line"></div><div class="line">        <span class="keyword">if</span> page_url <span class="keyword">is</span> <span class="keyword">None</span> <span class="keyword">or</span> html_cont <span class="keyword">is</span> <span class="keyword">None</span>:</div><div class="line">            <span class="keyword">return</span></div><div class="line">        </div><div class="line">        soup = BeautifulSoup(html_cont, <span class="string">'html.parser'</span>)</div><div class="line">        new_urls = self._get_new_urls(page_url, soup)</div><div class="line">        new_data = self._get_new_data(page_url, soup)</div><div class="line">        <span class="keyword">return</span> new_urls, new_data</div></pre></td></tr></table></figure>
<p>html_outputer.py</p>
<blockquote>
<p>HTML 输出器：<br>对收集到数据进行取回，放置在本地文件夹内</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># coding: utf8</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> urllib, random, os</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">HtmlOutputer</span><span class="params">()</span>:</span></div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">def</span> <span class="title">collect_data</span><span class="params">(self, images)</span>:</span></div><div class="line">        i = <span class="number">0</span></div><div class="line">        <span class="keyword">for</span> img <span class="keyword">in</span> images:</div><div class="line">            image = img[<span class="string">'href'</span>]</div><div class="line">            i += <span class="number">1</span></div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="string">'img'</span>):</div><div class="line">                os.mkdir(<span class="string">'img'</span>)</div><div class="line">            prefix = os.path.join(<span class="string">'img'</span>, <span class="string">'img'</span>)</div><div class="line">            urllib.urlretrieve(image, prefix + <span class="string">'%d'</span> % i + str(random.randint(<span class="number">1</span>, <span class="number">100</span>)) + <span class="string">'.jpg'</span>)</div></pre></td></tr></table></figure>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="http://www.imooc.com/learn/177" target="_blank" rel="external">Python 入门</a><br><a href="http://www.imooc.com/learn/563" target="_blank" rel="external">Python 开发简单爬虫</a><br><a href="https://www.crummy.com/software/BeautifulSoup/" target="_blank" rel="external">Beautiful Soup 官方网站</a><br><a href="https://www.crummy.com/software/BeautifulSoup/bs4/doc/" target="_blank" rel="external">Beatiful Soup 4 Docs</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;Crawler…&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Python" scheme="https://maimieng.com/tags/Python/"/>
    
  </entry>
  
  <entry>
    <title>谈谈组装电脑</title>
    <link href="https://maimieng.com/2016/18/"/>
    <id>https://maimieng.com/2016/18/</id>
    <published>2016-09-02T16:00:00.000Z</published>
    <updated>2016-09-04T15:54:13.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote class="blockquote-center"><br>自从入了 Mac 坑，<br>就暂时没考虑过组装电脑，<br>谈谈这次帮同学装机…<br></blockquote><br><a id="more"></a></p>
<h2 id="我的电脑"><a href="#我的电脑" class="headerlink" title="我的电脑"></a>我的电脑</h2><p>家里的第一台电脑是 2007 年暑假买的，当时是父亲央求其同事，在电脑城配了一个总价 4000 元整的组装电脑。</p>
<p>这台组装电脑的配置我很早就用鲁大师看过，但已不记得 CPU 型号等等细节，只是知道 1G 的内存，以及一块 160G 的机械硬盘。由于种种原因，2012 年我用自己「积蓄」买了一台 11 寸宏碁上网本，4G 内存 500G 硬盘。虽然是奔腾处理器，没有独立显卡，但用起来很舒心。也被我折腾得跑过 Windows XP/7/8/8.1，Ubuntu，以及 Mac OS X，但是由于显卡无法驱动，便作罢。曾经想写一篇文章纪念这台上网本，结果丢在简书，只写了个开头就没再深入。</p>
<p>后来我把它卖了，700 元。现在想想有点后悔，这也许是我用的最久的一手电子设备。之后我入了一台二手 Mac mini，买了一台新显示器，一套键鼠，一块移动硬盘。第一次使用 Mac 觉得很好，可惜主机晚上宿舍一熄灯便不能使用，也不便携，便出手了。在体验过 Mac mini 之后，我就知道二手 Mac 的配置是绝对够用的，毕竟新的太贵，无法承受。</p>
<p>在出手 Mac mini 之后，我便在寻找合适的二手 MacBook Pro。最后入手了 MD313，本来是考虑 MD101，因为 MD101 与我之前的 Mac mini 配置相同。可惜预算有限，便入了配置更差的 MD313。这台 MacBook Pro 8G 内存，160G 固态，也足以满足不玩游戏的我了。实际使用中，代码的编译速度远大于自带机械硬盘的 PC 唯一的槽点便是固态太小，但我又觉得没必要再加固态。最后，在陪伴我整个大二时光之后，我把这台电脑也出了，换成了现在手里的 ME865。</p>
<p>我想，暂时没必要也没理由再换了吧？</p>
<h2 id="谈谈组装"><a href="#谈谈组装" class="headerlink" title="谈谈组装"></a>谈谈组装</h2><p>其实在升入大学，就基本没有考虑过组装机。一是我不玩游戏，没必要组装高性能的主机；二是主机不便携，而我习惯背着电脑跑。所以这两点就基本告别组装机了。这次也是受同学之托，帮其查阅了很多资料，才敲定的。其实对组装电脑了解不多，但经过许久的搜索和爬贴，也知道了很多新的知识。</p>
<p>组装电脑比笔记本性能高，散热好；比整机购买更靠谱；又能自己体验装机的过程，被许多游戏玩家追捧。「整机烈士墙」的悲剧也几乎不会发生，只有 CPU 选择淘宝购买散片，因为暂时没有可以仿造的。其他配件均为京东购买，如果有质量问题，京东的退换货服务可以更好地解决。</p>
<h2 id="组装之选"><a href="#组装之选" class="headerlink" title="组装之选"></a>组装之选</h2><p>若想参考，注意时效性及个人用途。</p>
<table>
<thead>
<tr>
<th>Name</th>
<th style="text-align:center">Price</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>淘宝</strong></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>CPU：Intel E3-1230 v3</td>
<td style="text-align:center">1422</td>
</tr>
<tr>
<td><strong>京东</strong></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>机箱：爱国者 黑暗骑士 D8</td>
<td style="text-align:center">139</td>
</tr>
<tr>
<td>显示器：三星 C24F390H 23.5寸曲面</td>
<td style="text-align:center">979</td>
</tr>
<tr>
<td>主板：技嘉 B85-HD3</td>
<td style="text-align:center">549</td>
</tr>
<tr>
<td>显卡：索泰 GTX1060-3G</td>
<td style="text-align:center">1799</td>
</tr>
<tr>
<td>内存：金士顿 骇客神条8G</td>
<td style="text-align:center">278</td>
</tr>
<tr>
<td>硬盘：东芝 Q300 240G</td>
<td style="text-align:center">409</td>
</tr>
<tr>
<td>电源：安钛克 VP500P 500W</td>
<td style="text-align:center">299</td>
</tr>
<tr>
<td>散热：九州风神 玄冰400</td>
<td style="text-align:center">99.9</td>
</tr>
<tr>
<td></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>京东总计：4551.9-150-10</td>
<td style="text-align:center">4391.9</td>
</tr>
<tr>
<td>合计：</td>
<td style="text-align:center">5813.9</td>
</tr>
</tbody>
</table>
<h2 id="一点小经验…"><a href="#一点小经验…" class="headerlink" title="一点小经验…"></a>一点小经验…</h2><p>组装电脑最重要的是配置的选择，建议大家多在贴吧或专业论坛寻找，因为这里消息更新速度足够快。配置是完全跟个人预算及用途相关的，切忌眼高手低。组装电脑由于其灵活性，有远见的同学需要考虑到未来的升级。</p>
<p>京东的发货速度很快，前一天下单，第二天中午就到货了。京东的产品没话说，但为了防止二手东，也需要检查配件的密封。</p>
<p>关于发票，这次是替他人购买，为方便对方留存，选择了纸质发票。发票的抬头在下单时选择，不等同于收货人姓名。如果是自己下单，可以选择电子发票，环保不易丢。虽说凭发票保修有时候已经是多余之选，但有些时候还是需要提供必要的发票来维护自己权益。</p>
<p>这次组装电脑花费了 3 个多小时，说实话这是我第一次组装。如果都是新手，建议查阅相关教程视频，配合说明书组装，有不确定的接口一定先搜索在尝试。组装过程注意安全，散热器的散热片以及机箱处都有可能刮伤（别问我为什么 T T）。</p>
<p>组装的过程是比较顺利的，中途没有测试，组装完全才开机，一次点亮。由于学校网络故障，「娱乐大师」没有测试。不过整体的配置应当是足够的，关于这些配件，需要注意的是，如果选择的是 2.5 寸固态硬盘，可以到淘宝选购 3.5 寸的硬盘支架，方便固定硬盘。这点在拿到快递之前，是没有想到的。还有一点，如果追求音质，不妨在购机之时选择合适的音箱。</p>
<p>说说这次选择比较不太好的一点，机箱。建议在选购时选择质量更好，更合理的机箱。需要考虑到整体的体积大小，主板的大小，电源的上置或是下置，USB 等拓展口的位置，以及是否可走背线。如果想双显卡交火，那么机箱要选择足够容纳的。这次买的机箱性价比还是很高的，但是感觉做工一般，如果对机箱要求较高，也可以到实体店选购。</p>
<p>总的来说这次装机还是比较顺利的，这些配件也是足够坚固的，耐得起折腾。有一定动手能力的新手是完全可以自我尝试的。但一定的参考也是必要的。</p>
<p>当然这点小经验是对于几乎没有经验的小白，或是提醒自己而写的，如果有所差错，我也愿意倾听，知错便改。也谢谢相信我的这两位同学，能够有机会自己尝试装机。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;自从入了 Mac 坑，&lt;br&gt;就暂时没考虑过组装电脑，&lt;br&gt;谈谈这次帮同学装机…&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="PC" scheme="https://maimieng.com/tags/PC/"/>
    
  </entry>
  
  <entry>
    <title>Sketch 中的版本控制</title>
    <link href="https://maimieng.com/2016/17/"/>
    <id>https://maimieng.com/2016/17/</id>
    <published>2016-09-01T16:00:00.000Z</published>
    <updated>2016-10-02T12:18:05.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote class="blockquote-center"><br>Sketch 是一款矢量图设计软件，<br>简单搭配 git-sketch-plugin 插件，<br>即可实现对其版本控制。<br></blockquote><br><a id="more"></a></p>
<ul>
<li>Info:<ul>
<li>Sketch 39.1</li>
<li><a href="https://github.com/mathieudutour/git-sketch-plugin" target="_blank" rel="external">git-sketch-plugin 0.7</a></li>
<li><a href="https://gitlab.com/u/kingcos" target="_blank" rel="external">GitLab</a></li>
<li>SourceTree</li>
</ul>
</li>
</ul>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>前几日在 V 站看到有人提出关于 Sketch 版本控制的问题。才发现 Sketch 已有插件支持更加方便的版本控制。Google 了下，可能是设计师对 Git 了解较少，也可能是版本控制对于非文本的支持并不能体现其优越性，所以可能很多专业的设计师并不会采用 Git。但作为程序员对于 Git 等版本控制系统应当是有所了解，而且通过插件可以更简单的查看不同版本的区别。因此，这次就来尝试下如何进行 Sketch 中的版本控制。</p>
<p>PS: 该插件的作者更新的速度可能较快，仅仅在本文修改的几天，就更新了两次，但基本使用应该不会有太大变化。</p>
<h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><h3 id="安装-git-sketch-plugin-插件"><a href="#安装-git-sketch-plugin-插件" class="headerlink" title="安装 git-sketch-plugin 插件"></a>安装 git-sketch-plugin 插件</h3><p><em>可参考 <a href="https://github.com/mathieudutour/git-sketch-plugin" target="_blank" rel="external">https://github.com/mathieudutour/git-sketch-plugin</a> README 中的 Installation 部分。</em></p>
<p>1.下载插件。最新发行版本地址：<a href="https://github.com/mathieudutour/git-sketch-plugin/releases" target="_blank" rel="external">https://github.com/mathieudutour/git-sketch-plugin/releases</a><br>2.解压后双击 Git.sketchplugin 即可自动安装至 Sketch 中。<br>3.如图弹窗，即安装好插件。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_1.png" alt="如图即安装好插件"></p>
<p>之后可以按个人喜好对该插件设置。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_2.png" alt="插件的 Preference"></p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_3.png" alt="Preference"></p>
<p>设置保存成功将会在屏幕下方出现如图标识。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_4.png" alt="插件保存设置成功"></p>
<h3 id="配置-Git-仓库"><a href="#配置-Git-仓库" class="headerlink" title="配置 Git 仓库"></a>配置 Git 仓库</h3><p>这里使用的是 GitLab 来进行托管，也可以选择 GitHub 或是国内的 Coding.net 等。这里由于以后打算模仿一些好的设计，所以建立了一个 Group，之后可以在这个组内新建 Project，方便管理。</p>
<p>Group 常用于多人协作，方便管理每个人的权限，这里对其建立过程，不再叙述，可自行尝试。这里简要叙述如何在 GitLab 上建立 Project。</p>
<p>点击 <strong>New Project</strong></p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_5.png" alt="点击 New Project"></p>
<p>输入项目名称，描述（可选），以及可见等级。</p>
<p>可见等级即该项目的可见程度。Private 为私有项目，如果他人想访问则必须被授权；Internal 为内部项目，在 Group 内的成员即可访问；Public 为公有项目，所有人可以访问。</p>
<p>这里我选择 Public，方便交流共享。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_6.png" alt="填写相应信息"></p>
<p>点击 <strong>Create Project</strong> 看到如图，即创建成功。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_7.png" alt="创建 Project 成功"></p>
<p>创建 Project 后，通常需要配置 README.md, LICENSE, .gitignore 文件。由于 Sketch 非文本格式，所以不需要 .gitignore 文件。README.md 文件是描述项目的文件，当他人打开项目主页，下方会将其内容自动渲染（markdown 格式）。LICENSE 是版权声明，我通常选择较为宽松的 MIT LICENSE，若是商业项目，请咨询后添加。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_8.png" alt="添加了 README.md 和 LICENSE"></p>
<h3 id="配置-SSH"><a href="#配置-SSH" class="headerlink" title="配置 SSH"></a>配置 SSH</h3><p>本地想要将变更推送到远程的 Git 服务器，可以通过 HTTPS 或 SSH 进行连接。HTTPS 需要每次验证用户名及密码，（插件貌似不支持，测试时失败，待确定）。SSH 需要将本地密钥填入到 GitLab 中，这里不详述如何生成密钥，建议参考 GitLab 相应页面的有关介绍。</p>
<p>填入 SSH Key。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_9.png" alt="SSH Key 填写页面"></p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_10.png" alt="添加成功 SSH Key"></p>
<p>成功添加之后，我们可以在 Terminal 验证，输入 <code>ssh -T git@gitlab.com</code>。第一次时，有个警告，需要输入 <code>yes</code>，如果成功即可显示你的用户名，如果不成功，可能是 Git 中的用户名和 GitLab 不一致。可以通过以下命令全局设置，注意用户名和邮箱替换成自己的，并与所用的 GitLab 用户名以及邮箱一致。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">git config --global user.name &quot;&lt;username&gt;&quot;  </div><div class="line">git config --global user.email &lt;email&gt;</div></pre></td></tr></table></figure>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_11.png" alt="SSH 连接测试成功"></p>
<h3 id="本地配置"><a href="#本地配置" class="headerlink" title="本地配置"></a>本地配置</h3><p>在 Projetc 中切换为 SSH，复制 SSH URL，这将作为本地计算机连接远程 Git 仓库的 URL。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_12.png" alt="复制 SSH URL"></p>
<p>之后，我们需要克隆仓库，熟悉 Terminal 的同学可以直接 <code>git clone &lt;git-remote-repository-url&gt; &lt;local-directory&gt;</code> 克隆到本地。也可以通过 SourceTree 来管理。</p>
<p>打开 SourceTree，点击 <strong>+ 新仓库</strong>，点击从 <strong>URL 克隆</strong>。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_13.png" alt="SourceTree + 新仓库-从 URL 克隆"></p>
<p>将刚才拷贝的 URL 粘贴到<strong>源 URL</strong>，后续两条会自动填充，也可按照个人喜好修改。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_14.png" alt="填入源 URL"></p>
<p>填入后点击<strong>克隆</strong>，稍等片刻即可成功克隆到本地。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_15.png" alt="成功克隆仓库到本地"></p>
<p>在 Finder 中可以看到刚才添加的 README.md 以及 LICENSE 文件也存在，.git 的隐藏文件夹即表明当前文件夹已受 Git 版本控制。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_16.png" alt="Finder 中的仓库"></p>
<p>以后即可在该目录新建 Sketch 文件，或者将已存在的 Sketch 拷贝至此目录即可。我们这里新建 Sketch 文件以演示。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_17.png" alt="在克隆仓库的目录处新建 Sketch 文件"></p>
<p>之后，我们需要保存文件，Cmd + s。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_18.png" alt="保存文件"></p>
<h3 id="git-add"><a href="#git-add" class="headerlink" title="git-add"></a>git-add</h3><p>如果有文件想要被 Git 所管理，我们需要将其添加到 Git 中。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_19.png" alt="Add file to git"></p>
<p>如果出现如下错误，可以参考本文下方的资料解决。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_20.png" alt="shell_session_update: command not found"></p>
<p>如图即添加成功。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_21.png" alt="添加到 Git 成功"></p>
<h3 id="git-commit"><a href="#git-commit" class="headerlink" title="git-commit"></a>git-commit</h3><p>当我们的文件受 Git 控制，我们就可以开始做设计了。我这里是模仿 Wunderlist 的 icon。当制作完成，我们可以 commit 一下，提交更改。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_22.png" alt="Commit"></p>
<p>输入更改的简介，并勾选自动生成示意图。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_23.png" alt="Commit 界面"></p>
<p>成功后，屏幕下方会有提示（消失太快，没截到图）。如果 Commit 成功，这时就可以打开 SourceTree 看到新的 Commit。</p>
<h3 id="git-push"><a href="#git-push" class="headerlink" title="git-push"></a>git-push</h3><p>当我们需要将本地的更改推送到远程服务器（例如 GitLab），那么就需要 Push。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_24.png" alt="Push"></p>
<p>Push 操作是需要连网的，需要一定的时间。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_25.png" alt="Push 成功"></p>
<p>成功之后我们就可以在 GitLab 上查看到新的更改。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_26.png" alt="Push 后的 GitLab"></p>
<p>而我们没有手动导出的示意图便自动生成，如果在进行一个版本更迭的设计时，那么我们就能更清晰的知道多种设计的不同。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/gitforsketch_27.png" alt="自动生成的示意图"></p>
<h2 id="后话…"><a href="#后话…" class="headerlink" title="后话…"></a>后话…</h2><p>Git 和 SVN 都是很好的版本控制系统，在群里也看到有设计师使用 CornerStone（SVN 客户端）来进行版本管理。</p>
<p>不管用什么工具，设计本身才是重要的，希望能坚持下来，Design by heart…</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p><a href="http://superuser.com/questions/1044130/why-am-i-having-how-can-i-fix-this-error-shell-session-update-command-not-f" target="_blank" rel="external">Why am I having / how can I fix this error: “shell_session_update: command not found”</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;Sketch 是一款矢量图设计软件，&lt;br&gt;简单搭配 git-sketch-plugin 插件，&lt;br&gt;即可实现对其版本控制。&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Sketch" scheme="https://maimieng.com/tags/Sketch/"/>
    
      <category term="Git/GitHub" scheme="https://maimieng.com/tags/Git-GitHub/"/>
    
  </entry>
  
  <entry>
    <title>浅谈 UIImage 内存管理问题</title>
    <link href="https://maimieng.com/2016/16/"/>
    <id>https://maimieng.com/2016/16/</id>
    <published>2016-08-13T16:00:00.000Z</published>
    <updated>2016-08-29T03:24:02.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote class="blockquote-center"><br>探究 iOS 中 UIImage 中两种不同 Initializers 带来的内存问题<br>本文使用 Swift 版本为 3.0 beta。<br></blockquote><br><a id="more"></a></p>
<ul>
<li>Info:<ul>
<li>Swift 3.0 beta</li>
<li>Xcode 8.0 beta 5</li>
<li>macOS Sierra Public Beta 3</li>
</ul>
</li>
</ul>
<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>近几天接触 iOS 的 UI 学习，由于 Swift 更新太快太频繁，因此看的是 Obj-C 的项目，自己修改为 Swift 3.0 beta 可编译运行的版本。Xcode 8.0 随着几个版本的更迭也趋于稳定，不过在不同 beta 版中，Swift 3.0 beta 的语法也略有改动，之前整理的 <a href="https://maimieng.com/ipro/note">初探 Swift 3.0 系列</a>也会略有过时了。这次是制作一个简单的图片浏览器，而且会动态的展示（伪） GIF 动画，因此需要处理 animation 以及多张图片。如果不进行适当的内存管理，那么大量的图片占用内存，将使得程序在 iOS 设备上崩溃，造成极差的用户体验。因此本文浅显地分析两种不同的 <code>UIImage</code> 初始化方法，为以后的使用做以适当铺垫。</p>
<p>不过，鉴于刚刚入门 iOS，所以某些行为或说法也许不太得当，需要学习的地方还有很多，故若有纰漏，还望指出。</p>
<h3 id="init-named-String"><a href="#init-named-String" class="headerlink" title="init?(named: String)"></a><code>init?(named: String)</code></h3><blockquote>
<p>Loading and Caching Images <code>init?(named: String)</code><br>Returns the image object associated with the specified filename.<br><strong>Discussion</strong><br>This method looks in the system caches for an image object with the specified name and returns the variant of that image that is best suited for the main screen. If a matching image object is not already in the cache, this method locates and loads the image data from disk or from an available asset catalog, and then returns the resulting object.<br>The system may purge cached image data at any time to free up memory. Purging occurs only for images that are in the cache but are not currently being used.<br>In iOS 9 and later, this method is thread safe.<br><strong>Special Considerations</strong><br>If you have an image file that will only be displayed once and wish to ensure that it does not get added to the system’s cache, you should instead create your image using <code>imageWithContentsOfFile:</code>. This will keep your single-use image out of the system image cache, potentially improving the memory use characteristics of your app.</p>
<p><strong>加载并缓存图像</strong> <code>init?(named: String)</code><br>返回指定文件名所关联的图像对象。<br><strong>论述</strong><br>该方法在系统缓存中寻找指定名称的图像对象，并返回最适合主屏幕的图像的变体。若对应的图像对象已不存在于缓存，则该方法将在磁盘或存在的资源目录中定位并载入图像数据，并返回结果对象。<br>系统可能随时清空图像数据以释放内存。清空操作只会发生在处于缓存但当前未被使用的图像。<br>在 iOS 9 及以上版本，该方法是线程安全的。<br><strong>特殊考虑</strong><br>如果图像文件只需显示一次，且希望确保其不会被添加到系统的缓存中，你应当使用 <code>imageWithContentsOfFile:</code> 方法。该方法将保证其在系统图像缓存以外的单一使用，潜在提升 app 的内存使用特性。</p>
</blockquote>
<h3 id="init-contentsOfFile-String"><a href="#init-contentsOfFile-String" class="headerlink" title="init?(contentsOfFile: String)"></a><code>init?(contentsOfFile: String)</code></h3><blockquote>
<p>Creating and Initializing Image Objects <code>init?(contentsOfFile: String)</code><br>Initializes and returns the image object with the contents of the specified file.<br><strong>Discussion</strong><br>This method loads the image data into memory and marks it as purgeable. If the data is purged and needs to be reloaded, the image object loads that data again from the specified path.</p>
<p><strong>创建并初始化图像对象</strong> <code>init?(contentsOfFile: String)</code><br>初始化并返回指定文件内容的图像对象。<br><strong>论述</strong><br>该方法加载图像数据到内存，并标记其可以被清空。如果数据被清空，需要重新载入，图像对象将会从指定路径再次加载数据。</p>
</blockquote>
<h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><p>如苹果官方文档所述，这两个 Initializer 虽然都是加载图片，但是一个做了缓存，另一个并没有。所以 <code>init?(named: String)</code> 更适合加载 icon 等占用小的图片，而 <code>init?(contentsOfFile: String)</code> 适合较大的图片。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// init?(named: String)</span></div><div class="line"><span class="keyword">let</span> demoIcon = <span class="type">UIImage</span>(named: <span class="string">"DemoIcon"</span>)</div><div class="line"></div><div class="line"><span class="comment">// init?(contentsOfFile: String)</span></div><div class="line"><span class="keyword">let</span> demoImagePath = <span class="type">Bundle</span>.main.path(forResource: <span class="string">"DemoImage.png"</span>, ofType: <span class="literal">nil</span>)</div><div class="line"><span class="keyword">let</span> demoImage = <span class="type">UIImage</span>(contentsOfFile: demoImagePath ?? <span class="string">""</span>)</div></pre></td></tr></table></figure>
<p><code>init?(named: String)</code> 常用于加载小且常用的 icon，其初始化的图片，占用的缓存只会在程序退出时才清空，即使消除强引用仍会占用缓存。而 <code>init?(contentsOfFile: String)</code> 初始化的图片，在没有强引用时便会自动销毁。</p>
<p>而 <code>init?(contentsOfFile: String)</code> 使用有一些注意点。该方法的参数是图片的全路径，所以需要通过 Bundle 来获取，而且需要带上后缀名。需要注意的是，如果图片放置在 <code>Assets.xcassets</code> 中，Bundle 是无法获取到的，需要直接复制到项目中。否则的话 <code>demoImagePath</code> 将为 <code>nil</code>，导致无法获取到图片，程序也将可能崩溃。</p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p>Xcode Documentation &amp; API Reference</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;探究 iOS 中 UIImage 中两种不同 Initializers 带来的内存问题&lt;br&gt;本文使用 Swift 版本为 3.0 beta。&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Swift" scheme="https://maimieng.com/tags/Swift/"/>
    
      <category term="iOS" scheme="https://maimieng.com/tags/iOS/"/>
    
  </entry>
  
  <entry>
    <title>Maven 3 安装第三方 JAR 向导翻译及 Demo</title>
    <link href="https://maimieng.com/2016/15/"/>
    <id>https://maimieng.com/2016/15/</id>
    <published>2016-07-19T16:00:00.000Z</published>
    <updated>2016-08-16T16:27:06.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote class="blockquote-center"><br>Maven 对于 JAR 的导入提供了巨大便利，<br>然而有些 JAR 包却因为各种原因不存在于各大仓库之中，<br>本文即是对 Maven 官网的教程翻译，<br>希望可以帮到同样困惑的人。<br></blockquote><br><a id="more"></a></p>
<blockquote>
<p>PS:<br>Maven，名词，译作专家，内行。在程序设计开发中，Maven 是一个较为强大但依赖网络的项目管理工具。<br>本文英语原文引自 <a href="http://maven.apache.org/guides/mini/guide-3rd-party-jars-local.html" target="_blank" rel="external">Apache Maven 官网中的 Guide to installing 3rd party JARs</a>。<br>Last Published: 2016-07-09<br>最新发行时间：2016 年 7 月 9 日</p>
</blockquote>
<h2 id="翻译-安装第三方-JAR-向导"><a href="#翻译-安装第三方-JAR-向导" class="headerlink" title="[翻译]安装第三方 JAR 向导"></a>[翻译]安装第三方 JAR 向导</h2><p>尽管很少发生，但有时会有第三方的 JAR，想要放入本地仓库为自己的构建使用，这是因为这些 JAR 不存在于任何公共仓库，例如 <a href="http://search.maven.org/" target="_blank" rel="external">Maven 中心（仓库）</a>。JAR 必须被放置在本地仓库的正确位置，这样才能被 Apache Maven 获取到。</p>
<p>为使得这一过程更加简单，且不易出错，我们已提供了相对简单的 <a href="http://maven.apache.org/plugins/maven-install-plugin/" target="_blank" rel="external">Maven-安装-插件</a>。在本地仓库安装 JAR 使用以下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mvn install:install-file -Dfile=&lt;JAR 文件路径&gt; -DgroupId=&lt;组-id&gt; \</div><div class="line">	-DartifactId=&lt;工件-id&gt; -Dversion=&lt;版本&gt; -Dpackaging=&lt;包&gt;</div></pre></td></tr></table></figure>
<p>如果也含有 pom 文件，你可以使用以下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mvn install:install-file -Dfile=&lt;JAR 文件路径&gt; -DpomFile=&lt;pom 文件路径&gt;</div></pre></td></tr></table></figure>
<p>使用 Maven-安装-插件 v2.5 使得安装 JAR 更加简单。如果那个 JAR 文件由 Apache Maven 构建，其在 META-INF 的子目录下还包括一个 pom.xml 文件，它将被默认读入。在这种情形下，你只需要这么做：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mvn install:install-file -Dfile=&lt;JAR 文件路径&gt;</div></pre></td></tr></table></figure>
<h2 id="Demo-导入本地-ojdbc6-jar"><a href="#Demo-导入本地-ojdbc6-jar" class="headerlink" title="[Demo]导入本地 ojdbc6.jar"></a>[Demo]导入本地 ojdbc6.jar</h2><ul>
<li>Info:<ul>
<li>JDK 1.8</li>
<li>Intellij IDEA</li>
</ul>
</li>
</ul>
<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>由于目前使用的数据库是 Oracle XE，所以在 Java 项目中需要导入其驱动包 ojdbc6.jar。而由于该 JAR 许可证过期，所以无法直接在 Maven 项目中导入。所以做此测试，验证该向导是否可行，看看其中有木有什么坑。</p>
<h3 id="Run"><a href="#Run" class="headerlink" title="Run"></a>Run</h3><h4 id="下载-ojdbc6-jar"><a href="#下载-ojdbc6-jar" class="headerlink" title="下载 ojdbc6.jar"></a>下载 ojdbc6.jar</h4><p><a href="http://www.oracle.com/technetwork/database/features/jdbc/index-091264.html" target="_blank" rel="external">官网下载 Oracle JDBC</a></p>
<h4 id="按要求做出命令"><a href="#按要求做出命令" class="headerlink" title="按要求做出命令"></a>按要求做出命令</h4><p>如果在<strong>命令行</strong>，可以直接使用以下形式（注意将部分替换为你所要导入 JAR 的信息）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mvn install:install-file -Dfile=/Users/kingcos/Downloads/ojdbc6.jar -DgroupId=com.oracle ＼</div><div class="line">	-DartifactId=ojdbc6 -Dversion=11.2.0.3 -Dpackaging=jar</div></pre></td></tr></table></figure>
<p>如果在 IDEA 配置中，第一行的 <code>\</code> 需要删除，即：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">mvn install:install-file -Dfile=/Users/kingcos/Downloads/ojdbc6.jar -DgroupId=com.oracle -DartifactId=ojdbc6 -Dversion=11.2.0.3 -Dpackaging=jar</div></pre></td></tr></table></figure>
<p>在 IDEA 右侧找到 Maven Projects</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/ojdbc4maven_1.png" alt="入口"></p>
<p>点击 Maven Projects 菜单中的命令行按钮</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/ojdbc4maven_2.png" alt="IDEA Maven 命令行"></p>
<p>输入刚才的命令并运行，查看下方区域是否显示 BUILD SUCCESS</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/ojdbc4maven_3.png" alt="BUILD SUCCESS"></p>
<p>如果出现失败，要排查上述各项命令是否正确。<br>如果成功，即可在 pom.xml 中加入你刚刚导入的 JAR。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.oracle<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>ojdbc6<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>11.2.0.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></div></pre></td></tr></table></figure>
<p><img src="https://o7y30w6c6.qnssl.com/blog/ojdbc4maven_4.png" alt="添加依赖"></p>
<h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><p>其实我们找到本地的 maven 仓库，看看需要的 JAR 在不在就可以了，如下图，我的 ojdbc6.jar 已经成功导入本地 maven 仓库。</p>
<p><img src="https://o7y30w6c6.qnssl.com/blog/ojdbc4maven_5.png" alt="maven 本地仓库目录"></p>
<p>不过，我也在这里写了一个小的测试方法，即测试连接数据库后，将查询结果打印，运行成功且输出正确，来测试刚才的配置是否正确。（本机测试成功）</p>
<p>测试类：App.java（由于直接测试，这里没有更改该类名）</p>
<p>注意：将连接数据库的代码即 SQL 语句替换为自己数据库的设置。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> com.maimeing;</div><div class="line"></div><div class="line"><span class="keyword">import</span> java.sql.*;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">        Connection conn = <span class="keyword">null</span>;</div><div class="line">        PreparedStatement pstm = <span class="keyword">null</span>;</div><div class="line">        ResultSet rs = <span class="keyword">null</span>;</div><div class="line"></div><div class="line">        <span class="keyword">try</span> &#123;</div><div class="line">            Class.forName(<span class="string">"oracle.jdbc.OracleDriver"</span>);</div><div class="line">            conn = DriverManager.getConnection(<span class="string">"jdbc:oracle:thin:@localhost:1521:xe"</span>, <span class="string">"demo"</span>, <span class="string">"123456"</span>);</div><div class="line">            String sql = <span class="string">"select count(*) from person"</span>;</div><div class="line">            pstm = conn.prepareStatement(sql);</div><div class="line">            rs = pstm.executeQuery();</div><div class="line"></div><div class="line">            <span class="keyword">while</span> (rs.next()) &#123;</div><div class="line">                System.out.println(rs.getInt(<span class="number">1</span>));</div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; <span class="keyword">catch</span> (SQLException e) &#123;</div><div class="line">            e.printStackTrace();</div><div class="line">        &#125; <span class="keyword">finally</span> &#123;</div><div class="line">            <span class="keyword">try</span> &#123;</div><div class="line">                rs.close();</div><div class="line">                pstm.close();</div><div class="line">                conn.close();</div><div class="line">            &#125; <span class="keyword">catch</span> (SQLException e) &#123;</div><div class="line">                e.printStackTrace();</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><ul>
<li><a href="http://stackoverflow.com/questions/1074869/find-oracle-jdbc-driver-in-maven-repository" target="_blank" rel="external">ojdbc 许可证过期：摘自 Find Oracle JDBC driver in Maven repository 中一名回答者的回复</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;Maven 对于 JAR 的导入提供了巨大便利，&lt;br&gt;然而有些 JAR 包却因为各种原因不存在于各大仓库之中，&lt;br&gt;本文即是对 Maven 官网的教程翻译，&lt;br&gt;希望可以帮到同样困惑的人。&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Translation" scheme="https://maimieng.com/tags/Translation/"/>
    
      <category term="Java" scheme="https://maimieng.com/tags/Java/"/>
    
      <category term="Oracle" scheme="https://maimieng.com/tags/Oracle/"/>
    
      <category term="Maven" scheme="https://maimieng.com/tags/Maven/"/>
    
  </entry>
  
  <entry>
    <title>Java 中的 Serializable 与 transient</title>
    <link href="https://maimieng.com/2016/14/"/>
    <id>https://maimieng.com/2016/14/</id>
    <published>2016-07-16T16:00:00.000Z</published>
    <updated>2016-07-19T05:41:27.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote class="blockquote-center"><br>目前个人对 Java 的理解应用仅限于皮毛，<br>故若有不妥，会及时修正。<br></blockquote><br><a id="more"></a></p>
<ul>
<li>Info:<ul>
<li>JDK 1.8</li>
<li>Eclipse EE neon</li>
</ul>
</li>
</ul>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Java 中的 <code>transient</code> 是有关对象序列化的关键字，之前学习中并没有注意，并且没有实际使用。但是这次希望可以总结一下，来了解 Java 的这个特点，故记录于此。</p>
<h2 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h2><p><strong>序列化（Serializable）</strong>是指把 Java 对象字节序列的过程，就是说将原本保存在<strong>内存</strong>中的对象，保存到<strong>硬盘（或数据库等）</strong>中。当需要使用时，再<strong>反序列化</strong>恢复到内存中使用。在我查到的资料中，通过网络传递对象或是RMI（Remote Method Invocation远程方法调用）都会用到对象序列化。transient 译为短暂的，在这里即不被持久化。有一些敏感数据是不适合被传输，因此需要加上 <code>transient</code> 关键字，即可避免序列化。</p>
<h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><p>实体类：Account.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.Serializable;</div><div class="line"></div><div class="line"><span class="comment">// 参与序列化只需要实现 Serializable 接口即可</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Account</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</div><div class="line">	<span class="comment">// Java 的序列化机制通过判断以下 ID 来进行版本比对，本处使用默认</span></div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> Long accountId;</div><div class="line">	<span class="keyword">private</span> String username;</div><div class="line">	<span class="comment">// transient 修饰：</span></div><div class="line">	<span class="keyword">private</span> <span class="keyword">transient</span> String password;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">transient</span> <span class="keyword">double</span> balance;</div><div class="line">	</div><div class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> staticVar;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Account</span><span class="params">(Long accountId, String username, String password, <span class="keyword">double</span> balance)</span> </span>&#123;</div><div class="line">		<span class="keyword">super</span>();</div><div class="line">		<span class="keyword">this</span>.accountId = accountId;</div><div class="line">		<span class="keyword">this</span>.username = username;</div><div class="line">		<span class="keyword">this</span>.password = password;</div><div class="line">		<span class="keyword">this</span>.balance = balance;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="string">"Account [accountId="</span> + accountId + <span class="string">", username="</span> + username + <span class="string">", password="</span> + password + <span class="string">", balance="</span></div><div class="line">				+ balance + <span class="string">"]"</span>;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>测试类：TestTransient.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.*;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo01</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		<span class="comment">// 此处需要改为你要存入的地址，注意 Win 下地址中的 \ 需要转义</span></div><div class="line">		String src = <span class="string">"/Users/kingcos/Desktop/demo.object"</span>;</div><div class="line">		Account kingcos = <span class="keyword">new</span> Account(<span class="number">62278888L</span>, <span class="string">"kingcos"</span>, <span class="string">"123456"</span>, <span class="number">1000.0</span>);</div><div class="line">		Account.staticVar = <span class="number">11</span>;</div><div class="line">		System.out.println(<span class="string">"序列化之前："</span>);</div><div class="line">		System.out.println(kingcos);</div><div class="line">		System.out.println(<span class="string">"staticVar = "</span> + Account.staticVar);</div><div class="line">		</div><div class="line">		write(kingcos, src);</div><div class="line">		Account.staticVar = <span class="number">22</span>;</div><div class="line">		Account newKingcos = read(src);</div><div class="line">		System.out.println(<span class="string">"序列化之后："</span>);</div><div class="line">		System.out.println(newKingcos);</div><div class="line">		System.out.println(<span class="string">"staticVar = "</span> + Account.staticVar);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(Account acc, String src)</span> </span>&#123;</div><div class="line">		OutputStream os = <span class="keyword">null</span>;</div><div class="line">		ObjectOutputStream oos = <span class="keyword">null</span>;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			os = <span class="keyword">new</span> FileOutputStream(src);</div><div class="line">			oos = <span class="keyword">new</span> ObjectOutputStream(os);</div><div class="line">			<span class="comment">// 写入</span></div><div class="line">			oos.writeObject(acc);</div><div class="line">			</div><div class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125; <span class="keyword">finally</span> &#123;</div><div class="line">			<span class="keyword">try</span> &#123;</div><div class="line">				oos.flush();</div><div class="line">				oos.close();</div><div class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">				e.printStackTrace();</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">static</span> Account <span class="title">read</span><span class="params">(String src)</span> </span>&#123;</div><div class="line">		Account acc = <span class="keyword">null</span>;</div><div class="line">		InputStream is = <span class="keyword">null</span>;</div><div class="line">		ObjectInputStream ois = <span class="keyword">null</span>;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			is = <span class="keyword">new</span> FileInputStream(src);</div><div class="line">			ois = <span class="keyword">new</span> ObjectInputStream(is);</div><div class="line">			<span class="comment">// 读取</span></div><div class="line">			acc = (Account) ois.readObject();</div><div class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125; <span class="keyword">finally</span> &#123;</div><div class="line">			<span class="keyword">try</span> &#123;</div><div class="line">				ois.close();</div><div class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">				e.printStackTrace();</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> acc;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Console:</span></div><div class="line"><span class="comment">// 序列化之前：</span></div><div class="line"><span class="comment">// Account [accountId=62278888, username=kingcos, password=123456, balance=1000.0]</span></div><div class="line"><span class="comment">// staticVar = 11</span></div><div class="line"><span class="comment">// 序列化之后：</span></div><div class="line"><span class="comment">// Account [accountId=62278888, username=kingcos, password=null, balance=0.0]</span></div></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>序列化</p>
<ul>
<li>序列化前后的对象内容一样，地址不同，属于<strong>深拷贝</strong>（deep copy）</li>
</ul>
<p>serialVersionUID</p>
<ul>
<li>序列化时系统会把当前类的 serialVersionUID 写入序列化的文件中（也可能是其他的中介），当反序列化的时候系统会去检测文件中的 serialVersionUID，看它是否和当前类的 serialVersionUID 一致，如果一致就说明序列化的类的版本和当前类的版本是相同的，这个时候可以成功反序列化，否则就说明当前类和序列化的类相比发生了某些变化</li>
<li>Eclipse 可以根据类名，接口名，方法和属性等来生成一个 64 位的哈希字段，也可添加默认的 1L</li>
<li>当序列化后，对对象进行修改，再进行反序列化所出现的情形，可以查看参考资料中的讲解</li>
</ul>
<p>静态变量</p>
<ul>
<li>静态变量是相对于类的，而非对象，因此其也无法参与到序列化中。上面的 Demo 中，我们在写入对象后对静态变量进行修改。而再次读取对象时，该变量的值为我们所修改过的。即序列化会忽略静态变量</li>
</ul>
<p>其它</p>
<ul>
<li>当一个父类实现序列化，子类自动实现序列化，不需要显式实现 Serializable 接口</li>
<li>仅实现 Serializable 接口而无其它处理，即为默认序列化机制。在此机制下序列化对象时，不仅会序列化其本身，也会对该其引用的其它对象也进行序列化，同样，这些其它对象引用的另外对象也将被序列化，以此类推。因此有时序列化开销可能较大</li>
<li>transient 关键字只能修饰属性（变量），不能修饰方法和类</li>
<li>属性如果也是对象，则该对象对应的类需要实现 Serializable 接口</li>
</ul>
<h2 id="Externalizable"><a href="#Externalizable" class="headerlink" title="Externalizable"></a>Externalizable</h2><blockquote>
<p>Externalizable<br>Externalizable 接口内部实现了 Serializable 接口，但是为其扩展了两个方法，<code>writerExternal()</code> 方法在<strong>序列化</strong>时被自动调用，可以在其中控制序列化内容，<code>readExternal()</code> 方法在<strong>反序列化</strong>时被自动调用，可以在其中控制反序列化的内容。如果留空，（反）序列化行为将不会保存或读取任何一个字段，所以 transient 关键字也失效。因此我们可以对（反）序列化进行控制，详见下面的 Demo。<br>注意：<br>使用 Externalizable 进行序列化时，当读取对象时，会调用被序列化类的<strong>无参构造方法</strong>去创建一个新的对象，然后再将被保存对象的字段的值分别填充到新对象中。因此，实现 Externalizable 接口的类必须要提供一个无参的构造器，且它的访问权限为 public。</p>
</blockquote>
<h2 id="Demo-1"><a href="#Demo-1" class="headerlink" title="Demo"></a>Demo</h2><p>该 Demo 基于上处改编</p>
<p>实体类：Account.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.Externalizable;</div><div class="line"><span class="keyword">import</span> java.io.IOException;</div><div class="line"><span class="keyword">import</span> java.io.ObjectInput;</div><div class="line"><span class="keyword">import</span> java.io.ObjectOutput;</div><div class="line"></div><div class="line"><span class="comment">// Externalizable 接口内部也实现了 Serializable</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Account</span> <span class="keyword">implements</span> <span class="title">Externalizable</span> </span>&#123;</div><div class="line">	<span class="comment">// Java 的序列化机制通过判断以下 ID 来进行版本比对，本处使用默认</span></div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> Long accountId;</div><div class="line">	<span class="keyword">private</span> String username;</div><div class="line">	<span class="comment">// transient 修饰：</span></div><div class="line">	<span class="keyword">private</span> <span class="keyword">transient</span> String password;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">transient</span> <span class="keyword">double</span> balance;</div><div class="line">	</div><div class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> staticVar;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Account</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">super</span>();</div><div class="line">		System.out.println(<span class="string">"调用了 无参构造方法"</span>);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Account</span><span class="params">(Long accountId, String username, String password, <span class="keyword">double</span> balance)</span> </span>&#123;</div><div class="line">		<span class="keyword">super</span>();</div><div class="line">		<span class="keyword">this</span>.accountId = accountId;</div><div class="line">		<span class="keyword">this</span>.username = username;</div><div class="line">		<span class="keyword">this</span>.password = password;</div><div class="line">		<span class="keyword">this</span>.balance = balance;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="string">"Account [accountId="</span> + accountId + <span class="string">", username="</span> + username + <span class="string">", password="</span> + password + <span class="string">", balance="</span></div><div class="line">				+ balance + <span class="string">"]"</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">writeExternal</span><span class="params">(ObjectOutput out)</span> <span class="keyword">throws</span> IOException </span>&#123;</div><div class="line">		System.out.println(<span class="string">"调用 writeExternal"</span>);</div><div class="line">		out.writeLong(accountId);</div><div class="line">		out.writeObject(password);</div><div class="line">		out.writeDouble(balance);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">readExternal</span><span class="params">(ObjectInput in)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</div><div class="line">		System.out.println(<span class="string">"调用 readExternal"</span>);</div><div class="line">		accountId = in.readLong();</div><div class="line">		<span class="comment">// 对象类型需要强制类型转换</span></div><div class="line">		password = (String) in.readObject();</div><div class="line">		balance = in.readDouble();</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>测试类：TextExternalizable.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.io.*;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TextExternalizable</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		<span class="comment">// 此处需要改为你要存入的地址，注意 Win 下地址中的 \ 需要转义</span></div><div class="line">		String src = <span class="string">"/Users/kingcos/Desktop/demo.object"</span>;</div><div class="line">		Account kingcos = <span class="keyword">new</span> Account(<span class="number">62278888L</span>, <span class="string">"kingcos"</span>, <span class="string">"123456"</span>, <span class="number">1000.0</span>);</div><div class="line">		Account.staticVar = <span class="number">11</span>;</div><div class="line">		System.out.println(<span class="string">"序列化之前："</span>);</div><div class="line">		System.out.println(kingcos);</div><div class="line">		System.out.println(<span class="string">"staticVar = "</span> + Account.staticVar);</div><div class="line">		</div><div class="line">		write(kingcos, src);</div><div class="line">		Account.staticVar = <span class="number">22</span>;</div><div class="line">		Account newKingcos = read(src);</div><div class="line">		System.out.println(<span class="string">"序列化之后："</span>);</div><div class="line">		System.out.println(newKingcos);</div><div class="line">		System.out.println(<span class="string">"staticVar = "</span> + Account.staticVar);</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">write</span><span class="params">(Account acc, String src)</span> </span>&#123;</div><div class="line">		OutputStream os = <span class="keyword">null</span>;</div><div class="line">		ObjectOutputStream oos = <span class="keyword">null</span>;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			os = <span class="keyword">new</span> FileOutputStream(src);</div><div class="line">			oos = <span class="keyword">new</span> ObjectOutputStream(os);</div><div class="line">			<span class="comment">// 写入</span></div><div class="line">			oos.writeObject(acc);</div><div class="line">			</div><div class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125; <span class="keyword">finally</span> &#123;</div><div class="line">			<span class="keyword">try</span> &#123;</div><div class="line">				oos.flush();</div><div class="line">				oos.close();</div><div class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">				e.printStackTrace();</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">static</span> Account <span class="title">read</span><span class="params">(String src)</span> </span>&#123;</div><div class="line">		Account acc = <span class="keyword">null</span>;</div><div class="line">		InputStream is = <span class="keyword">null</span>;</div><div class="line">		ObjectInputStream ois = <span class="keyword">null</span>;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			is = <span class="keyword">new</span> FileInputStream(src);</div><div class="line">			ois = <span class="keyword">new</span> ObjectInputStream(is);</div><div class="line">			<span class="comment">// 读取</span></div><div class="line">			acc = (Account) ois.readObject();</div><div class="line">		&#125; <span class="keyword">catch</span> (FileNotFoundException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125; <span class="keyword">finally</span> &#123;</div><div class="line">			<span class="keyword">try</span> &#123;</div><div class="line">				ois.close();</div><div class="line">			&#125; <span class="keyword">catch</span> (IOException e) &#123;</div><div class="line">				e.printStackTrace();</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> acc;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Console:</span></div><div class="line"><span class="comment">// 序列化之前：</span></div><div class="line"><span class="comment">// Account [accountId=62278888, username=kingcos, password=123456, balance=1000.0]</span></div><div class="line"><span class="comment">// staticVar = 11</span></div><div class="line"><span class="comment">// 调用 writeExternal</span></div><div class="line"><span class="comment">// 调用了 无参构造方法</span></div><div class="line"><span class="comment">// 调用 readExternal</span></div><div class="line"><span class="comment">// 序列化之后：</span></div><div class="line"><span class="comment">// Account [accountId=62278888, username=null, password=123456, balance=1000.0]</span></div><div class="line"><span class="comment">// staticVar = 22</span></div></pre></td></tr></table></figure>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="http://www.cnblogs.com/lanxuezaipiao/p/3369962.html" target="_blank" rel="external">Java transient 关键字使用小记</a></li>
<li><a href="http://swiftlet.net/archives/1268" target="_blank" rel="external">serialVersionUID 作用</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;目前个人对 Java 的理解应用仅限于皮毛，&lt;br&gt;故若有不妥，会及时修正。&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Java" scheme="https://maimieng.com/tags/Java/"/>
    
  </entry>
  
  <entry>
    <title>浅谈 Java 与 Oracle 中的日期与时间类型</title>
    <link href="https://maimieng.com/2016/13/"/>
    <id>https://maimieng.com/2016/13/</id>
    <published>2016-07-15T16:00:00.000Z</published>
    <updated>2016-07-17T13:10:02.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote class="blockquote-center"><br>目前个人对 Java 的理解应用仅限于皮毛，<br>故若有不妥，会及时修正。<br></blockquote><br><a id="more"></a></p>
<ul>
<li>Info:<ul>
<li>JDK 1.8</li>
<li>Eclipse EE neon</li>
<li>Oracle 10g XE</li>
</ul>
</li>
</ul>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>暑假学校培训，因此整理一下之前在学习过程中比较困惑的地方。方便未来查阅，也使自己能够更深入了解 Java。这次来说一说日期与时间，因为数据库和 Java 本身都有许多存储日期或时间的类型，那么如何选择合适的类型，并正确的存入以及读取便很重要。网上的资料也有些参差不齐，因此我个人整理于此，并附上可以实际运行的代码。</p>
<h2 id="Java-中的日期与时间类型简介"><a href="#Java-中的日期与时间类型简介" class="headerlink" title="Java 中的日期与时间类型简介"></a>Java 中的日期与时间类型简介</h2><h3 id="子父类关系"><a href="#子父类关系" class="headerlink" title="子父类关系"></a>子父类关系</h3><table>
<thead>
<tr>
<th>java.lang.Object</th>
<th>java.lang.Object</th>
<th>java.lang.Object</th>
</tr>
</thead>
<tbody>
<tr>
<td>java.util.Date</td>
<td>java.util.Date</td>
<td>java.util.Date</td>
</tr>
<tr>
<td>-</td>
<td>java.sql.Timestamp</td>
<td>java.sql.Date</td>
</tr>
</tbody>
</table>
<h3 id="精度"><a href="#精度" class="headerlink" title="精度"></a>精度</h3><table>
<thead>
<tr>
<th>类型</th>
<th><code>java.util.Date</code></th>
<th><code>java.sql.Timestamp</code></th>
<th><code>java.sql.Date</code></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>精度</strong></td>
<td><strong>年 月 日 时 分 秒</strong></td>
<td><strong>年 月 日 时 分 秒 毫微秒</strong></td>
<td><strong>年 月 日</strong></td>
</tr>
</tbody>
</table>
<h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestInitTime</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		java.util.Date utilDate_1 = <span class="keyword">new</span> java.util.Date();</div><div class="line">		java.util.Date utilDate_2 = <span class="keyword">new</span> java.util.Date(System.currentTimeMillis());</div><div class="line">		java.sql.Timestamp sqlTimestamp = <span class="keyword">new</span> java.sql.Timestamp(System.currentTimeMillis());</div><div class="line">		java.sql.Date sqlDate = <span class="keyword">new</span> java.sql.Date(System.currentTimeMillis());</div><div class="line">		</div><div class="line">		System.out.println(<span class="string">"utilDate_1 =\t"</span> + utilDate_1);</div><div class="line">		System.out.println(<span class="string">"utilDate_2 =\t"</span> + utilDate_2);</div><div class="line">		System.out.println(<span class="string">"sqlTimestamp =\t"</span> + sqlTimestamp);</div><div class="line">		System.out.println(<span class="string">"sqlDate =\t"</span> + sqlDate);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Console:</span></div><div class="line"><span class="comment">// utilDate_1 = Sun Jul 17 09:26:07 CST 2016</span></div><div class="line"><span class="comment">// utilDate_2 = Sun Jul 17 09:26:07 CST 2016</span></div><div class="line"><span class="comment">// sqlTimestamp = 2016-07-17 09:26:07.342</span></div><div class="line"><span class="comment">// sqlDate = 2016-07-17</span></div></pre></td></tr></table></figure>
<p>上述的初始化均使用了各自<strong>未过时</strong>的构造函数，输出打印后，可以看到明显的精度区别。</p>
<blockquote>
<p>PS<br><code>System.currentTimeMillis()</code>: 返回以毫秒为单位的当前时间。<br><code>CST</code> 代表 China Standard Time（中国标准时间，即东八区，北京时间）</p>
</blockquote>
<h2 id="多种日期类型转换"><a href="#多种日期类型转换" class="headerlink" title="多种日期类型转换"></a>多种日期类型转换</h2><p><code>String</code> -&gt; 时间</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.text.DateFormat;</div><div class="line"><span class="keyword">import</span> java.text.ParseException;</div><div class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TransformDateOrTime</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		String date = <span class="string">"2016-7-17 14:30:05"</span>;</div><div class="line">		DateFormat dateFormat = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd hh:mm:ss"</span>);</div><div class="line">		java.util.Date utilDate = <span class="keyword">null</span>;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			utilDate = dateFormat.parse(date);</div><div class="line">		&#125; <span class="keyword">catch</span> (ParseException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">		System.out.println(<span class="string">"utilDate: "</span> + utilDate);</div><div class="line"></div><div class="line">		java.sql.Timestamp sqlTimestamp = java.sql.Timestamp.valueOf(<span class="string">"2016-7-17 14:30:05"</span>);</div><div class="line">		java.sql.Date sqlDate = java.sql.Date.valueOf(<span class="string">"2016-7-17"</span>);</div><div class="line"></div><div class="line">		System.out.println(<span class="string">"sqlTimestamp: "</span> + sqlTimestamp);</div><div class="line">		System.out.println(<span class="string">"sqlDate: "</span> + sqlDate);	</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Console:</span></div><div class="line"><span class="comment">// utilDate: Sun Jul 17 14:30:05 CST 2016</span></div><div class="line"><span class="comment">// sqlTimestamp: 2016-07-17 14:30:05.0</span></div><div class="line"><span class="comment">// sqlDate: 2016-07-17</span></div></pre></td></tr></table></figure>
<p><code>java.util.Date</code> 与 <code>java.sql.Timestamp</code></p>
<p><strong><code>getTime()</code>: 返回调用对象表示的自 1970 年 1 月 1 日 00:00:00 GMT 以来的毫秒数。</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// java.util.Date -&gt; java.sql.Timestamp</span></div><div class="line">java.util.Date utilDate_1 = <span class="keyword">null</span>;</div><div class="line"><span class="keyword">try</span> &#123;</div><div class="line">	utilDate_1 = dateFormat.parse(date);</div><div class="line">&#125; <span class="keyword">catch</span> (ParseException e) &#123;</div><div class="line">	e.printStackTrace();</div><div class="line">&#125;</div><div class="line">java.sql.Timestamp sqlTimestamp_1 = <span class="keyword">new</span> java.sql.Timestamp(utilDate_1.getTime());</div><div class="line">System.out.println(utilDate_1 + <span class="string">" 转换为 "</span> + sqlTimestamp_1);</div><div class="line">				</div><div class="line"><span class="comment">// java.util.Date &lt;- java.sql.Timestamp （精度丢失）</span></div><div class="line">java.sql.Timestamp sqlTimestamp_2 = <span class="keyword">new</span> java.sql.Timestamp(System.currentTimeMillis());</div><div class="line">java.util.Date utilDate_2 = <span class="keyword">new</span> java.util.Date(sqlTimestamp_2.getTime());</div><div class="line">System.out.println(sqlTimestamp_2 + <span class="string">" 转换为 "</span> + utilDate_2);</div><div class="line"></div><div class="line"><span class="comment">// Console:</span></div><div class="line"><span class="comment">// Sun Jul 17 14:30:05 CST 2016 转换为 2016-07-17 14:30:05.0</span></div><div class="line"><span class="comment">// 2016-07-17 10:09:38.736 转换为 Sun Jul 17 10:09:38 CST 2016</span></div></pre></td></tr></table></figure>
<p><code>java.util.Date</code> 与 <code>java.sql.Date</code></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// java.util.Date -&gt; java.sql.Date</span></div><div class="line">java.sql.Date sqlDate_1 = <span class="keyword">new</span> java.sql.Date(utilDate_1.getTime());</div><div class="line">System.out.println(utilDate_1 + <span class="string">" 转换为 "</span> + sqlDate_1);</div><div class="line">		</div><div class="line"><span class="comment">// java.util.Date &lt;- java.sql.Date</span></div><div class="line">java.sql.Date sqlDate_2 = <span class="keyword">new</span> java.sql.Date(System.currentTimeMillis());</div><div class="line">java.util.Date utilDate_3 = <span class="keyword">new</span> java.util.Date(sqlDate_2.getTime());</div><div class="line">System.out.println(sqlDate_2 + <span class="string">" 转换为 "</span> + utilDate_3);</div><div class="line"></div><div class="line"><span class="comment">// Console:</span></div><div class="line"><span class="comment">// Sun Jul 17 14:30:05 CST 2016 转换为 2016-07-17</span></div><div class="line"><span class="comment">// 2016-07-17 转换为 Sun Jul 17 11:14:15 CST 2016</span></div></pre></td></tr></table></figure>
<h2 id="如何选择？"><a href="#如何选择？" class="headerlink" title="如何选择？"></a>如何选择？</h2><p>在上面最后由 <code>java.sql.Date</code> 转换为 <code>java.util.Date</code> 中，虽然我们之前查到 <code>java.sql.Date</code> 只能保存年月日，但是这里却可以转换为<strong>带有时分秒</strong>的 <code>java.util.Date</code>。而 <code>java.sql.Date</code> 中的 <code>getHours()</code>，<code>getMinutes()</code>，<code>getSeconds()</code>（也包括对应的 setter）方法均已过时，如果调用会有 <code>java.lang.IllegalArgumentException</code> 异常。所以 <code>java.sql.Date</code> 只是屏蔽了时间中的时分秒，为了和数据库中的 <code>DATE</code> 类型匹配，查看其源代码就可以得知，<code>java.sql.Date</code> 继承但没有重写 <code>getTime()</code> 方法，而本身的 <code>public Date(long date)</code> 构造方法也是调用了父类的构造方法。</p>
<p>而与此不同的是 <code>java.sql.Timestamp</code>，其对父类做了扩充，通过查看其源代码，我们可以发现，其 <code>getTime()</code> 中增加了纳秒（1s = 1E9nanos），而且单独增加了 <code>getNanos()</code> 方法。</p>
<p>因此 <code>java.sql.Date</code> 只是屏蔽年月日，而不是移除，而 <code>java.sql.Timestamp</code> 对父类进行了扩充。在下面的 Demo 中，会实际操作数据库，这样一存一取就可以将其特点展现。</p>
<p>在这里以 Oracle 数据库为例，Oracle 中有两种主要日期与时间类型，<code>DATE</code> 以及 <code>TIMESTAMP</code>。</p>
<p><code>DATE</code>: 仅存 <strong>年 月 日</strong><br><code>TIMESTAMP</code>: 保存 <strong>年 月 日 时 分 秒 纳秒</strong></p>
<p>所以对应 Java 中，我们就应该在保存<strong>合适精度</strong>的时间下，选择合适的类型。Java 中的 <code>java.util.Date</code> 更为灵活，我们可以在恰当的时候将其转为合适的类型存入数据库，或者在取出时转为该类型。</p>
<h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><p>SQL</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">-- 建表</span></div><div class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> T_TIME;</div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> T_TIME (</div><div class="line">    <span class="keyword">ID</span> <span class="built_in">NUMBER</span>(<span class="number">10</span>,<span class="number">0</span>) PRIMARY <span class="keyword">KEY</span>,</div><div class="line">    date_1 <span class="built_in">DATE</span>, </div><div class="line">    timestamp_1 <span class="keyword">TIMESTAMP</span>, </div><div class="line">    date_2 <span class="built_in">DATE</span>, </div><div class="line">    timestamp_2 <span class="keyword">TIMESTAMP</span></div><div class="line">);</div><div class="line"></div><div class="line"><span class="comment">-- 创建自增序列</span></div><div class="line"><span class="keyword">drop</span> <span class="keyword">sequence</span> time_id;</div><div class="line"><span class="keyword">create</span> <span class="keyword">sequence</span> time_id</div><div class="line"><span class="keyword">increment</span> <span class="keyword">by</span> <span class="number">1</span>  </div><div class="line"><span class="keyword">start</span> <span class="keyword">with</span> <span class="number">1</span> </div><div class="line"><span class="keyword">nomaxvalue</span> </div><div class="line"><span class="keyword">nominvalue</span> </div><div class="line">nocache</div></pre></td></tr></table></figure>
<p>实体类：TimeEntity.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TimeEntity</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> java.util.Date date_1;</div><div class="line">	<span class="keyword">private</span> java.sql.Date date_2;</div><div class="line">	</div><div class="line">	<span class="keyword">private</span> java.util.Date timestamp_1;</div><div class="line">	<span class="keyword">private</span> java.sql.Timestamp timestamp_2;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> id;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.id = id;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">public</span> java.util.<span class="function">Date <span class="title">getDate_1</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> date_1;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDate_1</span><span class="params">(java.util.Date date_1)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.date_1 = date_1;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">public</span> java.sql.<span class="function">Date <span class="title">getDate_2</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> date_2;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setDate_2</span><span class="params">(java.sql.Date date_2)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.date_2 = date_2;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">public</span> java.util.<span class="function">Date <span class="title">getTimestamp_1</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> timestamp_1;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTimestamp_1</span><span class="params">(java.util.Date timestamp_1)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.timestamp_1 = timestamp_1;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">public</span> java.sql.<span class="function">Timestamp <span class="title">getTimestamp_2</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> timestamp_2;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setTimestamp_2</span><span class="params">(java.sql.Timestamp timestamp_2)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.timestamp_2 = timestamp_2;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="string">"TimeEntity [id="</span> + id + <span class="string">", date_1="</span> + date_1 + <span class="string">", date_2="</span> + date_2 + <span class="string">", timestamp_1="</span> + timestamp_1</div><div class="line">				+ <span class="string">", timestamp_2="</span> + timestamp_2 + <span class="string">"]"</span>;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>测试类：TestTimeDateType.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.sql.Connection;</div><div class="line"><span class="keyword">import</span> java.sql.DriverManager;</div><div class="line"><span class="keyword">import</span> java.sql.PreparedStatement;</div><div class="line"><span class="keyword">import</span> java.sql.ResultSet;</div><div class="line"><span class="keyword">import</span> java.sql.SQLException;</div><div class="line"><span class="keyword">import</span> java.text.DateFormat;</div><div class="line"><span class="keyword">import</span> java.text.SimpleDateFormat;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestTimeDateType</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			Class.forName(<span class="string">"oracle.jdbc.OracleDriver"</span>);</div><div class="line">		&#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">		<span class="comment">// url 中的地址要替换为自己数据的地址</span></div><div class="line">		String url = <span class="string">"jdbc:oracle:thin:@localhost:1521:XE"</span>;</div><div class="line">		<span class="comment">// 数据库用户名及密码需要设置为自己的</span></div><div class="line">		String user = <span class="string">"demo"</span>;</div><div class="line">		String password = <span class="string">"123456"</span>;</div><div class="line">		Connection connection = <span class="keyword">null</span>;</div><div class="line">		PreparedStatement ps = <span class="keyword">null</span>;</div><div class="line">		ResultSet rs = <span class="keyword">null</span>;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			connection = DriverManager.getConnection(url, user, password);</div><div class="line">			String sql = <span class="string">"insert into t_time values (time_id.nextVal, ?, ?, ?, ?)"</span>;</div><div class="line">			ps = connection.prepareStatement(sql);</div><div class="line">			</div><div class="line">			ps = setAll(ps);</div><div class="line">			</div><div class="line">			ps.executeUpdate();</div><div class="line">			</div><div class="line">			<span class="comment">// 这里我们只运行一次，为方便起见，因此仅查询 id 为 1 的记录</span></div><div class="line">			sql = <span class="string">"select * from t_time where id = 1"</span>;</div><div class="line">			ps = connection.prepareStatement(sql);</div><div class="line">			TimeEntity te = <span class="keyword">new</span> TimeEntity();</div><div class="line">			rs = ps.executeQuery();</div><div class="line">			<span class="keyword">while</span> (rs.next()) &#123;</div><div class="line">				te.setId(rs.getInt(<span class="number">1</span>));</div><div class="line">				te.setDate_1(rs.getDate(<span class="number">2</span>));</div><div class="line">				te.setTimestamp_1(rs.getTimestamp(<span class="number">3</span>));</div><div class="line">				</div><div class="line">				te.setDate_2(rs.getDate(<span class="number">4</span>));</div><div class="line">				te.setTimestamp_2(rs.getTimestamp(<span class="number">5</span>));</div><div class="line">			&#125;</div><div class="line">			System.out.println(te);</div><div class="line">		&#125; <span class="keyword">catch</span> (SQLException e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125; <span class="keyword">finally</span> &#123;</div><div class="line">			<span class="keyword">try</span> &#123;</div><div class="line">				rs.close();</div><div class="line">				ps.close();</div><div class="line">				connection.close();</div><div class="line">			&#125; <span class="keyword">catch</span> (SQLException e) &#123;</div><div class="line">				e.printStackTrace();</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="function"><span class="keyword">static</span> PreparedStatement <span class="title">setAll</span><span class="params">(PreparedStatement ps)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		ps.setDate(<span class="number">1</span>, returnSqlDateWithSqlDate());</div><div class="line">		ps.setTimestamp(<span class="number">2</span>, returnTimestampWithTimestamp());</div><div class="line">		ps.setDate(<span class="number">3</span>, <span class="keyword">new</span> java.sql.Date(returnSqlDateWithUtilDate().getTime()));</div><div class="line">		ps.setTimestamp(<span class="number">4</span>,<span class="keyword">new</span> java.sql.Timestamp(returnTimestampWithUtilDate().getTime()));</div><div class="line">		</div><div class="line">		<span class="keyword">return</span> ps;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="keyword">static</span> java.sql.<span class="function">Date <span class="title">returnSqlDateWithSqlDate</span><span class="params">()</span> </span>&#123;</div><div class="line">		java.sql.Date sqlDate = java.sql.Date.valueOf(<span class="string">"2012-2-2"</span>);</div><div class="line">		<span class="keyword">return</span> sqlDate;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="keyword">static</span> java.sql.<span class="function">Timestamp <span class="title">returnTimestampWithTimestamp</span><span class="params">()</span> </span>&#123;</div><div class="line">		java.sql.Timestamp timestamp = java.sql.Timestamp.valueOf(<span class="string">"2015-5-5 5:55:55.555"</span>);</div><div class="line">		<span class="keyword">return</span> timestamp;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="keyword">static</span> java.util.<span class="function">Date <span class="title">returnSqlDateWithUtilDate</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		String date = <span class="string">"2013-3-3 3:33:33"</span>;</div><div class="line">		DateFormat dateFormat = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd hh:mm:ss"</span>);</div><div class="line">		java.util.Date utilDate = dateFormat.parse(date);</div><div class="line">		<span class="keyword">return</span> utilDate;</div><div class="line">	&#125;</div><div class="line">	</div><div class="line">	<span class="keyword">static</span> java.util.<span class="function">Date <span class="title">returnTimestampWithUtilDate</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		String date = <span class="string">"2016-6-6 6:6:6"</span>;</div><div class="line">		DateFormat dateFormat = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd hh:mm:ss"</span>);</div><div class="line">		java.util.Date utilDate = dateFormat.parse(date);</div><div class="line">		<span class="keyword">return</span> utilDate;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Console:</span></div><div class="line"><span class="comment">// TimeEntity [id=1, date_1=2012-02-02, date_2=2013-03-03, timestamp_1=2015-05-05 05:55:55.555, timestamp_2=2016-06-06 06:06:06.0]</span></div></pre></td></tr></table></figure>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>从上面实例中，就可以基本清楚这几个类型的差别，以及其中的转换，因此在实际使用中便可以通过需要的不同精度，来确定所选的类型即可。</p>
<h2 id="java-util-Date-与-Calendar"><a href="#java-util-Date-与-Calendar" class="headerlink" title="java.util.Date 与 Calendar"></a>java.util.Date 与 Calendar</h2><p>在 <code>java.util.Date</code> 中有许多过时方法，查看其注释，有许多都被 <code>Calendar</code> 所代替。由于在现实中，<code>java.util.Date</code> 不再能胜任国际化的操作，因此建议使用 <code>Calendar</code> 进行日期与时间处理。由于 <code>Calendar</code> 类是抽象类，且 <code>Calendar</code> 类的构造方法是 <code>protected</code> 的，所以无法使用Calendar类的构造方法来创建对象，但提供了 <code>getInstance()</code> 静态方法来创建对象。</p>
<h3 id="转化"><a href="#转化" class="headerlink" title="转化"></a>转化</h3><p>测试类：TestCalendar.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> java.util.Calendar;</div><div class="line"><span class="keyword">import</span> java.util.Date;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestCalendar</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</div><div class="line">		<span class="comment">// Calendar 转化为 Date</span></div><div class="line">		Calendar calendar_1 = Calendar.getInstance();</div><div class="line">		System.out.println(calendar_1.getTimeInMillis());</div><div class="line">		Date date_1 = calendar_1.getTime();</div><div class="line">		System.out.println(<span class="string">"Calendar -&gt; Date"</span> + date_1);</div><div class="line">		</div><div class="line">		<span class="comment">// Date 转化为 Calendar</span></div><div class="line">		Date date_2 = <span class="keyword">new</span> Date();</div><div class="line">		Calendar calendar_2 = Calendar.getInstance();</div><div class="line">		calendar_2.setTime(date_2);</div><div class="line">		System.out.println(<span class="string">"Date -&gt; Calendar "</span> + calendar_2);</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// Console:</span></div><div class="line"><span class="number">1468741779943</span></div><div class="line">Calendar -&gt; DateSun Jul <span class="number">17</span> <span class="number">15</span>:<span class="number">49</span>:<span class="number">39</span> CST <span class="number">2016</span></div><div class="line">Date -&gt; Calendar java.util.GregorianCalendar[time=<span class="number">1468741779978</span>,areFieldsSet=<span class="keyword">true</span>,areAllFieldsSet=<span class="keyword">true</span>,lenient=<span class="keyword">true</span>,zone=sun.util.calendar.ZoneInfo[id=<span class="string">"Asia/Shanghai"</span>,offset=<span class="number">28800000</span>,dstSavings=<span class="number">0</span>,useDaylight=<span class="keyword">false</span>,transitions=<span class="number">19</span>,lastRule=<span class="keyword">null</span>],firstDayOfWeek=<span class="number">1</span>,minimalDaysInFirstWeek=<span class="number">1</span>,ERA=<span class="number">1</span>,YEAR=<span class="number">2016</span>,MONTH=<span class="number">6</span>,WEEK_OF_YEAR=<span class="number">30</span>,WEEK_OF_MONTH=<span class="number">4</span>,DAY_OF_MONTH=<span class="number">17</span>,DAY_OF_YEAR=<span class="number">199</span>,DAY_OF_WEEK=<span class="number">1</span>,DAY_OF_WEEK_IN_MONTH=<span class="number">3</span>,AM_PM=<span class="number">1</span>,HOUR=<span class="number">3</span>,HOUR_OF_DAY=<span class="number">15</span>,MINUTE=<span class="number">49</span>,SECOND=<span class="number">39</span>,MILLISECOND=<span class="number">978</span>,ZONE_OFFSET=<span class="number">28800000</span>,DST_OFFSET=<span class="number">0</span>]</div></pre></td></tr></table></figure>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="http://docs.oracle.com/javase/8/docs/api/" target="_blank" rel="external">JavaSE 8 API 说明（Oracle 官方英文版）</a></li>
<li><a href="http://swiftlet.net/archives/754" target="_blank" rel="external">java.util.Date、java.sql.Date、java.sql.Time、java.sql.Timestamp 区别和联系</a></li>
<li><a href="http://swiftlet.net/archives/1284" target="_blank" rel="external">Calender 的使用详解</a></li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;目前个人对 Java 的理解应用仅限于皮毛，&lt;br&gt;故若有不妥，会及时修正。&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Java" scheme="https://maimieng.com/tags/Java/"/>
    
      <category term="Oracle" scheme="https://maimieng.com/tags/Oracle/"/>
    
  </entry>
  
  <entry>
    <title>电池过放修复 Tips</title>
    <link href="https://maimieng.com/2016/12/"/>
    <id>https://maimieng.com/2016/12/</id>
    <published>2016-07-02T16:00:00.000Z</published>
    <updated>2016-07-02T17:22:14.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote class="blockquote-center"><br>平板只有两种，iPad 和其他<br></blockquote><br><a id="more"></a></p>
<ul>
<li>Info:<ul>
<li>WT8</li>
<li>数据线</li>
<li>电源</li>
</ul>
</li>
</ul>
<h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>前段时间为了方便看视频，买了一个平板 TOSHIBA WT8。性能一般，但也足够用了。内存 2G，硬盘 32G，加上内存卡，去掉系统及软件，也就 20G 左右，捉襟见肘。</p>
<p>六级前下载了很多视频，天天带着看，天天都充电。考完六级就期末了，开始准备期末考试了，所以就没有再管过平板，一直放在书架上。偶尔还会充充电，但是这次不知怎么回事，充电闪屏，不充电又按电源键没反应，查了一番才知道电池过放这个概念。不过，按理说，很多新的电池加入了这道保护措施，但很明显，这个平板不支持。再搜一番，只得拆机。</p>
<h4 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h4><p>其他品牌可参照，拆机前务必搜索拆机视频或拆机图再下手，以免出现不良后果</p>
<ol>
<li>将平板后盖拆开（WT8 只需要从边缘打开，用硬卡片划开）</li>
<li>将电池排线取下（小心谨慎）</li>
<li>明确电池排线正负极</li>
<li>将数据线的 Micro USB 头拆掉，将<strong>红色（+）</strong>和<strong>黑色（-）</strong>里的铜线露出</li>
<li>将数据线<strong>红色正极</strong>与机器电池<strong>正极</strong>相接触</li>
<li>将数据线<strong>黑色负极</strong>与机器电池<strong>负极</strong>相接触</li>
<li>将数据线插入 5V USB 接口</li>
<li>接触时间 1 秒即可</li>
<li>组装回去</li>
<li>测试是否能充电</li>
<li>装回去</li>
</ol>
<blockquote>
<p>可能的原因：</p>
<p>带保护的锂电过放时，保护电路会自动断开，用高电压充一下可使保护电路重新接通</p>
</blockquote>
<h4 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h4><p>好的产品应当是为人服务的，不应当是折腾的。初中，高中时候折腾 iPhone 越狱美化，Android 刷机，现在只想老老实实一部手机稳定的用下去。也许是折腾累了，不过这些设备终究是为我们所服务的。如果太过折腾，那便是玩具。</p>
<p>所以，我还是想把这个平板出了，也许未来还是会购置 iPad mini 2/4 吧。</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;平板只有两种，iPad 和其他&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Tips" scheme="https://maimieng.com/tags/Tips/"/>
    
      <category term="Hardware" scheme="https://maimieng.com/tags/Hardware/"/>
    
  </entry>
  
  <entry>
    <title>那一年...高考</title>
    <link href="https://maimieng.com/2016/11/"/>
    <id>https://maimieng.com/2016/11/</id>
    <published>2016-06-24T16:00:00.000Z</published>
    <updated>2016-06-24T16:26:06.000Z</updated>
    
    <content type="html"><![CDATA[<p><blockquote class="blockquote-center"><br>Is this my destiny?<br></blockquote><br><a id="more"></a><br>今天可以查高考分数了，又是一个几家欢喜几家愁的日子。</p>
<p>两年前的今天，我查了自己分数，476，刚刚好二本线。可以说是一个相当差的成绩，当时想，不论怎样，我都不会去复读，因为浪费了一年时间。而现在想想，如果当时浪费一年，也许就不会在这里浪费四年。</p>
<p>然而选择早已做出，在这里再后悔也没有什么用，只有继续前行，才能尽量靠近当初的梦。也许进不了一所好的院校让我的一生失去很多机会，但是谁又知道会是什么样呢？</p>
<p>但愿，未来我还能坚持自己，坚持自己的方向。</p>
<p>晚安。</p>
<p>2016.6.25 凌晨</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;blockquote class=&quot;blockquote-center&quot;&gt;&lt;br&gt;Is this my destiny?&lt;br&gt;&lt;/blockquote&gt;&lt;br&gt;
    
    </summary>
    
    
      <category term="Life" scheme="https://maimieng.com/tags/Life/"/>
    
      <category term="Essay" scheme="https://maimieng.com/tags/Essay/"/>
    
  </entry>
  
</feed>
